
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Update with spatially and temporally distributed atmospheric boundary conditions (bc) &#8212; pyCATHY &lt;span class=&#34;project-release&#34;&gt;v0.1.1&lt;/span&gt;</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=6f89b0bb"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/thebelab-helper.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/SSHydro/plot_3d_spatial_atmbc_from_weill (conflicted copy 2025-05-21 112551)';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Update with spatially and temporally distributed atmospheric boundary conditions (bc)" href="plot_3d_spatial_atmbc_from_weill.html" />
    <link rel="prev" title="Weil et al example with spatially heterogeneous atmbc" href="plot_3c_spatial_atmbc_from_weill.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="Oct 17, 2025"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">pyCATHY <span class="project-release">v0.1.1</span></p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installing.html">Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citing.html">Citing pyCATHY</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gettingstarted.html">Getting Started</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Gallery of examples</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Surface subsurface hydrological model</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="plot_1_pyCATHY_weilletal.html">Weill et al example</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_2_pyCATHY_inputs.html">Input plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_3_meshing_from_Camporese.html">Meshing from a Digital Elevation Model (DEM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_3_meshing_from_weill.html">Changing mesh properties (resolution, coordinates, …)</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_3a_create_soil_withzones.html">Soil 3d from a Digital Elevation Model (DEM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_3b_soil3d_from_weill.html">Soil 3d from a Digital Elevation Model (DEM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_3c_spatial_atmbc_from_weill%20%28conflicted%20copy%202025-07-11%20172359%29.html">Weil et al example with spatially heterogeneous atmbc</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_3c_spatial_atmbc_from_weill.html">Weil et al example with spatially heterogeneous atmbc</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Update with spatially and temporally distributed atmospheric boundary conditions (bc)</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_3d_spatial_atmbc_from_weill.html">Update with spatially and temporally distributed atmospheric boundary conditions (bc)</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_4_pyCATHY_outputs.html">Output plots part 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_4b_pyCATHY_outputs.html">Output plots part 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_4b_waterTable_from_weill.html">Plot Water Table</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_5a_infiltration_withBC.html">Update and show Boundary conditions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../DA/index.html">Data Assimilation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../DA/plot_1_DA_NoUni_ic%20%28conflicted%20copy%202025-05-21%20093615%29.html">DA with Random Initial Conditions on Soil Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DA/plot_1_DA_NoUni_ic.html">DA with Random Initial Conditions on Soil Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DA/plot_1a_perturbate.html">Creating and Managing Parameter Perturbation Scenarios for Data Assimilation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DA/plot_2_prepare_SMC_obs4DA%20%28conflicted%20copy%202025-05-21%20091532%29.html">Read SMC sensors observations to assimilate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DA/plot_2_prepare_SMC_obs4DA.html">Read SMC sensors observations to assimilate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DA/plot_3_run_sequentialDA_SMC%20%28conflicted%20copy%202025-05-21%20091513%29.html">Read SMC sensors observations to assimilate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DA/plot_3_run_sequentialDA_SMC.html">Read SMC sensors observations to assimilate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DA/plot_4_EM_DA.html">SyntaxError</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DA/plot_5_covariances.html">Observations covariances, Localisation matrix</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">From the literature</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../FromLiterature/LaCecilia2023_myst/LaCecilia2023_myst.html">D. La Cecilia and M. Camporese (2022)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FromLiterature/Zanetti_WRR_2024_myst/Zanetti_WRR_2024_myst.html">Zanetti, F., Botter, G., &amp; Camporese, M. (2024)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference documentation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/api.html">API reference: The <code class="docutils literal notranslate"><span class="pre">pyCATHY</span></code> package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/cathy_tools.html">cathy_tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/importers.cathy_outputs.html">importers.cathy_outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/importers.cathy_inputs.html">importers.cathy_inputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/DA.cathy_DA.html">DA.cathy_DA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/ERT.petro_Archie.html">ERT.petro_Archie</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/ERT.simulate_ERT.html">ERT.simulate_ERT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/sensitivity.html">sensitivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/plotters.cathy_plots.html">plotters.cathy_plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/pyCATHY.cathy_utils.html">pyCATHY.cathy_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/generated/pyCATHY.meshtools.html">pyCATHY.meshtools</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../change_log.html">Change log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cathy_list_citation.html">Who uses CATHY ?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting help and contributed</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../contribute.html">Contribute and support</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/BenjMy/pycathy_wrapper" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/BenjMy/pycathy_wrapper/edit/master/doc/content/SSHydro/plot_3d_spatial_atmbc_from_weill (conflicted copy 2025-05-21 112551).rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/BenjMy/pycathy_wrapper/issues/new?title=Issue%20on%20page%20%2Fcontent/SSHydro/plot_3d_spatial_atmbc_from_weill (conflicted copy 2025-05-21 112551).html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/content/SSHydro/plot_3d_spatial_atmbc_from_weill (conflicted copy 2025-05-21 112551).rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Update with spatially and temporally distributed atmospheric boundary conditions (bc)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-content-sshydro-plot-3d-spatial-atmbc-from-weill-conflicted-copy-2025-05-21-112551-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="update-with-spatially-and-temporally-distributed-atmospheric-boundary-conditions-bc">
<span id="sphx-glr-content-sshydro-plot-3d-spatial-atmbc-from-weill-conflicted-copy-2025-05-21-112551-py"></span><h1>Update with spatially and temporally distributed atmospheric boundary conditions (bc)<a class="headerlink" href="#update-with-spatially-and-temporally-distributed-atmospheric-boundary-conditions-bc" title="Link to this heading">#</a></h1>
<p>This tutorial demonstrates how to update atmospheric boundary conditions (bc) using spatially
and temporally distributed data in a hydrological model.</p>
<p>Reference:
Weill, S., et al. « Coupling Water Flow and Solute Transport into a Physically-Based Surface–Subsurface
Hydrological Model ». Advances in Water Resources, vol. 34, no 1, janvier 2011, p. 128‑36. DOI.org (Crossref),
<a class="reference external" href="https://doi.org/10.1016/j.advwatres.2010.10.001">https://doi.org/10.1016/j.advwatres.2010.10.001</a>.</p>
<p>This example uses the <strong>pyCATHY wrapper</strong> for the CATHY model to reproduce results from the Weill et al. dataset.
The notebook is interactive and can be executed in sections to observe the intermediate results. It can also
be shared for collaborative work without any installation required.</p>
<p><em>Estimated time to run the notebook = 5 minutes</em></p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import necessary libraries</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyvista</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pv</span>

<span class="c1"># Import pyCATHY modules for handling mesh, inputs, and outputs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyCATHY.meshtools</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyCATHY</span><span class="w"> </span><span class="kn">import</span> <span class="n">cathy_tools</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyCATHY.importers</span><span class="w"> </span><span class="kn">import</span> <span class="n">cathy_inputs</span> <span class="k">as</span> <span class="n">in_CT</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyCATHY.importers</span><span class="w"> </span><span class="kn">import</span> <span class="n">cathy_outputs</span> <span class="k">as</span> <span class="n">out_CT</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyCATHY.plotters</span><span class="w"> </span><span class="kn">import</span> <span class="n">cathy_plots</span> <span class="k">as</span> <span class="n">cplt</span>
</pre></div>
</div>
<p>Define the project directory and model name. This example uses ‘atmbc_spatially_from_weill’.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">path2prj</span> <span class="o">=</span> <span class="s2">&quot;../SSHydro/&quot;</span>  <span class="c1"># Replace with your local project path</span>
<span class="n">simu</span> <span class="o">=</span> <span class="n">cathy_tools</span><span class="o">.</span><span class="n">CATHY</span><span class="p">(</span><span class="n">dirName</span><span class="o">=</span><span class="n">path2prj</span><span class="p">,</span> <span class="n">prj_name</span><span class="o">=</span><span class="s2">&quot;atmbc_spatially_from_weill_withnodata&quot;</span><span class="p">)</span>
<span class="n">figpath</span> <span class="o">=</span> <span class="s2">&quot;../results/DA_ET_test/&quot;</span>  <span class="c1"># Path to store figures/results</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>🏁 Initiate CATHY object
</pre></div>
</div>
<p>Read the DEM input file</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">DEM</span><span class="p">,</span> <span class="n">dem_header</span> <span class="o">=</span> <span class="n">simu</span><span class="o">.</span><span class="n">read_inputs</span><span class="p">(</span><span class="s1">&#39;dem&#39;</span><span class="p">)</span>

<span class="c1"># Create a new DEM array filled with ones and add irregular boundary and invalid values (-9999)</span>
<span class="n">DEM_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">DEM</span><span class="p">))</span>  <span class="c1"># Initialize new DEM with ones</span>
<span class="n">DEM_new</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">1e-3</span>  <span class="c1"># Adjust a specific corner value</span>
<span class="n">DEM_new</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">9999</span>  <span class="c1"># Add an interior block of invalid values to simulate an irregular boundary</span>
<span class="n">DEM_new</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">15</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">9999</span>  <span class="c1"># Add an interior block of invalid values to simulate an irregular boundary</span>

<span class="c1"># Update the CATHY inputs with the modified DEM</span>
<span class="n">simu</span><span class="o">.</span><span class="n">update_prepo_inputs</span><span class="p">(</span><span class="n">DEM_new</span><span class="p">)</span>

<span class="c1"># Visualize the updated DEM</span>
<span class="n">simu</span><span class="o">.</span><span class="n">show_input</span><span class="p">(</span><span class="s1">&#39;dem&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>🔄 Update hap.in file
🔄 Update dem_parameters file
🔄 Update dtm_13 file
🔄 update zone file
🔄 Update dem_parameters file
🔄 Update parm file
🔄 Update dem_parameters file
</pre></div>
</div>
<p>Run the preprocessor to handle inputs and generate the mesh</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">simu</span><span class="o">.</span><span class="n">run_preprocessor</span><span class="p">()</span>

<span class="c1"># Create a 3D mesh visualization (VTK format)</span>
<span class="n">simu</span><span class="o">.</span><span class="n">create_mesh_vtk</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Load the 3D grid output</span>
<span class="n">grid3d</span> <span class="o">=</span> <span class="n">simu</span><span class="o">.</span><span class="n">read_outputs</span><span class="p">(</span><span class="s1">&#39;grid3d&#39;</span><span class="p">)</span>

<span class="c1"># Set parameters for elevation</span>
<span class="n">simu</span><span class="o">.</span><span class="n">dem_parameters</span>
<span class="n">elevation_increment</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="mi">21</span>  <span class="c1"># Define elevation increment per row</span>
<span class="n">elevation_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">21</span><span class="p">,</span> <span class="mi">21</span><span class="p">])</span>  <span class="c1"># Initialize the elevation matrix</span>

<span class="c1"># Populate elevation_matrix with incremental values based on row index</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">21</span><span class="p">):</span>
    <span class="n">elevation_matrix</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+=</span> <span class="n">row</span> <span class="o">*</span> <span class="n">elevation_increment</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>🍳 gfortran compilation
👟 Run preprocessor
🍳 gfortran compilation
👟 Run preprocessor

 wbb...

 searching the dtm_13.val input file...
 assigned nodata value =  -9999.0000000000000

 number of processed cells =         285

 ...wbb completed

 rn...
 csort I...
 ...completed

 depit...
 dem modifications =          281
 dem modifications =          275
 dem modifications =          269
 dem modifications =          258
 dem modifications =          245
 dem modifications =          229
 dem modifications =          208
 dem modifications =          187
 dem modifications =          173
 dem modifications =          158
 dem modifications =          144
 dem modifications =          124
 dem modifications =          101
 dem modifications =           79
 dem modifications =           56
 dem modifications =           21
 dem modifications =            0
 dem modifications =         2808 (total)
 ...completed

 csort II...
 ...completed

 cca...

 contour curvature threshold value =    9.99999996E+11
 ...completed

 smean...
 mean (min,max) facet slope =  0.000019190 ( 0.000000092, 0.002000000)
 ...completed

 dsf...
 the drainage direction of the outlet cell (           7 ) is used
 ...completed

 hg...
 ...completed

 saving the data in the basin_b/basin_i files...

 ...rn completed

 mrbb...


 Select the header type:
 0) None
 1) ESRI ascii file
 2) GRASS ascii file
 (Ctrl C to exit)

 -&gt;
 Select the nodata value:
 (Ctrl C to exit)

 -&gt;
 Select the pointer system:
 1) HAP system
 2) Arc/Gis system
 (Ctrl C to exit)

 -&gt;  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 dem file

 min value = 0.999000E+00
 max value = 0.100000E+01
 number of cells =   285
 mean value = 0.999997E+00

 writing the output file...

 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 lakes_map file

 min value =     0
 max value =     0
 number of cells =   285
 mean value =     0.000000

 writing the output file...

 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 zone file

 min value =     1
 max value =     1
 number of cells =   285
 mean value =     1.000000

 writing the output file...

 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 dtm_w_1 file

 min value = 0.000000E+00
 max value = 0.100000E+01
 number of cells =   285
 mean value = 0.929825E+00

 writing the output file...

 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 dtm_w_2 file

 min value = 0.000000E+00
 max value = 0.100000E+01
 number of cells =   285
 mean value = 0.701754E-01

 writing the output file...

 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 dtm_p_outflow_1 file

 min value =     0
 max value =     8
 number of cells =   285
 mean value =     5.515790

 writing the output file...

 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 dtm_p_outflow_2 file

 min value =     1
 max value =     9
 number of cells =   285
 mean value =     7.252632

 writing the output file...

 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 A_inflow file

 min value = 0.000000000000E+00
 max value = 0.710000000000E+02
 number of cells =   285
 mean value = 0.299122810364E+01

 writing the output file...

 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 dtm_local_slope_1 file

 min value = 0.000000E+00
 max value = 0.200000E-02
 number of cells =   285
 mean value = 0.141551E-04

 writing the output file...

 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 dtm_local_slope_2 file

 min value = 0.000000E+00
 max value = 0.141421E-02
 number of cells =   285
 mean value = 0.998785E-05

 writing the output file...

 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 dtm_epl_1 file

 min value = 0.000000E+00
 max value = 0.500000E+00
 number of cells =   285
 mean value = 0.492982E+00

 writing the output file...

 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 dtm_epl_2 file

 min value = 0.000000E+00
 max value = 0.707107E+00
 number of cells =   285
 mean value = 0.528469E+00

 writing the output file...

 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 dtm_kSs1_sf_1 file

 min value = 0.000000E+00
 max value = 0.240040E+02
 number of cells =   285
 mean value = 0.223195E+02

 writing the output file...

 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 dtm_kSs1_sf_2 file

 min value = 0.000000E+00
 max value = 0.240040E+02
 number of cells =   285
 mean value = 0.168449E+01

 writing the output file...

 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 dtm_Ws1_sf file

 min value = 0.000000E+00
 max value = 0.100000E+01
 number of cells =   285
 mean value = 0.929825E+00

 writing the output file...

 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 dtm_Ws1_sf_2 file

 min value = 0.000000E+00
 max value = 0.100000E+01
 number of cells =   285
 mean value = 0.701754E-01

 writing the output file...

 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 dtm_b1_sf file

 min value = 0.000000E+00
 max value = 0.000000E+00
 number of cells =   285
 mean value = 0.000000E+00

 writing the output file...

 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 dtm_y1_sf file

 min value = 0.000000E+00
 max value = 0.000000E+00
 number of cells =   285
 mean value = 0.000000E+00

 writing the output file...

 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 dtm_hcID file

 min value =     0
 max value =     0
 number of cells =   285
 mean value =     0.000000

 writing the output file...

 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 dtm_q_output file

 min value =     0
 max value =     0
 number of cells =   285
 mean value =     0.000000

 writing the output file...

 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 dtm_nrc file

 min value = 0.100000E+01
 max value = 0.100000E+01
 number of cells =   285
 mean value = 0.100000E+01

 writing the output file...

 ...mrbb completed

 bb2shp...

 writing file river_net.shp

Note: The following floating-point exceptions are signalling:
IEEE_UNDERFLOW_FLAG IEEE_DENORMAL

🔄 Update parm file
🛠  Recompile src files [12s]
🍳 gfortran compilation [17s]
b&#39;/usr/bin/ld: cannot find -llapack: No such file or directory\n/usr/bin/ld:
cannot find -lblas: No such file or directory\ncollect2: error: ld returned 1
exit status\n&#39;
😔 Cannot find the new processsor
👟 Run processor
b&#39;&#39;
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up time intervals and cycles for the boundary condition</span>
<span class="n">interval</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># Number of intervals</span>
<span class="n">ncycles</span> <span class="o">=</span> <span class="mi">7</span>   <span class="c1"># Number of cycles</span>
<span class="n">t_atmbc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">36e3</span> <span class="o">*</span> <span class="n">ncycles</span><span class="p">,</span> <span class="n">interval</span> <span class="o">*</span> <span class="n">ncycles</span><span class="p">)</span>  <span class="c1"># Time vector</span>

<span class="c1"># Atmospheric boundary condition value</span>
<span class="n">v_atmbc_value</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2e-7</span>  <span class="c1"># Set the boundary condition value</span>

<span class="c1"># Check if the number of nodes matches the flattened elevation matrix</span>
<span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">grid3d</span><span class="p">[</span><span class="s1">&#39;nnod&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">elevation_matrix</span><span class="p">)):</span>
    <span class="c1"># Calculate the atmospheric boundary condition for each node based on elevation</span>
    <span class="n">v_atmbc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">grid3d</span><span class="p">[</span><span class="s1">&#39;nnod&#39;</span><span class="p">]))</span> <span class="o">*</span> <span class="n">v_atmbc_value</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">elevation_matrix</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># For cases where the number of nodes doesn&#39;t match, calculate for all nodes</span>
    <span class="n">v_atmbc_all_nodes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">elevation_matrix</span><span class="p">)))</span> <span class="o">*</span> <span class="n">v_atmbc_value</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">elevation_matrix</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

    <span class="c1"># Reshape the boundary condition values to match the DEM shape</span>
    <span class="n">v_atmbc_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">v_atmbc_all_nodes</span><span class="p">,</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">simu</span><span class="o">.</span><span class="n">DEM</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">simu</span><span class="o">.</span><span class="n">DEM</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>

    <span class="c1"># Mask invalid values in the DEM (-9999) by setting them to NaN</span>
    <span class="n">maskDEM_novalid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">DEM_new</span> <span class="o">==</span> <span class="o">-</span><span class="mi">9999</span><span class="p">)</span>
    <span class="n">v_atmbc_mat</span><span class="p">[</span><span class="n">maskDEM_novalid</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="c1"># Flatten the masked matrix and remove NaN values</span>
    <span class="n">v_atmbc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">v_atmbc_mat</span><span class="p">)</span>
    <span class="n">v_atmbc</span> <span class="o">=</span> <span class="n">v_atmbc</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">v_atmbc</span><span class="p">)]</span>  <span class="c1"># Use ~np.isnan to filter out NaN values</span>

<span class="c1"># Visualize the spatial variation of the atmospheric boundary condition</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">v_atmbc_mat</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>

<span class="c1"># Update the atmospheric boundary condition (ATMB) parameters in CATHY</span>
<span class="n">simu</span><span class="o">.</span><span class="n">update_atmbc</span><span class="p">(</span>
    <span class="n">HSPATM</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">IETO</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">time</span><span class="o">=</span><span class="n">t_atmbc</span><span class="p">,</span>
    <span class="n">netValue</span><span class="o">=</span><span class="p">[</span><span class="n">v_atmbc</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_atmbc</span><span class="p">)</span>  <span class="c1"># Apply the same boundary condition at all times</span>
<span class="p">)</span>

<span class="c1"># Update the model parameters (time control) in CATHY</span>
<span class="n">simu</span><span class="o">.</span><span class="n">update_parm</span><span class="p">(</span><span class="n">TIMPRTi</span><span class="o">=</span><span class="n">t_atmbc</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>🔄 Update atmbc
🔄 Update parm file
🔄 Update parm file
────────────────────────── ⚠ warning messages above ⚠ ──────────────────────────
[&#39;Adjusting NPRT with respect to time of interests requested\n&#39;]
────────────────────────────────────────────────────────────────────────────────
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run the model processor with specified parameters for time stepping and output control</span>
<span class="n">simu</span><span class="o">.</span><span class="n">run_processor</span><span class="p">(</span>
    <span class="n">IPRT1</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>  <span class="c1"># Print results at time step 2</span>
    <span class="n">DTMIN</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>  <span class="c1"># Minimum time step</span>
    <span class="n">DTMAX</span><span class="o">=</span><span class="mf">1e2</span><span class="p">,</span>  <span class="c1"># Maximum time step</span>
    <span class="n">DELTAT</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>  <span class="c1"># Time increment</span>
    <span class="n">TRAFLAG</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>  <span class="c1"># Transport flag off</span>
    <span class="n">VTKF</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>  <span class="c1"># Output VTK format</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span>  <span class="c1"># Turn off verbose mode</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>🔄 Update parm file
🛠  Recompile src files [17s]
🍳 gfortran compilation [23s]
b&#39;/usr/bin/ld: cannot find -llapack: No such file or directory\n/usr/bin/ld:
cannot find -lblas: No such file or directory\ncollect2: error: ld returned 1
exit status\n&#39;
😔 Cannot find the new processsor
👟 Run processor
b&#39;&#39;
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize the atmospheric boundary conditions in space using vtk</span>
<span class="n">cplt</span><span class="o">.</span><span class="n">show_vtk</span><span class="p">(</span>
    <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;pressure&quot;</span><span class="p">,</span>
    <span class="n">timeStep</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># Time step to display</span>
    <span class="n">notebook</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">path</span><span class="o">=</span><span class="n">simu</span><span class="o">.</span><span class="n">workdir</span> <span class="o">+</span> <span class="s2">&quot;/atmbc_spatially_from_weill/vtk/&quot;</span><span class="p">,</span>  <span class="c1"># Path to VTK files</span>
    <span class="n">savefig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Save the figure</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-pytb notranslate"><div class="highlight"><pre><span></span><span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;/home/runner/work/pycathy_wrapper/pycathy_wrapper/examples/SSHydro/plot_3d_spatial_atmbc_from_weill (conflicted copy 2025-05-21 112551).py&quot;</span>, line <span class="m">136</span>, in <span class="n">&lt;module&gt;</span>
<span class="w">    </span><span class="n">cplt</span><span class="o">.</span><span class="n">show_vtk</span><span class="p">(</span>
  File <span class="nb">&quot;/home/runner/work/pycathy_wrapper/pycathy_wrapper/pyCATHY/plotters/cathy_plots.py&quot;</span>, line <span class="m">557</span>, in <span class="n">show_vtk</span>
<span class="w">    </span><span class="n">mesh</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">filename</span><span class="p">))</span>
  File <span class="nb">&quot;/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/pyvista/_deprecate_positional_args.py&quot;</span>, line <span class="m">245</span>, in <span class="n">inner_f</span>
<span class="w">    </span><span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
  File <span class="nb">&quot;/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/pyvista/core/utilities/fileio.py&quot;</span>, line <span class="m">267</span>, in <span class="n">read</span>
<span class="w">    </span><span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="gr">FileNotFoundError</span>: <span class="n">File (/home/runner/work/pycathy_wrapper/pycathy_wrapper/examples/SSHydro/atmbc_spatially_from_weill/vtk/101.vtk) not found</span>
</pre></div>
</div>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a time-lapse visualization of pressure distribution over time</span>
<span class="c1"># cplt.show_vtk_TL(</span>
<span class="c1">#     unit=&quot;saturation&quot;,</span>
<span class="c1">#     notebook=False,</span>
<span class="c1">#     path=simu.workdir + simu.project_name + &quot;/vtk/&quot;,  # Path to VTK files</span>
<span class="c1">#     show=False,  # Disable showing the plot</span>
<span class="c1">#     x_units=&#39;days&#39;,  # Time units</span>
<span class="c1">#     clim=[0.55, 0.70],  # Color limits for pressure values</span>
<span class="c1">#     savefig=True,  # Save the figure</span>
<span class="c1"># )</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 23.576 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-content-sshydro-plot-3d-spatial-atmbc-from-weill-conflicted-copy-2025-05-21-112551-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/a2aca79722b77a241b46f4df06620bb8/plot_3d_spatial_atmbc_from_weill%20%28conflicted%20copy%202025-05-21%20112551%29.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_3d_spatial_atmbc_from_weill</span> <span class="pre">(conflicted</span> <span class="pre">copy</span> <span class="pre">2025-05-21</span> <span class="pre">112551).ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/96f57f665d75ba6011fc920922e23003/plot_3d_spatial_atmbc_from_weill%20%28conflicted%20copy%202025-05-21%20112551%29.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_3d_spatial_atmbc_from_weill</span> <span class="pre">(conflicted</span> <span class="pre">copy</span> <span class="pre">2025-05-21</span> <span class="pre">112551).py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/4e20b9f65da98c94b047d120d01c621d/plot_3d_spatial_atmbc_from_weill%20%28conflicted%20copy%202025-05-21%20112551%29.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">plot_3d_spatial_atmbc_from_weill</span> <span class="pre">(conflicted</span> <span class="pre">copy</span> <span class="pre">2025-05-21</span> <span class="pre">112551).zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content/SSHydro"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="plot_3c_spatial_atmbc_from_weill.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Weil et al example with spatially heterogeneous atmbc</p>
      </div>
    </a>
    <a class="right-next"
       href="plot_3d_spatial_atmbc_from_weill.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Update with spatially and temporally distributed atmospheric boundary conditions (bc)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By B. Mary
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022, B. Mary.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on Oct 17, 2025.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>