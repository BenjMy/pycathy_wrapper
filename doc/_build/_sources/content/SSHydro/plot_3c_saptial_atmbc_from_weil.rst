
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "content/SSHydro/plot_3c_saptial_atmbc_from_weil.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_content_SSHydro_plot_3c_saptial_atmbc_from_weil.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_content_SSHydro_plot_3c_saptial_atmbc_from_weil.py:


Update with distributed atmospheric bc
======================================

Weill, S., et al. « Coupling Water Flow and Solute Transport into a Physically-Based Surface–Subsurface Hydrological Model ». 
Advances in Water Resources, vol. 34, no 1, janvier 2011, p. 128‑36. DOI.org (Crossref), 
https://doi.org/10.1016/j.advwatres.2010.10.001.


This example shows how to use pyCATHY object to create spatially and temporally variable atmbc conditions

*Estimated time to run the notebook = 5min*

.. GENERATED FROM PYTHON SOURCE LINES 17-34

.. code-block:: default



    # !! run preprocessor change the DEM shape !
    # dtm_13 does not have the same shape anymore!

    import os

    import matplotlib.pyplot as plt
    import numpy as np
    import pandas as pd

    import pyCATHY.meshtools as mt
    from pyCATHY import cathy_tools
    from pyCATHY.importers import cathy_inputs as in_CT
    from pyCATHY.importers import cathy_outputs as out_CT
    from pyCATHY.plotters import cathy_plots as cplt








.. GENERATED FROM PYTHON SOURCE LINES 35-36

------------------------

.. GENERATED FROM PYTHON SOURCE LINES 36-41

.. code-block:: default

    path2prj = "../SSHydro/"  # add your local path here
    simu = cathy_tools.CATHY(dirName=path2prj, prj_name="atmbc_spatially_timely_from_weil")

    simu.create_mesh_vtk(verbose=True)



.. rst-class:: sphx-glr-script-out

.. code-block:: pytb

    Traceback (most recent call last):
      File "/home/ben/Documents/GitHub/BenjMy/pycathy_wrapper/examples/SSHydro/plot_3c_saptial_atmbc_from_weil.py", line 39, in <module>
        simu.create_mesh_vtk(verbose=True)
      File "/home/ben/Documents/GitHub/BenjMy/pycathy_wrapper/pyCATHY/cathy_tools.py", line 3246, in create_mesh_vtk
        self.run_processor(IPRT1=3, verbose=verbose)
      File "/home/ben/Documents/GitHub/BenjMy/pycathy_wrapper/pyCATHY/cathy_tools.py", line 544, in run_processor
        self.grid3d = in_CT.read_grid3d(
    AttributeError: module 'pyCATHY.importers.cathy_inputs' has no attribute 'read_grid3d'




.. GENERATED FROM PYTHON SOURCE LINES 42-61

.. code-block:: default


    grid3d = in_CT.read_grid3d(simu.project_name)
    DEM, dem_header = simu.read_inputs('dem')
    t_atmbc = [0,86400]
    v_atmbc = np.zeros(int(grid3d['nnod']))
    v_atmbc[0:int(len(np.zeros(int(grid3d['nnod'])))/2)] = 1e-7


    v_atmbc_mat = np.reshape(v_atmbc,[21,21])
    fig, ax = plt.subplots()
    ax.imshow(v_atmbc_mat)

    simu.update_atmbc(
                        HSPATM=0,
                        IETO=0,
                        time=t_atmbc,
                        netValue=[v_atmbc]*len(t_atmbc)
                      )


.. GENERATED FROM PYTHON SOURCE LINES 62-66

.. code-block:: default

    simu.run_processor(IPRT1=2,TRAFLAG=0,verbose=True)

    # cplt.show_spatial_atmbc()
    

.. GENERATED FROM PYTHON SOURCE LINES 67-76

.. code-block:: default


    cplt.show_vtk(
        unit="pressure",
        timeStep=1,
        notebook=False,
        path=simu.workdir + "/atmbc_spatially_timely_from_weil/vtk/",
        savefig=True,
    )


.. GENERATED FROM PYTHON SOURCE LINES 77-85

.. code-block:: default

    cplt.show_vtk(
        unit="saturation",
        timeStep=2,
        notebook=False,
        path=simu.workdir + "/atmbc_spatially_timely_from_weil/vtk/",
        savefig=True,
    )



.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  14.533 seconds)


.. _sphx_glr_download_content_SSHydro_plot_3c_saptial_atmbc_from_weil.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_3c_saptial_atmbc_from_weil.py <plot_3c_saptial_atmbc_from_weil.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_3c_saptial_atmbc_from_weil.ipynb <plot_3c_saptial_atmbc_from_weil.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
