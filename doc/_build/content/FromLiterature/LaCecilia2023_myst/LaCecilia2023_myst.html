
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>D. La Cecilia and M. Camporese (2022) &#8212; pyCATHY &lt;span class=&#34;project-release&#34;&gt;v0.1.1&lt;/span&gt;</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/jupyter-sphinx.css?v=572af1d6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=6f89b0bb"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/thebelab-helper.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/FromLiterature/LaCecilia2023_myst/LaCecilia2023_myst';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Zanetti, F., Botter, G., &amp; Camporese, M. (2024)" href="../Zanetti_WRR_2024_myst/Zanetti_WRR_2024_myst.html" />
    <link rel="prev" title="Read SMC sensors observations to assimilate" href="../../DA/plot_3_run_sequentialDA_SMC.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="May 21, 2025"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">pyCATHY <span class="project-release">v0.1.1</span></p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installing.html">Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../citing.html">Citing pyCATHY</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gettingstarted.html">Getting Started</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Gallery of examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../SSHydro/index.html">Surface subsurface hydrological model</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../SSHydro/plot_1_pyCATHY_weilletal.html">Weill et al example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../SSHydro/plot_2_pyCATHY_inputs.html">Input plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../SSHydro/plot_3_meshing_from_Camporese.html">Meshing from a Digital Elevation Model (DEM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../SSHydro/plot_3_meshing_from_weill.html">Changing mesh properties (resolution, coordinates, â€¦)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../SSHydro/plot_3a_create_soil_withzones.html">Soil 3d from a Digital Elevation Model (DEM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../SSHydro/plot_3b_soil3d_from_weill.html">Soil 3d from a Digital Elevation Model (DEM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../SSHydro/plot_3c_spatial_atmbc_from_weill.html">Weil et al example with spatially heterogeneous atmbc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../SSHydro/plot_3d_spatial_atmbc_from_weill.html">Update with spatially and temporally distributed atmospheric boundary conditions (bc)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../SSHydro/plot_4_pyCATHY_outputs.html">Output plots part 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../SSHydro/plot_4b_pyCATHY_outputs.html">Output plots part 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../SSHydro/plot_4b_waterTable_from_weill.html">Plot Water Table</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../SSHydro/plot_5a_infiltration_withBC.html">Update and show Boundary conditions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../DA/index.html">Data Assimilation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../DA/plot_1_DA_NoUni_ic.html">DA with Random Initial Conditions on Soil Layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../DA/plot_2_prepare_SMC_obs4DA.html">Read SMC sensors observations to assimilate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../DA/plot_3_run_sequentialDA_SMC.html">Read SMC sensors observations to assimilate</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">From the literature</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">D. La Cecilia and M. Camporese (2022)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Zanetti_WRR_2024_myst/Zanetti_WRR_2024_myst.html">Zanetti, F., Botter, G., &amp; Camporese, M. (2024)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference documentation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api/api.html">API reference: The <code class="docutils literal notranslate"><span class="pre">pyCATHY</span></code> package</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/generated/cathy_tools.html">cathy_tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/generated/importers.cathy_outputs.html">importers.cathy_outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/generated/importers.cathy_inputs.html">importers.cathy_inputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/generated/DA.cathy_DA.html">DA.cathy_DA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/generated/ERT.petro_Archie.html">ERT.petro_Archie</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/generated/ERT.simulate_ERT.html">ERT.simulate_ERT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/generated/sensitivity.html">sensitivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/generated/plotters.cathy_plots.html">plotters.cathy_plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/generated/pyCATHY.cathy_utils.html">pyCATHY.cathy_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/generated/pyCATHY.meshtools.html">pyCATHY.meshtools</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../change_log.html">Change log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cathy_list_citation.html">Who uses CATHY ?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting help and contributed</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../contribute.html">Contribute and support</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/BenjMy/pycathy_wrapper" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/BenjMy/pycathy_wrapper/edit/master/doc/content/FromLiterature/LaCecilia2023_myst/LaCecilia2023_myst.rst" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/BenjMy/pycathy_wrapper/issues/new?title=Issue%20on%20page%20%2Fcontent/FromLiterature/LaCecilia2023_myst/LaCecilia2023_myst.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/content/FromLiterature/LaCecilia2023_myst/LaCecilia2023_myst.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>D. La Cecilia and M. Camporese (2022)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-the-required-packages">Importing the required packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-cathy-simulation-object">Create a CATHY simulation object</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing-step">1. Preprocessing step</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build-the-mesh">Build the mesh</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-root-map-properties">Define root map properties</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-the-atmospheric-boundary-conditions">Setting the atmospheric boundary conditions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scenario-with-varying-feddes-parameters">Scenario with varying Feddes parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#check-soil-properties">Check soil properties</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#run-simulation">2. Run simulation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-outputs">3. Plot outputs</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-streamflow">Plot streamflow</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-spatial-actual-et">Plot spatial actual ET</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-ground-water-depth-gwd">Plot the Ground Water Depth (GWD)</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="d-la-cecilia-and-m-camporese-2022">
<h1>D. La Cecilia and M. Camporese (2022)<a class="headerlink" href="#d-la-cecilia-and-m-camporese-2022" title="Link to this heading">#</a></h1>
<p>This is a notebook to reproduce outputs from <a class="reference external" href="https://onlinelibrary.wiley.com/doi/10.1002/hyp.14768">La Cecilia and Camporese
(2022)</a></p>
<div class="highlight-{important} notranslate"><div class="highlight"><pre><span></span># Cite this work
We believe in a community-driven approach of open-source tools that are
composable and extensible. If you use this notebook cite the work as:
&gt; La Cecilia, D., and M. Camporese. 2022. Resolving streamflow diel fluctuations in a small agricultural catchment with an integrated surfaceâ€subsurface hydrological model. Hydrological Processes 36(12). doi: 10.1002/hyp.14768.
</pre></div>
</div>
<p>The notebooks describes:</p>
<ol class="arabic simple">
<li><p><strong>Preprocessing step</strong>: how to build a mesh with different vegetation
land cover and a soil including tile drains.</p>
<ul class="simple">
<li><p>Changing atmospheric boundary conditions <strong>Atmbc parameters</strong></p></li>
<li><p>Changing <strong>Feddes parameters</strong></p></li>
<li><p>Changing <strong>Soil parameters</strong></p></li>
</ul>
</li>
<li><p><strong>Simulation</strong> (very long not recommanded to execute): solve the
surface-subsurface flow during a year considering different
scenarios.</p></li>
<li><p><strong>Plot outputs</strong>: analysis of the results</p>
<ul class="simple">
<li><p>spatial distribution of <strong>actual ET</strong></p></li>
<li><p>spatial distribution of <strong>groundwater level depth</strong></p></li>
</ul>
</li>
</ol>
<p>```{note} In Progress</p>
<p>All input and ouput data from this study will be openly and publicly
available through the Eawag repository ERIC at
<a class="reference external" href="https://opendata.eawag.ch/group">https://opendata.eawag.ch/group</a> under the project folder
<strong>â€œNAWA-Flowpathâ€</strong> to ensure that these data are <strong>FAIR: Findable,
Accessible, Interoperable and Reproducible</strong>.</p>
<p>The CATHY model is freely available at
<a class="reference external" href="https://bitbucket.org/cathy1_0/cathy">https://bitbucket.org/cathy1_0/cathy/</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pooch</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">opendata</span><span class="o">.</span><span class="n">eawag</span><span class="o">.</span><span class="n">ch</span><span class="o">/</span><span class="n">group</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">{admonition}</span> <span class="pre">What</span> <span class="pre">you</span> <span class="pre">should</span> <span class="pre">already</span> <span class="pre">know</span> <span class="pre">In</span> <span class="pre">order</span> <span class="pre">to</span> <span class="pre">complete</span> <span class="pre">this</span> <span class="pre">tutorial,</span> <span class="pre">you</span> <span class="pre">should</span> <span class="pre">be</span> <span class="pre">relatively</span> <span class="pre">familiar</span> <span class="pre">with</span> <span class="pre">using</span> <span class="pre">the</span> <span class="pre">pyCATHY</span> <span class="pre">for:</span> <span class="pre">-</span> <span class="pre">Building</span> <span class="pre">a</span> <span class="pre">mesh</span> <span class="pre">from</span> <span class="pre">a</span> <span class="pre">DEM</span> <span class="pre">(See</span> <span class="pre">{doc}</span></code>../content/SSHydro/index` for more information.) - Updating soil inputs - â€¦`</p>
<div class="highlight-{warning} notranslate"><div class="highlight"><pre><span></span>Found a bug ğŸ›/ a typo ? [Email me](mailto:benjamin.mary@unipd.it)
</pre></div>
</div>
<section id="importing-the-required-packages">
<h2>Importing the required packages<a class="headerlink" href="#importing-the-required-packages" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> in order to <strong>plot</strong> the data;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cathy_tools</span></code> is the main object controlling the simulation;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pyCATHY.importers</span></code> allows you to <strong>read CATHY input</strong> files;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pyCATHY.importers</span></code> allows you to <strong>read CATHY output</strong> files;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pyCATHY.plotters</span></code> is a set of functions in order to plot
simulation outputs.</p></li>
</ul>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyCATHY</span><span class="w"> </span><span class="kn">import</span> <span class="n">cathy_tools</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyCATHY.importers</span><span class="w"> </span><span class="kn">import</span> <span class="n">cathy_inputs</span> <span class="k">as</span> <span class="n">in_CT</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyCATHY.importers</span><span class="w"> </span><span class="kn">import</span> <span class="n">cathy_outputs</span> <span class="k">as</span> <span class="n">out_CT</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyCATHY.plotters</span><span class="w"> </span><span class="kn">import</span> <span class="n">cathy_plots</span> <span class="k">as</span> <span class="n">cplt</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpl</span>
<span class="c1"># set some default plotting parameters for nicer looking plots</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;axes.grid&quot;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;grid.color&quot;</span><span class="p">:</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="s2">&quot;grid.linestyle&quot;</span><span class="p">:</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">:(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)})</span>
</pre></div>
</div>
</section>
<section id="create-a-cathy-simulation-object">
<h2>Create a CATHY simulation object<a class="headerlink" href="#create-a-cathy-simulation-object" title="Link to this heading">#</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initiate a CATHY model</span>
<span class="c1"># ------------------------</span>
<span class="n">path2prj</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span>  <span class="c1"># add your local path here</span>
<span class="n">simu</span> <span class="o">=</span> <span class="n">cathy_tools</span><span class="o">.</span><span class="n">CATHY</span><span class="p">(</span><span class="n">dirName</span><span class="o">=</span><span class="n">path2prj</span><span class="p">,</span> <span class="n">prj_name</span><span class="o">=</span><span class="s2">&quot;LaCecilia_2022_HP&quot;</span><span class="p">)</span>
</pre></div>
</div>
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">ğŸ <span style="font-weight: bold">Initiate CATHY object</span>
</pre><p>```{tip} Multiples scenario</p>
<p>If you want to run multiple scenario and compare them it is recommanded
to create a single CATHY object for each of the simulations. For
instance:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">simu_scenario1</span> <span class="o">=</span> <span class="n">cathy_tools</span><span class="o">.</span><span class="n">CATHY</span><span class="p">(</span><span class="n">dirName</span><span class="o">=</span><span class="n">ThePathToYourProject</span><span class="p">,</span> <span class="n">prj_name</span><span class="o">=</span><span class="s2">&quot;scenario1&quot;</span><span class="p">)</span>
<span class="n">simu_scenario2</span> <span class="o">=</span> <span class="n">cathy_tools</span><span class="o">.</span><span class="n">CATHY</span><span class="p">(</span><span class="n">dirName</span><span class="o">=</span><span class="n">ThePathToYourProject</span><span class="p">,</span> <span class="n">prj_name</span><span class="o">=</span><span class="s2">&quot;scenario2&quot;</span><span class="p">)</span>
</pre></div>
</div>
<section id="preprocessing-step">
<h3>1. Preprocessing step<a class="headerlink" href="#preprocessing-step" title="Link to this heading">#</a></h3>
<p>Starting from DEM data (dtm_13.val) and parameters (hap.in) files, the
preprocessing produce a complete set of files describing physiographic
features of a drainage system. Such files represent the preprocessing
input files for CATHY simulation.</p>
</section>
</section>
<section id="build-the-mesh">
<h2>Build the mesh<a class="headerlink" href="#build-the-mesh" title="Link to this heading">#</a></h2>
<p>The <strong>DEM</strong> should be accurate enough to account for an explicit
representation of tile trains (diameter between 10 and 60 cm) - spatial
resolution of 20x20 m necessary</p>
<div class="highlight-{tip} notranslate"><div class="highlight"><pre><span></span>Outside the region of interest the elevation are set to -9999
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DEM</span><span class="p">,</span> <span class="n">header_DEM</span> <span class="o">=</span> <span class="n">simu</span><span class="o">.</span><span class="n">read_inputs</span><span class="p">(</span><span class="s1">&#39;dem&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">DEM</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="n">simu</span><span class="o">.</span><span class="n">show_input</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="s2">&quot;dem&quot;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">ğŸ”„ <span style="font-weight: bold">Update hap.in file</span>
</pre><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">ğŸ”„ <span style="font-weight: bold">update dem_parameters file </span>
</pre><img alt="../../../_images/output_14_2.png" src="../../../_images/output_14_2.png" />
<img alt="../../../_images/output_14_3.png" src="../../../_images/output_14_3.png" />
</section>
<section id="define-root-map-properties">
<h2>Define root map properties<a class="headerlink" href="#define-root-map-properties" title="Link to this heading">#</a></h2>
<p>The <strong>``veg_map``</strong> is a raster file that defined the position of the
vegetation.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">VEG_MAP</span><span class="p">,</span> <span class="n">header_veg_map</span> <span class="o">=</span> <span class="n">simu</span><span class="o">.</span><span class="n">read_inputs</span><span class="p">(</span><span class="s1">&#39;root_map&#39;</span><span class="p">)</span>
<span class="n">VEG_MAP</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
       <span class="o">...</span><span class="p">,</span>
       <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">simu</span><span class="o">.</span><span class="n">show_input</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="s2">&quot;root_map&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
               <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/output_17_0.png" src="../../../_images/output_17_0.png" />
<p>The figure illustrates the vegetation indices, with each index
associated with a corresponding pair of Feddes parameters. In the
northern region, represented by the forested areas, a root depth of 2
meters is considered. However, in the orange patches indicating urban
areas, the root depth is set to a significantly smaller value of 1e-3.</p>
<p>Now we check the values of the Feddes parameters associated with the
indice of the vegetation</p>
<p><code class="docutils literal notranslate"><span class="pre">{note}</span> <span class="pre">Feddes</span> <span class="pre">parameters</span> <span class="pre">-</span> <span class="pre">`PCANA</span></code>: anaerobiosis point - <cite>PCREF</cite>: field capacity - <cite>PCWLT</cite>: wilting point - <cite>ZROOT</cite>: root depth - <cite>PZ</cite>: pz is an empirical parameter - <cite>OMGC</cite>: 0&lt;OMGC&lt;1 Compensatory mechanisms for root water uptake`</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SPP</span><span class="p">,</span> <span class="n">FP</span> <span class="o">=</span> <span class="n">simu</span><span class="o">.</span><span class="n">read_inputs</span><span class="p">(</span><span class="s1">&#39;soil&#39;</span><span class="p">,</span> <span class="n">MAXVEG</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">FP</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PCANA</th>
      <th>PCREF</th>
      <th>PCWLT</th>
      <th>ZROOT</th>
      <th>PZ</th>
      <th>OMGC</th>
    </tr>
    <tr>
      <th>Veg. Indice</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>-4.0</td>
      <td>-150.0</td>
      <td>0.001</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>-4.0</td>
      <td>-150.0</td>
      <td>0.300</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>-4.0</td>
      <td>-150.0</td>
      <td>0.400</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>-4.0</td>
      <td>-150.0</td>
      <td>0.500</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>-4.0</td>
      <td>-150.0</td>
      <td>0.800</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.0</td>
      <td>-4.0</td>
      <td>-150.0</td>
      <td>0.900</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.0</td>
      <td>-4.0</td>
      <td>-150.0</td>
      <td>1.000</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.0</td>
      <td>-4.0</td>
      <td>-150.0</td>
      <td>2.000</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div><p>We can also plot the spatial distribution of the Feddes parameters</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simu</span><span class="o">.</span><span class="n">update_veg_map</span><span class="p">()</span>
<span class="n">simu</span><span class="o">.</span><span class="n">update_soil</span><span class="p">(</span><span class="n">FP_map</span><span class="o">=</span><span class="n">FP</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #808000; text-decoration-color: #808000">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ </span>âš  warning messages above âš <span style="color: #808000; text-decoration-color: #808000"> â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
</pre><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">
<span style="color: #808000; text-decoration-color: #808000">                            The parm dictionnary is empty</span>
<span style="color: #808000; text-decoration-color: #808000">                            Falling back to defaults to update CATHYH</span>
<span style="color: #808000; text-decoration-color: #808000">                            This can have consequences !!</span>
<span style="color: #808000; text-decoration-color: #808000">                            </span>
</pre><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #808000; text-decoration-color: #808000">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
</pre><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">ğŸ”„ <span style="font-weight: bold">update parm file </span>
</pre><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">ğŸ”„ <span style="font-weight: bold">Update soil</span>
</pre><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">homogeneous soil
</pre><img alt="../../../_images/output_22_6.png" src="../../../_images/output_22_6.png" />
</section>
<section id="setting-the-atmospheric-boundary-conditions">
<h2>Setting the atmospheric boundary conditions<a class="headerlink" href="#setting-the-atmospheric-boundary-conditions" title="Link to this heading">#</a></h2>
<p><strong>Scenario 1</strong>, excludes irrigation from the reference simulation. This
scenario serves primarily to assess the differences between an
agricultural catchment and a natural one.</p>
<p>In order to update the atmospheric boundary conditions we call the
following function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">simu</span><span class="o">.</span><span class="n">update_atmbc</span><span class="p">()</span>
</pre></div>
</div>
<p>Remenber that the functions arguments details can be assessed via:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">simu</span><span class="o">.</span><span class="n">update_atmbc</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># first we read and plot the current atmbc file</span>
<span class="c1"># --------------------------------</span>
<span class="n">df_atmbc</span> <span class="o">=</span> <span class="n">simu</span><span class="o">.</span><span class="n">read_inputs</span><span class="p">(</span><span class="s1">&#39;atmbc&#39;</span><span class="p">)</span>
<span class="n">simu</span><span class="o">.</span><span class="n">show_input</span><span class="p">(</span><span class="s1">&#39;atmbc&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/output_24_0.png" src="../../../_images/output_24_0.png" />
<p>Given the fact that all the values are defined in net Q (m/s), and that
all the values are &gt;0, here the scenario exclude the irrigation from the
atmospheric boundary conditions.</p>
<p>Letâ€™s update the atmbc values without to with irrigation:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># first we read the atmbc file</span>
<span class="c1"># --------------------------------</span>
<span class="n">atmbc_hourlyf</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">simu</span><span class="o">.</span><span class="n">workdir</span><span class="p">,</span><span class="n">simu</span><span class="o">.</span><span class="n">project_name</span><span class="p">,</span><span class="s1">&#39;input&#39;</span><span class="p">,</span><span class="s1">&#39;atmbc_hourly&#39;</span><span class="p">)</span>
<span class="n">df_atmbc_hourly</span><span class="p">,</span> <span class="n">HSPATM</span><span class="p">,</span> <span class="n">IETO</span> <span class="o">=</span> <span class="n">in_CT</span><span class="o">.</span><span class="n">read_atmbc</span><span class="p">(</span><span class="n">atmbc_hourlyf</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">simu</span><span class="o">.</span><span class="n">update_atmbc</span><span class="p">)</span>
<span class="n">df_atmbc_hourly</span> <span class="o">=</span> <span class="n">df_atmbc_hourly</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Help on method update_atmbc in module pyCATHY.cathy_tools:

update_atmbc(HSPATM=0, IETO=0, time=None, VALUE=[None, None], netValue=[], show=False, verbose=False, **kwargs) method of pyCATHY.cathy_tools.CATHY instance
    Atmospheric forcing term (atmbc - IIN6)

    ..note:


            1 1                HSPATM,IETO
            0.0000000e+00      time
            5.5e-06              VALUE
            12.000000e+03      time
            0.00                 VALUE
            18.000000e+03      time
            0.00                 VALUE

            The values are those of a 200-min rainfall event at a uniform
            intensity of 3.3Â·10-4 m/min, followed by 100 min of drainage.

    ..note:

            In case of simultaneous precipitation and evaporation, we impose at
            the surface the net flux, i.e., precipitation minus evaporation.





    Parameters
    ----------
    HSPATM : int, optional
        - =0 for spatially variable atmospheric boundary condition inputs;
        blank or =9999 if unit IIN6 input is to be ignored; otherwise atmospheric BC&#39;s are
        homogeneous in space.
    IETO : int, optional
        - =0 for linear interpolation of the atmospheric boundary condition inputs between different
        - otherwise the inputs are assigned as a piecewise constant function (ietograph).
        The default is 0.
    time : list
        ATMBC Times in seconds. The default is None.
    VALUE : list
        List of array. The default is [Precipitation, EvapoTranspiration].
    show : bool, optional
        Plot atmbc. The default is False.
    verbose : bool, optional
        Display. The default is False.
    **kwargs

    Returns
    -------

    ..note:

            - Update parm file (NPRT).
            - Update CATHYH file (MAXPRT).
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simu</span><span class="o">.</span><span class="n">update_atmbc</span><span class="p">(</span>
                    <span class="n">HSPATM</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">IETO</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">time</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">df_atmbc_hourly</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]),</span>
                    <span class="n">netValue</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">df_atmbc_hourly</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]),</span>
<span class="p">)</span>
<span class="n">simu</span><span class="o">.</span><span class="n">show_input</span><span class="p">(</span><span class="s1">&#39;atmbc&#39;</span><span class="p">)</span>
</pre></div>
</div>
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">ğŸ”„ <span style="font-weight: bold">Update atmbc</span>
</pre><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">ğŸ”„ <span style="font-weight: bold">update parm file </span>
</pre><img alt="../../../_images/output_29_2.png" src="../../../_images/output_29_2.png" />
</section>
<section id="scenario-with-varying-feddes-parameters">
<h2>Scenario with varying Feddes parameters<a class="headerlink" href="#scenario-with-varying-feddes-parameters" title="Link to this heading">#</a></h2>
<p>In <strong>Scenario 2</strong>, we additionally <strong>excluded the effect of oxygen
stress</strong>, whereby roots could take up water even when soil moisture
exceeded a threshold according to the Feddes approach</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">simu</span><span class="o">.</span><span class="n">update_soil</span><span class="p">(</span><span class="n">FP</span><span class="o">=</span><span class="n">new_feddes_parameters</span><span class="p">)</span>
</pre></div>
</div>
<p>We considered two test cases in <strong>Scenario 3</strong>. Starting from Scenario
2, we assumed a <strong>homogeneous rooting depth</strong> of 0.3 m in the first case
and of 2.0 m in the second one.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">simu</span><span class="o">.</span><span class="n">update_soil</span><span class="p">(</span><span class="n">FP</span><span class="o">=</span><span class="n">new_feddes_parameters</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># first we read the current soil file</span>
<span class="c1"># --------------------------------</span>
<span class="n">simu</span><span class="o">.</span><span class="n">update_veg_map</span><span class="p">()</span>
<span class="n">df_soil_het</span><span class="p">,</span> <span class="n">df_FP</span> <span class="o">=</span> <span class="n">simu</span><span class="o">.</span><span class="n">read_inputs</span><span class="p">(</span><span class="s1">&#39;soil&#39;</span><span class="p">)</span>

<span class="c1"># show Feddes parameters table</span>
<span class="c1"># --------------------------------</span>
<span class="n">df_FP</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PCANA</th>
      <th>PCREF</th>
      <th>PCWLT</th>
      <th>ZROOT</th>
      <th>PZ</th>
      <th>OMGC</th>
    </tr>
    <tr>
      <th>Veg. Indice</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>-4.0</td>
      <td>-150.0</td>
      <td>0.001</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>-4.0</td>
      <td>-150.0</td>
      <td>0.300</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>-4.0</td>
      <td>-150.0</td>
      <td>0.400</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>-4.0</td>
      <td>-150.0</td>
      <td>0.500</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>-4.0</td>
      <td>-150.0</td>
      <td>0.800</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.0</td>
      <td>-4.0</td>
      <td>-150.0</td>
      <td>0.900</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.0</td>
      <td>-4.0</td>
      <td>-150.0</td>
      <td>1.000</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.0</td>
      <td>-4.0</td>
      <td>-150.0</td>
      <td>2.000</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div><p>From the table above we observe the values of the Feddes parameters for
the different zones defined in the figure above. Here Zroot is varying
according to the root map zone.</p>
</section>
<section id="check-soil-properties">
<h2>Check soil properties<a class="headerlink" href="#check-soil-properties" title="Link to this heading">#</a></h2>
<p>The project folder includes: - A file with <strong>homogeneous</strong> properties -
A file with <strong>heterogeneous</strong> properties for which the hydraulic
conductivity of the layer number 6 is set to <span class="math notranslate nohighlight">\(0.001 m-s^{-1}\)</span>
(&gt;0.000073 for other layers)</p>
<p>The soil is discretise in 3 distinct layers:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Depth
(cm)</p></th>
<th class="head"><p>P
orosity</p></th>
<th class="head"><p>R
esidual
m
oisture
content</p></th>
<th class="head"><p>Van
Ge
nuchten
/
(cm^-1)</p></th>
<th class="head"><p>Van
Ge
nuchten
n</p></th>
<th class="head"><p>S
pecific
storage
coef
ficient
(m^-1)</p></th>
<th class="head"><p>Sa
turated
hy
draulic
condu
ctivity
(m/s)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0-80</p></td>
<td><p>0.43</p></td>
<td><p>0.078</p></td>
<td><p>0.036</p></td>
<td><p>1.56</p></td>
<td><p>1.00 x
10^-3</p></td>
<td><p>7.3 x
10^-5</p></td>
</tr>
<tr class="row-odd"><td><p>80-140
(Tile
-drain)</p></td>
<td><p>0.43</p></td>
<td><p>0.078</p></td>
<td><p>0.036</p></td>
<td><p>1.56</p></td>
<td><p>1.00 x
10^-3</p></td>
<td><p>1.0 x
10^-3</p></td>
</tr>
<tr class="row-even"><td><p>140â€“500</p></td>
<td><p>0.43</p></td>
<td><p>0.078</p></td>
<td><p>0.036</p></td>
<td><p>1.56</p></td>
<td><p>1.00 x
10^-3</p></td>
<td><p>7.3 x
10^-5</p></td>
</tr>
</tbody>
</table>
</div>
<p>``<code class="docutils literal notranslate"><span class="pre">{note}</span> <span class="pre">Van</span> <span class="pre">Genuchten</span> <span class="pre">parameters</span> <span class="pre">in</span> <span class="pre">CATHY</span> <span class="pre">-</span></code>PERMX<code class="docutils literal notranslate"><span class="pre">(NSTR,</span> <span class="pre">NZONE):</span> <span class="pre">saturated</span> <span class="pre">hydraulic</span> <span class="pre">conductivity</span> <span class="pre">-</span> <span class="pre">xx</span> <span class="pre">-</span></code>PERMY<code class="docutils literal notranslate"><span class="pre">(NSTR,</span> <span class="pre">NZONE):</span> <span class="pre">saturated</span> <span class="pre">hydraulic</span> <span class="pre">conductivity</span> <span class="pre">-</span> <span class="pre">yy</span> <span class="pre">-</span></code>PERMZ<code class="docutils literal notranslate"><span class="pre">(NSTR,</span> <span class="pre">NZONE):</span> <span class="pre">saturated</span> <span class="pre">hydraulic</span> <span class="pre">conductivity</span> <span class="pre">-</span> <span class="pre">zz</span> <span class="pre">-</span></code>ELSTOR<code class="docutils literal notranslate"><span class="pre">(NSTR,</span> <span class="pre">NZONE):</span> <span class="pre">specific</span> <span class="pre">storage</span> <span class="pre">-</span></code>POROS`
(NSTR, NZONE): porosity (moisture content at saturation) =
<a href="#id5"><span class="problematic" id="id6">:raw-latex:`\thetaS`</span></a></p>
<p>Retention curves parameters VGN, VGRMC, and VGPSAT - <code class="docutils literal notranslate"><span class="pre">VGNCELL</span></code> (NSTR,
NZONE): van Genuchten curve exponent = n - <code class="docutils literal notranslate"><span class="pre">VGRMCCELL</span></code> (NSTR, NZONE):
residual moisture content = <a href="#id7"><span class="problematic" id="id8">:raw-latex:`\thetaR`</span></a> - <code class="docutils literal notranslate"><span class="pre">VGPSATCELL</span></code> (NSTR,
NZONE): van Genuchten curve exponent â€“&gt; - <code class="docutils literal notranslate"><span class="pre">VGPSAT</span></code> == -1/alpha (with
alpha expressed in [L-1]); ```</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_soil</span><span class="p">,</span> <span class="n">df_FP</span> <span class="o">=</span> <span class="n">simu</span><span class="o">.</span><span class="n">read_inputs</span><span class="p">(</span><span class="s1">&#39;soil&#39;</span><span class="p">)</span>
<span class="n">df_soil</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>PERMX</th>
      <th>PERMY</th>
      <th>PERMZ</th>
      <th>ELSTOR</th>
      <th>POROS</th>
      <th>VGNCELL</th>
      <th>VGRMCCELL</th>
      <th>VGPSATCELL</th>
    </tr>
    <tr>
      <th>str</th>
      <th>zone</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <th>0</th>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.00001</td>
      <td>0.55</td>
      <td>1.46</td>
      <td>0.15</td>
      <td>0.03125</td>
    </tr>
    <tr>
      <th>1</th>
      <th>0</th>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.00001</td>
      <td>0.55</td>
      <td>1.46</td>
      <td>0.15</td>
      <td>0.03125</td>
    </tr>
    <tr>
      <th>2</th>
      <th>0</th>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.00001</td>
      <td>0.55</td>
      <td>1.46</td>
      <td>0.15</td>
      <td>0.03125</td>
    </tr>
    <tr>
      <th>3</th>
      <th>0</th>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.00001</td>
      <td>0.55</td>
      <td>1.46</td>
      <td>0.15</td>
      <td>0.03125</td>
    </tr>
    <tr>
      <th>4</th>
      <th>0</th>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.00001</td>
      <td>0.55</td>
      <td>1.46</td>
      <td>0.15</td>
      <td>0.03125</td>
    </tr>
    <tr>
      <th>5</th>
      <th>0</th>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.00001</td>
      <td>0.55</td>
      <td>1.46</td>
      <td>0.15</td>
      <td>0.03125</td>
    </tr>
    <tr>
      <th>6</th>
      <th>0</th>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.00001</td>
      <td>0.55</td>
      <td>1.46</td>
      <td>0.15</td>
      <td>0.03125</td>
    </tr>
    <tr>
      <th>7</th>
      <th>0</th>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.00001</td>
      <td>0.55</td>
      <td>1.46</td>
      <td>0.15</td>
      <td>0.03125</td>
    </tr>
    <tr>
      <th>8</th>
      <th>0</th>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.00001</td>
      <td>0.55</td>
      <td>1.46</td>
      <td>0.15</td>
      <td>0.03125</td>
    </tr>
    <tr>
      <th>9</th>
      <th>0</th>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.00001</td>
      <td>0.55</td>
      <td>1.46</td>
      <td>0.15</td>
      <td>0.03125</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">layers2plot</span><span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span>
                        <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span>
                       <span class="p">)</span>
<span class="n">axs</span><span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="p">):</span>
    <span class="n">simu</span><span class="o">.</span><span class="n">show_input</span><span class="p">(</span>
                    <span class="n">prop</span><span class="o">=</span><span class="s2">&quot;soil&quot;</span><span class="p">,</span>
                    <span class="n">yprop</span><span class="o">=</span><span class="s2">&quot;PERMX&quot;</span><span class="p">,</span>
                    <span class="n">layer_nb</span><span class="o">=</span><span class="n">layers2plot</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span>
                    <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                   <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;square&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;layer&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<img alt="../../../_images/output_35_0.png" src="../../../_images/output_35_0.png" />
<p>Read soil file with Tile-drain (and update existing soil file)</p>
<p><code class="docutils literal notranslate"><span class="pre">{warning}</span> <span class="pre">pyCATHY</span> <span class="pre">naming</span> <span class="pre">convention</span> <span class="pre">The</span> <span class="pre">project</span> <span class="pre">folder</span> <span class="pre">comes</span> <span class="pre">with</span> <span class="pre">the</span> <span class="pre">default</span> <span class="pre">naming</span> <span class="pre">convention</span> <span class="pre">for</span> <span class="pre">the</span> <span class="pre">filenames.</span> <span class="pre">If</span> <span class="pre">you</span> <span class="pre">decide</span> <span class="pre">to</span> <span class="pre">rename</span> <span class="pre">the</span> <span class="pre">`soil</span></code> file, then you have to update the pyCATHY wrapper with the new values (this will overwrite the soil file).`</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define the path to the soil file</span>
<span class="n">soilfile_het</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">simu</span><span class="o">.</span><span class="n">workdir</span><span class="p">,</span><span class="n">simu</span><span class="o">.</span><span class="n">project_name</span><span class="p">,</span><span class="s1">&#39;input&#39;</span><span class="p">,</span><span class="s1">&#39;soil_het&#39;</span><span class="p">)</span>

<span class="c1"># define the path to the dem_parameter file</span>
<span class="n">dem_parmfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">simu</span><span class="o">.</span><span class="n">workdir</span><span class="p">,</span><span class="n">simu</span><span class="o">.</span><span class="n">project_name</span><span class="p">,</span><span class="s1">&#39;input&#39;</span><span class="p">,</span><span class="s1">&#39;dem_parameters&#39;</span><span class="p">)</span>

<span class="c1"># define the path to the dem_parameter file</span>
<span class="n">dempar</span> <span class="o">=</span> <span class="n">in_CT</span><span class="o">.</span><span class="n">read_dem_parameters</span><span class="p">(</span><span class="n">dem_parmfile</span><span class="p">)</span>

<span class="c1"># read soil heterogeneous file</span>
<span class="n">df_soil_het</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">in_CT</span><span class="o">.</span><span class="n">read_soil</span><span class="p">(</span><span class="n">soilfile_het</span><span class="p">,</span><span class="n">dempar</span><span class="p">,</span><span class="n">MAXVEG</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">df_soil_het</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>PERMX</th>
      <th>PERMY</th>
      <th>PERMZ</th>
      <th>ELSTOR</th>
      <th>POROS</th>
      <th>VGNCELL</th>
      <th>VGRMCCELL</th>
      <th>VGPSATCELL</th>
    </tr>
    <tr>
      <th>str</th>
      <th>zone</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <th>0</th>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.001</td>
      <td>0.43</td>
      <td>1.56</td>
      <td>0.078</td>
      <td>0.27778</td>
    </tr>
    <tr>
      <th>1</th>
      <th>0</th>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.001</td>
      <td>0.43</td>
      <td>1.56</td>
      <td>0.078</td>
      <td>0.27778</td>
    </tr>
    <tr>
      <th>2</th>
      <th>0</th>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.001</td>
      <td>0.43</td>
      <td>1.56</td>
      <td>0.078</td>
      <td>0.27778</td>
    </tr>
    <tr>
      <th>3</th>
      <th>0</th>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.001</td>
      <td>0.43</td>
      <td>1.56</td>
      <td>0.078</td>
      <td>0.27778</td>
    </tr>
    <tr>
      <th>4</th>
      <th>0</th>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.001</td>
      <td>0.43</td>
      <td>1.56</td>
      <td>0.078</td>
      <td>0.27778</td>
    </tr>
    <tr>
      <th>5</th>
      <th>0</th>
      <td>0.001000</td>
      <td>0.001000</td>
      <td>0.001000</td>
      <td>0.001</td>
      <td>0.43</td>
      <td>1.56</td>
      <td>0.078</td>
      <td>0.27778</td>
    </tr>
    <tr>
      <th>6</th>
      <th>0</th>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.001</td>
      <td>0.43</td>
      <td>1.56</td>
      <td>0.078</td>
      <td>0.27778</td>
    </tr>
    <tr>
      <th>7</th>
      <th>0</th>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.001</td>
      <td>0.43</td>
      <td>1.56</td>
      <td>0.078</td>
      <td>0.27778</td>
    </tr>
    <tr>
      <th>8</th>
      <th>0</th>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.001</td>
      <td>0.43</td>
      <td>1.56</td>
      <td>0.078</td>
      <td>0.27778</td>
    </tr>
    <tr>
      <th>9</th>
      <th>0</th>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.001</td>
      <td>0.43</td>
      <td>1.56</td>
      <td>0.078</td>
      <td>0.27778</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simu</span><span class="o">.</span><span class="n">update_soil</span><span class="p">(</span><span class="n">SPP</span><span class="o">=</span><span class="n">df_soil_het</span><span class="p">)</span>
</pre></div>
</div>
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">ğŸ”„ <span style="font-weight: bold">Update soil</span>
</pre><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">homogeneous soil
</pre><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">layers2plot</span><span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span>
                        <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span>
                       <span class="p">)</span>
<span class="n">axs</span><span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="p">):</span>
    <span class="n">simu</span><span class="o">.</span><span class="n">show_input</span><span class="p">(</span>
                    <span class="n">prop</span><span class="o">=</span><span class="s2">&quot;soil&quot;</span><span class="p">,</span>
                    <span class="n">yprop</span><span class="o">=</span><span class="s2">&quot;PERMX&quot;</span><span class="p">,</span>
                    <span class="n">layer_nb</span><span class="o">=</span><span class="n">layers2plot</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span>
                    <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                   <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;square&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;layer&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<img alt="../../../_images/output_39_0.png" src="../../../_images/output_39_0.png" />
<section id="run-simulation">
<h3>2. Run simulation<a class="headerlink" href="#run-simulation" title="Link to this heading">#</a></h3>
<p>Once all the inputs files are updated according to the scenario, it is
good practice to run first the preprocessor in verbose = True mode to
check if the preprocessing step worked.</p>
<p>Then we can run the processor. As the number of times and points are
large in this example it is recommanded to execute it locally.</p>
<p>```python simu.run_preprocessor(verbose=True) simu.run_processor(
IPRT1=2, ROWMAX=247, COLMAX=221 )</p>
<p><code class="docutils literal notranslate"><span class="pre">{tip}</span> <span class="pre">Check</span> <span class="pre">before</span> <span class="pre">running</span> <span class="pre">the</span> <span class="pre">simulations</span> <span class="pre">Before</span> <span class="pre">running</span> <span class="pre">the</span> <span class="pre">simulation</span> <span class="pre">it</span> <span class="pre">is</span> <span class="pre">recommanded</span> <span class="pre">to</span> <span class="pre">check</span> <span class="pre">the</span> <span class="pre">parm</span> <span class="pre">file</span></code></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#simu.read_inputs(&#39;parm&#39;)</span>
<span class="n">parm_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">simu</span><span class="o">.</span><span class="n">workdir</span><span class="p">,</span><span class="n">simu</span><span class="o">.</span><span class="n">project_name</span><span class="p">,</span><span class="s1">&#39;input&#39;</span><span class="p">,</span><span class="s1">&#39;parm&#39;</span><span class="p">)</span>
<span class="n">parm</span> <span class="o">=</span> <span class="n">in_CT</span><span class="o">.</span><span class="n">read_parm</span><span class="p">(</span><span class="n">parm_file</span><span class="p">)</span>
</pre></div>
</div>
<p>Among all the parameters (check using parm.keys()) controlling the
behavior of the simulation here is a selection of some important ones:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">IPRT1</span></code> Flag for output of input and coordinate data;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TRAFLAG</span></code> lag for the choice of the data assimilation scheme;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DTMIN</span></code> Minimum FLOW3D time step size allowed;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NPRT</span></code> Number of time values for detailed nodal output and element
velocity output;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(TIMPRT(I),I=1,NPRT)</span></code> Time values for detailed output.</p></li>
</ul>
</section>
<section id="plot-outputs">
<h3>3. Plot outputs<a class="headerlink" href="#plot-outputs" title="Link to this heading">#</a></h3>
</section>
</section>
<section id="plot-streamflow">
<h2>Plot streamflow<a class="headerlink" href="#plot-streamflow" title="Link to this heading">#</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%% Another interesting graph looking at the **streamflow = f(time)**</span>
<span class="n">simu</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="s2">&quot;hgraph&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../../_images/output_46_0.png" src="../../../_images/output_46_0.png" />
</section>
<section id="plot-spatial-actual-et">
<h2>Plot spatial actual ET<a class="headerlink" href="#plot-spatial-actual-et" title="Link to this heading">#</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">simu</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s1">&#39;spatialET&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">ti</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">no file specified
</pre><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">contour</span><span class="o">.</span><span class="n">QuadContourSet</span> <span class="n">at</span> <span class="mh">0x7ff41ed22a10</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="../../../_images/output_48_2.png" src="../../../_images/output_48_2.png" />
</section>
<section id="plot-the-ground-water-depth-gwd">
<h2>Plot the Ground Water Depth (GWD)<a class="headerlink" href="#plot-the-ground-water-depth-gwd" title="Link to this heading">#</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">])</span>

<span class="n">cmap</span> <span class="o">=</span> <span class="n">simu</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s1">&#39;WTD&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ti</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">simu</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s1">&#39;WTD&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ti</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">)</span>
</pre></div>
</div>
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">no file specified
</pre><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">no file specified
</pre><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">Colorbar</span> <span class="n">at</span> <span class="mh">0x7ff41eeb4c70</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="../../../_images/output_50_3.png" src="../../../_images/output_50_3.png" />
<p><code class="docutils literal notranslate"><span class="pre">{tip}</span> <span class="pre">Compute</span> <span class="pre">differences</span> <span class="pre">In</span> <span class="pre">order</span> <span class="pre">to</span> <span class="pre">compute</span> <span class="pre">the</span> <span class="pre">differences</span> <span class="pre">between</span> <span class="pre">two</span> <span class="pre">times</span> <span class="pre">pass</span> <span class="pre">a</span> <span class="pre">list</span> <span class="pre">of</span> <span class="pre">time</span> <span class="pre">to</span> <span class="pre">ti</span></code></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simu</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s1">&#39;WTD&#39;</span><span class="p">,</span><span class="n">ti</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">no file specified
</pre><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">contour</span><span class="o">.</span><span class="n">QuadContourSet</span> <span class="n">at</span> <span class="mh">0x7ff41f2cd0c0</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="../../../_images/output_52_2.png" src="../../../_images/output_52_2.png" />
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content/FromLiterature/LaCecilia2023_myst"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../../DA/plot_3_run_sequentialDA_SMC.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Read SMC sensors observations to assimilate</p>
      </div>
    </a>
    <a class="right-next"
       href="../Zanetti_WRR_2024_myst/Zanetti_WRR_2024_myst.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Zanetti, F., Botter, G., &amp; Camporese, M. (2024)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-the-required-packages">Importing the required packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-cathy-simulation-object">Create a CATHY simulation object</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing-step">1. Preprocessing step</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build-the-mesh">Build the mesh</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-root-map-properties">Define root map properties</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-the-atmospheric-boundary-conditions">Setting the atmospheric boundary conditions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scenario-with-varying-feddes-parameters">Scenario with varying Feddes parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#check-soil-properties">Check soil properties</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#run-simulation">2. Run simulation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-outputs">3. Plot outputs</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-streamflow">Plot streamflow</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-spatial-actual-et">Plot spatial actual ET</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-ground-water-depth-gwd">Plot the Ground Water Depth (GWD)</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By B. Mary
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2022, B. Mary.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on May 21, 2025.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>