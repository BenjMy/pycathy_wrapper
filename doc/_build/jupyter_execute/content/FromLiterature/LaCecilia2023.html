

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>D. La Cecicilia and M. Camporese (2022) &#8212; pyCATHY &lt;span class=&#34;project-release&#34;&gt;v0.1.1&lt;/span&gt;</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/thebelab-helper.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script src="../../../_static/design-tabs.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'jupyter_execute/content/FromLiterature/LaCecilia2023';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    <p class="title logo__title">pyCATHY <span class="project-release">v0.1.1</span></p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../content/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../content/installing.html">Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../content/citing.html">Citing pyCATHY</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../content/gettingstarted.html">Getting Started</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Gallery of examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../content/SSHydro/index.html">Surface subsurface hydrological model</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../content/SSHydro/plot_1_pyCATHY_weilletal.html">Weil et al example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../content/SSHydro/plot_2_pyCATHY_inputs.html">Input plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../content/SSHydro/plot_3_meshing_from_Camporese.html">Meshing from a Digital Elevation Model (DEM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../content/SSHydro/plot_3_meshing_from_weill.html">Meshing from a Digital Elevation Model (DEM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../content/SSHydro/plot_3b_soil3d_from_weill.html">Soil 3d from a Digital Elevation Model (DEM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../content/SSHydro/plot_3c_bc_from_weill.html">Update and show Boundary conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../content/SSHydro/plot_3c_saptial_atmbc_from_weill.html">Update with distributed atmospheric bc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../content/SSHydro/plot_4_pyCATHY_outputs.html">Output plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../content/SSHydro/plot_4b_waterTable_from_weill.html">Plot Water Table</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../content/DA/index.html">Data Assimilation</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../content/DA/plot_Weilletal_sensitivityAnalysis.html">Sensitivity analysis</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">From the literature</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../content/FromLiterature/LaCecilia2023.html">D. La Cecicilia and M. Camporese (2022)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference documentation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../content/api/api.html">API reference: The <code class="docutils literal notranslate"><span class="pre">pyCATHY</span></code> package</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../content/api/generated/cathy_tools.html">cathy_tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../content/api/generated/importers.cathy_outputs.html">importers.cathy_outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../content/api/generated/importers.cathy_inputs.html">importers.cathy_inputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../content/api/generated/DA.cathy_DA.html">DA.cathy_DA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../content/api/generated/ERT.petro_Archie.html">ERT.petro_Archie</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../content/api/generated/ERT.simulate_ERT.html">ERT.simulate_ERT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../content/api/generated/sensitivity.html">sensitivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../content/api/generated/plotters.cathy_plots.html">plotters.cathy_plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../content/api/generated/pyCATHY.cathy_utils.html">pyCATHY.cathy_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../content/api/generated/pyCATHY.meshtools.html">pyCATHY.meshtools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../content/change_log.html">Change log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../content/cathy_list_citation.html">Who uses CATHY ?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../content/references.html">References</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting help and contributed</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../content/contribute.html">Contribute and support</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/BenjMy/pycathy_wrapper/master?urlpath=lab/tree/doc/jupyter_execute/content/FromLiterature/LaCecilia2023.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/BenjMy/pycathy_wrapper/blob/master/doc/jupyter_execute/content/FromLiterature/LaCecilia2023.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/BenjMy/pycathy_wrapper" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/BenjMy/pycathy_wrapper/edit/master/doc/jupyter_execute/content/FromLiterature/LaCecilia2023.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/BenjMy/pycathy_wrapper/issues/new?title=Issue%20on%20page%20%2Fjupyter_execute/content/FromLiterature/LaCecilia2023.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/jupyter_execute/content/FromLiterature/LaCecilia2023.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>D. La Cecicilia and M. Camporese (2022)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-the-required-packages">Importing the required packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-cathy-simulation-object">Create a CATHY simulation object</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing-step">1. Preprocessing step</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#build-the-mesh">Build the mesh</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-root-map-properties">Define root map properties</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-the-atmospheric-boundary-conditions">Setting the atmospheric boundary conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scenario-with-varying-feddes-parameters">Scenario with varying Feddes parameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#check-soil-properties">Check soil properties</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-simulation">2. Run simulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-outputs">3. Plot outputs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-streamflow">Plot streamflow</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-spatial-actual-et">Plot spatial actual ET</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-ground-water-depth-gwd">Plot the Ground Water Depth (GWD)</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <hr class="docutils" />
<p>title: Resolving streamflow diel fluctuations in a small agricultural catchment with an integrated surface-subsurface hydrological model
subtitle: Notebook to reproduce the figures
doi: https://doi.org/10.1002/hyp.14768
license: CC-BY-4.0
github: https://github.com/BenjMy/pycathy_wrapper/tree/main/doc/content/FromLiterature
subject: Tutorial
venue: pyCATHY
authors:</p>
<ul class="simple">
<li><p>name: D. La Cecilia
email: daniele.lacecilia&#64;eawag.ch
corresponding: true
orcid: 0000-0002-7859-8394
affiliations:</p>
<ul>
<li><p>Department of Environmental Chemistry, Eawag, Swiss Federal Institute of Aquatic Science and Technology, D√ºbendorf, Switzerland</p></li>
<li><p>Water Resources and Drinking Water, Eawag, Swiss Federal Institute of Aquatic Science and Technology, D√ºbendorf, Switzerland</p></li>
</ul>
</li>
<li><p>name: M. Camporese
orcid: 0000-0002-7505-798X
affiliations:</p>
<ul>
<li><p>Department of Civil, Environmental and Architectural Engineering, University of Padova, Padova, Italy</p></li>
</ul>
</li>
<li><p>name: B. Mary
orcid: 0000-0001-7199-2885
affiliations:</p>
<ul>
<li><p>Department of Geosciences, University of Padova, Padova, Italy
roles:</p></li>
<li><p>Notebook preparation</p></li>
</ul>
</li>
</ul>
<hr class="docutils" />
<section id="d-la-cecicilia-and-m-camporese-2022">
<h1>D. La Cecicilia and M. Camporese (2022)<a class="headerlink" href="#d-la-cecicilia-and-m-camporese-2022" title="Permalink to this heading">#</a></h1>
<p>This is a notebook to reproduce outputs from  <a class="reference external" href="https://onlinelibrary.wiley.com/doi/10.1002/hyp.14768">La Cecilia and Camporese (2022)</a></p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p class="rubric">Cite this work</p>
<p>We believe in a community-driven approach of open-source tools that are
composable and extensible. If you use this notebook cite the work as:</p>
<blockquote>
<div><p>La Cecilia, D., and M. Camporese. 2022. Resolving streamflow diel fluctuations in a small agricultural catchment with an integrated surface‚Äêsubsurface hydrological model. Hydrological Processes 36(12). doi: 10.1002/hyp.14768.</p>
</div></blockquote>
</div>
<p>The notebooks describes:</p>
<ol class="arabic simple">
<li><p><strong>Preprocessing step</strong>: how to build a mesh with different vegetation land cover and a soil including tile drains.</p>
<ul class="simple">
<li><p>Changing atmospheric boundary conditions <strong>Atmbc parameters</strong></p></li>
<li><p>Changing <strong>Feddes parameters</strong></p></li>
<li><p>Changing <strong>Soil parameters</strong></p></li>
</ul>
</li>
<li><p><strong>Simulation</strong> (very long not recommanded to execute): solve the surface-subsurface flow during a year considering different scenarios.</p></li>
<li><p><strong>Plot outputs</strong>: analysis of the results</p>
<ul class="simple">
<li><p>spatial distribution of <strong>actual ET</strong></p></li>
<li><p>spatial distribution of <strong>groundwater level depth</strong></p></li>
</ul>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In Progress</p>
<p>All input and ouput data from this study will be openly and publicly
available through the Eawag repository ERIC at <a class="reference external" href="https://opendata.eawag.ch/group">https://opendata.eawag.ch/group</a> under the project folder <strong>‚ÄúNAWA-Flowpath‚Äù</strong> to ensure that these data are <strong>FAIR: Findable, Accessible, Interoperable and Reproducible</strong>.</p>
<p>The CATHY model is freely available at <a class="reference external" href="https://bitbucket.org/cathy1_0/cathy">https://bitbucket.org/cathy1_0/cathy/</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pooch</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">opendata</span><span class="o">.</span><span class="n">eawag</span><span class="o">.</span><span class="n">ch</span><span class="o">/</span><span class="n">group</span>
</pre></div>
</div>
</div>
<div class="admonition-what-you-should-already-know admonition">
<p class="admonition-title">What you should already know</p>
<p>In order to complete this tutorial, you should be relatively familiar with using the pyCATHY for:</p>
<ul class="simple">
<li><p>Building a mesh from a DEM (See <span class="xref std std-doc">../content/SSHydro/index</span> for more information.)</p></li>
<li><p>Updating soil inputs</p></li>
<li><p>‚Ä¶</p></li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Found a bug üêõ/ a typo ? <a class="reference external" href="mailto:benjamin&#46;mary&#37;&#52;&#48;unipd&#46;it">Email me</a></p>
</div>
<section id="importing-the-required-packages">
<h2>Importing the required packages<a class="headerlink" href="#importing-the-required-packages" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> in order to <strong>plot</strong> the data;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cathy_tools</span></code> is the main object controlling the simulation;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pyCATHY.importers</span></code> allows you to <strong>read CATHY input</strong> files;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pyCATHY.importers</span></code> allows you to <strong>read CATHY output</strong> files;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pyCATHY.plotters</span></code> is a set of functions in order to plot simulation outputs.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pyCATHY</span> <span class="kn">import</span> <span class="n">cathy_tools</span>
<span class="kn">from</span> <span class="nn">pyCATHY.importers</span> <span class="kn">import</span> <span class="n">cathy_inputs</span> <span class="k">as</span> <span class="n">in_CT</span>
<span class="kn">from</span> <span class="nn">pyCATHY.importers</span> <span class="kn">import</span> <span class="n">cathy_outputs</span> <span class="k">as</span> <span class="n">out_CT</span>
<span class="kn">from</span> <span class="nn">pyCATHY.plotters</span> <span class="kn">import</span> <span class="n">cathy_plots</span> <span class="k">as</span> <span class="n">cplt</span>

<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="c1"># set some default plotting parameters for nicer looking plots</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;axes.grid&quot;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;grid.color&quot;</span><span class="p">:</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="s2">&quot;grid.linestyle&quot;</span><span class="p">:</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">:(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)})</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-a-cathy-simulation-object">
<h2>Create a CATHY simulation object<a class="headerlink" href="#create-a-cathy-simulation-object" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initiate a CATHY model</span>
<span class="c1"># ------------------------</span>
<span class="n">path2prj</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span>  <span class="c1"># add your local path here</span>
<span class="n">simu</span> <span class="o">=</span> <span class="n">cathy_tools</span><span class="o">.</span><span class="n">CATHY</span><span class="p">(</span><span class="n">dirName</span><span class="o">=</span><span class="n">path2prj</span><span class="p">,</span> <span class="n">prj_name</span><span class="o">=</span><span class="s2">&quot;LaCecilia_2022_HP&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">üèÅ <span style="font-weight: bold">Initiate CATHY object</span>
</pre>
</div></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Multiples scenario</p>
<p>If you want to run multiple scenario and compare them it is recommanded to create a single CATHY object for each of the simulations.
For instance:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">simu_scenario1</span> <span class="o">=</span> <span class="n">cathy_tools</span><span class="o">.</span><span class="n">CATHY</span><span class="p">(</span><span class="n">dirName</span><span class="o">=</span><span class="n">ThePathToYourProject</span><span class="p">,</span> <span class="n">prj_name</span><span class="o">=</span><span class="s2">&quot;scenario1&quot;</span><span class="p">)</span>
<span class="n">simu_scenario2</span> <span class="o">=</span> <span class="n">cathy_tools</span><span class="o">.</span><span class="n">CATHY</span><span class="p">(</span><span class="n">dirName</span><span class="o">=</span><span class="n">ThePathToYourProject</span><span class="p">,</span> <span class="n">prj_name</span><span class="o">=</span><span class="s2">&quot;scenario2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="preprocessing-step">
<h2>1. Preprocessing step<a class="headerlink" href="#preprocessing-step" title="Permalink to this heading">#</a></h2>
<p>Starting from DEM data (dtm_13.val) and parameters (hap.in) files, the preprocessing produce a complete set of files describing physiographic features of a drainage system. Such files represent the preprocessing input files for CATHY simulation.</p>
<section id="build-the-mesh">
<h3>Build the mesh<a class="headerlink" href="#build-the-mesh" title="Permalink to this heading">#</a></h3>
<p>The <strong>DEM</strong> should be accurate enough to account for an explicit representation of tile trains (diameter between 10 and 60 cm)</p>
<ul class="simple">
<li><p>spatial resolution of 20x20 m necessary</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Outside the region of interest the elevation are set to -9999</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DEM</span><span class="p">,</span> <span class="n">header_DEM</span> <span class="o">=</span> <span class="n">simu</span><span class="o">.</span><span class="n">read_inputs</span><span class="p">(</span><span class="s1">&#39;dem&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">DEM</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="n">simu</span><span class="o">.</span><span class="n">show_input</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="s2">&quot;dem&quot;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">üîÑ <span style="font-weight: bold">Update hap.in file</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">üîÑ <span style="font-weight: bold">update dem_parameters file </span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">üîÑ <span style="font-weight: bold">update dem_parameters file </span>
</pre>
</div><img alt="../../../_images/51898e46a130840006f49b3c22c4bfe1ea9f4026d503035b1dd09fc7d19d5367.png" src="../../../_images/51898e46a130840006f49b3c22c4bfe1ea9f4026d503035b1dd09fc7d19d5367.png" />
<img alt="../../../_images/a8b9581bb45077b29c1473b83b387919152d1a5207510c041a7a1edf0973965b.png" src="../../../_images/a8b9581bb45077b29c1473b83b387919152d1a5207510c041a7a1edf0973965b.png" />
</div>
</div>
</section>
<section id="define-root-map-properties">
<h3>Define root map properties<a class="headerlink" href="#define-root-map-properties" title="Permalink to this heading">#</a></h3>
<p>The <strong><code class="docutils literal notranslate"><span class="pre">veg_map</span></code></strong> is a raster file that defined the position of the vegetation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">VEG_MAP</span><span class="p">,</span> <span class="n">header_veg_map</span> <span class="o">=</span> <span class="n">simu</span><span class="o">.</span><span class="n">read_inputs</span><span class="p">(</span><span class="s1">&#39;root_map&#39;</span><span class="p">)</span>
<span class="n">VEG_MAP</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1.],
       [1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1.],
       [1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1.],
       [1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1.],
       [1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1.],
       [1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1.],
       [1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1.],
       [1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1.],
       [1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1.],
       [1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1.],
       [1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1.],
       [1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1.],
       [1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1.],
       [1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1.],
       [1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1.],
       [1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1.],
       [1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1.],
       [1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1.],
       [1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1.],
       [1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">simu</span><span class="o">.</span><span class="n">show_input</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="s2">&quot;root_map&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
               <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/ec5fdca419ac38430490ff0b56bafeb0159e5d4291bd43a34a77ad50cdf0df68.png" src="../../../_images/ec5fdca419ac38430490ff0b56bafeb0159e5d4291bd43a34a77ad50cdf0df68.png" />
</div>
</div>
<p>The figure illustrates the vegetation indices, with each index associated with a corresponding pair of Feddes parameters. In the northern region, represented by the forested areas, a root depth of 2 meters is considered. However, in the orange patches indicating urban areas, the root depth is set to a significantly smaller value of 1e-3.</p>
<p>Now we check the values of the Feddes parameters associated with the indice of the vegetation</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Feddes parameters</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">PCANA</span></code>: anaerobiosis point</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PCREF</span></code>: field capacity</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PCWLT</span></code>: wilting point</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ZROOT</span></code>: root depth</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PZ</span></code>: pz is an empirical parameter</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">OMGC</span></code>: 0&lt;OMGC&lt;1 Compensatory mechanisms for root water uptake</p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SPP</span><span class="p">,</span> <span class="n">FP</span> <span class="o">=</span> <span class="n">simu</span><span class="o">.</span><span class="n">read_inputs</span><span class="p">(</span><span class="s1">&#39;soil&#39;</span><span class="p">,</span> <span class="n">MAXVEG</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">FP</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">SPP</span><span class="p">,</span> <span class="n">FP</span> <span class="o">=</span> <span class="n">simu</span><span class="o">.</span><span class="n">read_inputs</span><span class="p">(</span><span class="s1">&#39;soil&#39;</span><span class="p">,</span> <span class="n">MAXVEG</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">FP</span>

<span class="nn">File ~/Documents/GitHub/BenjMy/pycathy_wrapper/pyCATHY/cathy_tools.py:3771,</span> in <span class="ni">CATHY.read_inputs</span><span class="nt">(self, filename, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">3768</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">3769</span>     <span class="n">MAXVEG</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MAXVEG</span>
<span class="ne">-&gt; </span><span class="mi">3771</span> <span class="n">df</span> <span class="o">=</span> <span class="n">in_CT</span><span class="o">.</span><span class="n">read_soil</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">3772</span>     <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">workdir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_name</span><span class="p">,</span> <span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">3773</span>     <span class="n">dem_parm</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">3774</span>     <span class="n">MAXVEG</span><span class="o">=</span><span class="n">MAXVEG</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">3775</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3776</span> <span class="c1"># df[0]</span>
<span class="g g-Whitespace">   </span><span class="mi">3777</span> <span class="k">return</span> <span class="n">df</span>

<span class="nn">File ~/Documents/GitHub/BenjMy/pycathy_wrapper/pyCATHY/importers/cathy_inputs.py:393,</span> in <span class="ni">read_soil</span><span class="nt">(soilfile, dem_parm, MAXVEG)</span>
<span class="g g-Whitespace">    </span><span class="mi">391</span> <span class="n">FP_soil_mat</span> <span class="o">=</span> <span class="p">[]</span>
<span class="g g-Whitespace">    </span><span class="mi">392</span> <span class="k">for</span> <span class="n">fp</span> <span class="ow">in</span> <span class="n">FP_soil</span><span class="p">:</span>
<span class="nn">--&gt; 393     FP_soil_mat.append([float(fpi) for fpi</span> in <span class="ni">fp if len</span><span class="nt">(fpi)&gt;0])</span>
<span class="g g-Whitespace">    </span><span class="mi">395</span> <span class="n">FP_soil_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">FP_soil_mat</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">396</span> <span class="n">df_FP</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">FP_soil_mat</span><span class="p">)</span>

<span class="nn">File ~/Documents/GitHub/BenjMy/pycathy_wrapper/pyCATHY/importers/cathy_inputs.py:393,</span> in <span class="ni">&lt;listcomp&gt;</span><span class="nt">(.0)</span>
<span class="g g-Whitespace">    </span><span class="mi">391</span> <span class="n">FP_soil_mat</span> <span class="o">=</span> <span class="p">[]</span>
<span class="g g-Whitespace">    </span><span class="mi">392</span> <span class="k">for</span> <span class="n">fp</span> <span class="ow">in</span> <span class="n">FP_soil</span><span class="p">:</span>
<span class="nn">--&gt; 393     FP_soil_mat.append([float(fpi) for fpi</span> in <span class="ni">fp if len</span><span class="nt">(fpi)&gt;0])</span>
<span class="g g-Whitespace">    </span><span class="mi">395</span> <span class="n">FP_soil_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">FP_soil_mat</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">396</span> <span class="n">df_FP</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">FP_soil_mat</span><span class="p">)</span>

<span class="ne">ValueError</span>: could not convert string to float: &#39;IVGHU\n&#39;
</pre></div>
</div>
</div>
</div>
<p>We can also plot the spatial distribution of the Feddes parameters</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simu</span><span class="o">.</span><span class="n">update_veg_map</span><span class="p">()</span>
<span class="n">simu</span><span class="o">.</span><span class="n">update_soil</span><span class="p">(</span><span class="n">FP_map</span><span class="o">=</span><span class="n">FP</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">excluding outside DEM
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #808000; text-decoration-color: #808000">MAXVEG</span>=<span style="color: #008080; text-decoration-color: #008080; font-weight: bold">8</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #808000; text-decoration-color: #808000">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ </span>‚ö† warning messages above ‚ö†<span style="color: #808000; text-decoration-color: #808000"> ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">
<span style="color: #808000; text-decoration-color: #808000">                            The parm dictionnary is empty</span>
<span style="color: #808000; text-decoration-color: #808000">                            Falling back to defaults to update CATHYH</span>
<span style="color: #808000; text-decoration-color: #808000">                            This can have consequences !!</span>
<span style="color: #808000; text-decoration-color: #808000">                            </span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #808000; text-decoration-color: #808000">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">üîÑ <span style="font-weight: bold">update parm file </span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">üîÑ <span style="font-weight: bold">Update soil</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">homogeneous soil
</pre>
</div><img alt="../../../_images/1e3bb4cd5953c6dfab549a250c26dbe9e63dcc0e736f69cea97fed7083875653.png" src="../../../_images/1e3bb4cd5953c6dfab549a250c26dbe9e63dcc0e736f69cea97fed7083875653.png" />
</div>
</div>
</section>
<section id="setting-the-atmospheric-boundary-conditions">
<h3>Setting the atmospheric boundary conditions<a class="headerlink" href="#setting-the-atmospheric-boundary-conditions" title="Permalink to this heading">#</a></h3>
<p><strong>Scenario 1</strong>, excludes irrigation from the reference simulation. This scenario serves primarily to assess the differences between an agricultural catchment and a natural one.</p>
<p>In order to update the atmospheric boundary conditions we call the following function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">simu</span><span class="o">.</span><span class="n">update_atmbc</span><span class="p">()</span>
</pre></div>
</div>
<p>Remenber that the functions arguments details can be assessed via:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">simu</span><span class="o">.</span><span class="n">update_atmbc</span><span class="p">())</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># first we read and plot the current atmbc file </span>
<span class="c1"># --------------------------------</span>
<span class="n">df_atmbc</span> <span class="o">=</span> <span class="n">simu</span><span class="o">.</span><span class="n">read_inputs</span><span class="p">(</span><span class="s1">&#39;atmbc&#39;</span><span class="p">)</span>
<span class="n">simu</span><span class="o">.</span><span class="n">show_input</span><span class="p">(</span><span class="s1">&#39;atmbc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/f679cc93ce8ed6144385c109444e7c1bfa4f3035ecfce8383793039d9498763d.png" src="../../../_images/f679cc93ce8ed6144385c109444e7c1bfa4f3035ecfce8383793039d9498763d.png" />
</div>
</div>
<p>Given the fact that all the values are defined in net Q (m/s), and that all the values are &gt;0, here the scenario exclude the irrigation from the atmospheric boundary conditions.</p>
<p>Let‚Äôs update the atmbc values without to with irrigation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># first we read the atmbc file </span>
<span class="c1"># --------------------------------</span>
<span class="n">atmbc_hourlyf</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">simu</span><span class="o">.</span><span class="n">workdir</span><span class="p">,</span><span class="n">simu</span><span class="o">.</span><span class="n">project_name</span><span class="p">,</span><span class="s1">&#39;input&#39;</span><span class="p">,</span><span class="s1">&#39;atmbc_hourly&#39;</span><span class="p">)</span>
<span class="n">df_atmbc_hourly</span><span class="p">,</span> <span class="n">HSPATM</span><span class="p">,</span> <span class="n">IETO</span> <span class="o">=</span> <span class="n">in_CT</span><span class="o">.</span><span class="n">read_atmbc</span><span class="p">(</span><span class="n">atmbc_hourlyf</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">simu</span><span class="o">.</span><span class="n">update_atmbc</span><span class="p">)</span>
<span class="n">df_atmbc_hourly</span> <span class="o">=</span> <span class="n">df_atmbc_hourly</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on method update_atmbc in module pyCATHY.cathy_tools:

update_atmbc(HSPATM=1, IETO=0, time=None, VALUE=[None, None], netValue=[], show=False, verbose=False, **kwargs) method of pyCATHY.cathy_tools.CATHY instance
    Atmospheric forcing term (atmbc - IIN6)
    
    ..note:
    
    
            1 1                HSPATM,IETO
            0.0000000e+00      time
            5.5e-06              VALUE
            12.000000e+03      time
            0.00                 VALUE
            18.000000e+03      time
            0.00                 VALUE
    
            The values are those of a 200-min rainfall event at a uniform
            intensity of 3.3¬∑10-4 m/min, followed by 100 min of drainage.
    
    ..note:
    
            In case of simultaneous precipitation and evaporation, we impose at
            the surface the net flux, i.e., precipitation minus evaporation.
    
    
    
    
    
    Parameters
    ----------
    HSPATM : int, optional
        - =0 for spatially variable atmospheric boundary condition inputs;
        blank or =9999 if unit IIN6 input is to be ignored; otherwise atmospheric BC&#39;s are
        homogeneous in space.
    IETO : int, optional
        - =0 for linear interpolation of the atmospheric boundary condition inputs between different different ATMTIM
        - otherwise the inputs are assigned as a piecewise constant function (ietograph).
        The default is 0.
    time : list
        ATMBC Times in seconds. The default is None.
    VALUE : list
        List of array. The default is [Precipitation, EvapoTranspiration].
    show : bool, optional
        Plot atmbc. The default is False.
    verbose : bool, optional
        Display. The default is False.
    **kwargs
    
    Returns
    -------
    
    ..note:
    
            - Update parm file (NPRT).
            - Update CATHYH file (MAXPRT).
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simu</span><span class="o">.</span><span class="n">update_atmbc</span><span class="p">(</span>
                    <span class="n">HSPATM</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">IETO</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">time</span><span class="o">=</span><span class="n">df_atmbc_hourly</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span>
                    <span class="n">netValue</span><span class="o">=</span><span class="n">df_atmbc_hourly</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">simu</span><span class="o">.</span><span class="n">show_input</span><span class="p">(</span><span class="s1">&#39;atmbc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">üîÑ <span style="font-weight: bold">Update atmbc</span>
</pre>
</div><div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="nn">File ~/miniconda3/envs/pyCATHY_doc/lib/python3.10/site-packages/pandas/core/indexes/range.py:345,</span> in <span class="ni">RangeIndex.get_loc</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">    </span><span class="mi">344</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">345</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_range</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">new_key</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">346</span> <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>

<span class="ne">ValueError</span>: -1 is not in range

<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>

<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">simu</span><span class="o">.</span><span class="n">update_atmbc</span><span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>                     <span class="n">HSPATM</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>                     <span class="n">IETO</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>                     <span class="n">time</span><span class="o">=</span><span class="n">df_atmbc_hourly</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>                     <span class="n">netValue</span><span class="o">=</span><span class="n">df_atmbc_hourly</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">],</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="n">simu</span><span class="o">.</span><span class="n">show_input</span><span class="p">(</span><span class="s1">&#39;atmbc&#39;</span><span class="p">)</span>

<span class="nn">File ~/Documents/GitHub/BenjMy/pycathy_wrapper/pyCATHY/cathy_tools.py:1869,</span> in <span class="ni">CATHY.update_atmbc</span><span class="nt">(self, HSPATM, IETO, time, VALUE, netValue, show, verbose, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1865</span>             <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">atmbcfile</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%.3e</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1867</span> <span class="n">atmbcfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="ne">-&gt; </span><span class="mi">1869</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_parm</span><span class="p">(</span><span class="n">TIMPRTi</span><span class="o">=</span><span class="p">[</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">time</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">NPRT</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">TMAX</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">time</span><span class="p">))</span>
<span class="g g-Whitespace">   </span><span class="mi">1870</span> <span class="c1"># self.update_parm(TIMPRTi=time, NPRT=len(time), TMAX=max(time))</span>
<span class="g g-Whitespace">   </span><span class="mi">1871</span> 
<span class="g g-Whitespace">   </span><span class="mi">1872</span> <span class="c1"># don&#39;t need to update if sequential DA as the cathy.exe is already created</span>
<span class="g g-Whitespace">   </span><span class="mi">1873</span> <span class="c1"># ---------------------------------------------------------------------</span>
<span class="g g-Whitespace">   </span><span class="mi">1874</span> <span class="k">if</span> <span class="s2">&quot;omit_cathyH&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>

<span class="nn">File ~/miniconda3/envs/pyCATHY_doc/lib/python3.10/site-packages/pandas/core/series.py:1007,</span> in <span class="ni">Series.__getitem__</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">   </span><span class="mi">1004</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">1006</span> <span class="k">elif</span> <span class="n">key_is_scalar</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1007</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_value</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1009</span> <span class="k">if</span> <span class="n">is_hashable</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1010</span>     <span class="c1"># Otherwise index.get_value will raise InvalidIndexError</span>
<span class="g g-Whitespace">   </span><span class="mi">1011</span>     <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1012</span>         <span class="c1"># For labels that don&#39;t resolve as scalars like tuples and frozensets</span>

<span class="nn">File ~/miniconda3/envs/pyCATHY_doc/lib/python3.10/site-packages/pandas/core/series.py:1116,</span> in <span class="ni">Series._get_value</span><span class="nt">(self, label, takeable)</span>
<span class="g g-Whitespace">   </span><span class="mi">1113</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">1115</span> <span class="c1"># Similar to Index.get_value, but we do not fall back to positional</span>
<span class="ne">-&gt; </span><span class="mi">1116</span> <span class="n">loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1118</span> <span class="k">if</span> <span class="n">is_integer</span><span class="p">(</span><span class="n">loc</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1119</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">[</span><span class="n">loc</span><span class="p">]</span>

<span class="nn">File ~/miniconda3/envs/pyCATHY_doc/lib/python3.10/site-packages/pandas/core/indexes/range.py:347,</span> in <span class="ni">RangeIndex.get_loc</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">    </span><span class="mi">345</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_range</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">new_key</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">346</span>     <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">347</span>         <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">err</span>
<span class="g g-Whitespace">    </span><span class="mi">348</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">Hashable</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">349</span>     <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

<span class="ne">KeyError</span>: -1
</pre></div>
</div>
</div>
</div>
</section>
<section id="scenario-with-varying-feddes-parameters">
<h3>Scenario with varying Feddes parameters<a class="headerlink" href="#scenario-with-varying-feddes-parameters" title="Permalink to this heading">#</a></h3>
<p>In <strong>Scenario 2</strong>, we additionally <strong>excluded the effect of oxygen stress</strong>, whereby roots could take up water even when soil moisture exceeded a threshold according to the Feddes approach</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">simu</span><span class="o">.</span><span class="n">update_soil</span><span class="p">(</span><span class="n">FP</span><span class="o">=</span><span class="n">new_feddes_parameters</span><span class="p">)</span>
</pre></div>
</div>
<p>We considered two test cases in <strong>Scenario 3</strong>. Starting from Scenario 2, we assumed a <strong>homogeneous rooting depth</strong> of 0.3 m in the first case and of 2.0 m in the second one.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">simu</span><span class="o">.</span><span class="n">update_soil</span><span class="p">(</span><span class="n">FP</span><span class="o">=</span><span class="n">new_feddes_parameters</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># first we read the current soil file </span>
<span class="c1"># --------------------------------</span>
<span class="n">simu</span><span class="o">.</span><span class="n">update_veg_map</span><span class="p">()</span>
<span class="n">df_soil_het</span><span class="p">,</span> <span class="n">df_FP</span> <span class="o">=</span> <span class="n">simu</span><span class="o">.</span><span class="n">read_inputs</span><span class="p">(</span><span class="s1">&#39;soil&#39;</span><span class="p">)</span>

<span class="c1"># show Feddes parameters table</span>
<span class="c1"># --------------------------------</span>
<span class="n">df_FP</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PCANA</th>
      <th>PCREF</th>
      <th>PCWLT</th>
      <th>ZROOT</th>
      <th>PZ</th>
      <th>OMGC</th>
    </tr>
    <tr>
      <th>Veg. Indice</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>-4.0</td>
      <td>-150.0</td>
      <td>0.001</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>-4.0</td>
      <td>-150.0</td>
      <td>0.300</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>-4.0</td>
      <td>-150.0</td>
      <td>0.400</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>-4.0</td>
      <td>-150.0</td>
      <td>0.500</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>-4.0</td>
      <td>-150.0</td>
      <td>0.800</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.0</td>
      <td>-4.0</td>
      <td>-150.0</td>
      <td>0.900</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.0</td>
      <td>-4.0</td>
      <td>-150.0</td>
      <td>1.000</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.0</td>
      <td>-4.0</td>
      <td>-150.0</td>
      <td>2.000</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>From the table above we observe the values of the Feddes parameters for the different zones defined in the figure above. Here Zroot is varying according to the root map zone.</p>
</section>
<section id="check-soil-properties">
<h3>Check soil properties<a class="headerlink" href="#check-soil-properties" title="Permalink to this heading">#</a></h3>
<p>The project folder includes:</p>
<ul class="simple">
<li><p>A file with <strong>homogeneous</strong> properties</p></li>
<li><p>A file with <strong>heterogeneous</strong> properties for which the hydraulic conductivity of the layer number 6 is set to $0.001 m-s^{-1}$ (&gt;0.000073 for other layers)</p></li>
</ul>
<p>The soil is discretise in 3 distinct layers:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Depth (cm)</p></th>
<th class="head"><p>Porosity</p></th>
<th class="head"><p>Residual moisture content</p></th>
<th class="head"><p>Van Genuchten / (cm^-1)</p></th>
<th class="head"><p>Van Genuchten n</p></th>
<th class="head"><p>Specific storage coefficient (m^-1)</p></th>
<th class="head"><p>Saturated hydraulic conductivity (m/s)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0-80</p></td>
<td><p>0.43</p></td>
<td><p>0.078</p></td>
<td><p>0.036</p></td>
<td><p>1.56</p></td>
<td><p>1.00 x 10^-3</p></td>
<td><p>7.3 x 10^-5</p></td>
</tr>
<tr class="row-odd"><td><p>80-140 (Tile-drain)</p></td>
<td><p>0.43</p></td>
<td><p>0.078</p></td>
<td><p>0.036</p></td>
<td><p>1.56</p></td>
<td><p>1.00 x 10^-3</p></td>
<td><p>1.0 x 10^-3</p></td>
</tr>
<tr class="row-even"><td><p>140‚Äì500</p></td>
<td><p>0.43</p></td>
<td><p>0.078</p></td>
<td><p>0.036</p></td>
<td><p>1.56</p></td>
<td><p>1.00 x 10^-3</p></td>
<td><p>7.3 x 10^-5</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Van Genuchten parameters in CATHY</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">PERMX</span></code> (NSTR, NZONE): saturated hydraulic conductivity - xx</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PERMY</span></code> (NSTR, NZONE): saturated hydraulic conductivity - yy</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PERMZ</span></code> (NSTR, NZONE): saturated hydraulic conductivity - zz</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ELSTOR</span></code> (NSTR, NZONE): specific storage</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">POROS</span></code>  (NSTR, NZONE): porosity (moisture content at saturation) = \thetaS</p></li>
</ul>
<p>Retention curves parameters VGN, VGRMC, and VGPSAT</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">VGNCELL</span></code> (NSTR, NZONE): van Genuchten curve exponent  = n</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VGRMCCELL</span></code> (NSTR, NZONE): residual moisture content = \thetaR</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VGPSATCELL</span></code> (NSTR, NZONE): van Genuchten curve exponent ‚Äì&gt;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VGPSAT</span></code> == -1/alpha (with alpha expressed in [L-1]);</p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_soil</span><span class="p">,</span> <span class="n">df_FP</span> <span class="o">=</span> <span class="n">simu</span><span class="o">.</span><span class="n">read_inputs</span><span class="p">(</span><span class="s1">&#39;soil&#39;</span><span class="p">)</span>
<span class="n">df_soil</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>PERMX</th>
      <th>PERMY</th>
      <th>PERMZ</th>
      <th>ELSTOR</th>
      <th>POROS</th>
      <th>VGNCELL</th>
      <th>VGRMCCELL</th>
      <th>VGPSATCELL</th>
    </tr>
    <tr>
      <th>str</th>
      <th>zone</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <th>0</th>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.00001</td>
      <td>0.55</td>
      <td>1.46</td>
      <td>0.15</td>
      <td>0.03125</td>
    </tr>
    <tr>
      <th>1</th>
      <th>0</th>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.00001</td>
      <td>0.55</td>
      <td>1.46</td>
      <td>0.15</td>
      <td>0.03125</td>
    </tr>
    <tr>
      <th>2</th>
      <th>0</th>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.00001</td>
      <td>0.55</td>
      <td>1.46</td>
      <td>0.15</td>
      <td>0.03125</td>
    </tr>
    <tr>
      <th>3</th>
      <th>0</th>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.00001</td>
      <td>0.55</td>
      <td>1.46</td>
      <td>0.15</td>
      <td>0.03125</td>
    </tr>
    <tr>
      <th>4</th>
      <th>0</th>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.00001</td>
      <td>0.55</td>
      <td>1.46</td>
      <td>0.15</td>
      <td>0.03125</td>
    </tr>
    <tr>
      <th>5</th>
      <th>0</th>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.00001</td>
      <td>0.55</td>
      <td>1.46</td>
      <td>0.15</td>
      <td>0.03125</td>
    </tr>
    <tr>
      <th>6</th>
      <th>0</th>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.00001</td>
      <td>0.55</td>
      <td>1.46</td>
      <td>0.15</td>
      <td>0.03125</td>
    </tr>
    <tr>
      <th>7</th>
      <th>0</th>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.00001</td>
      <td>0.55</td>
      <td>1.46</td>
      <td>0.15</td>
      <td>0.03125</td>
    </tr>
    <tr>
      <th>8</th>
      <th>0</th>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.00001</td>
      <td>0.55</td>
      <td>1.46</td>
      <td>0.15</td>
      <td>0.03125</td>
    </tr>
    <tr>
      <th>9</th>
      <th>0</th>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.000188</td>
      <td>0.00001</td>
      <td>0.55</td>
      <td>1.46</td>
      <td>0.15</td>
      <td>0.03125</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">layers2plot</span><span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> 
                        <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                        <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span>
                       <span class="p">)</span>
<span class="n">axs</span><span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="p">):</span>
    <span class="n">simu</span><span class="o">.</span><span class="n">show_input</span><span class="p">(</span>
                    <span class="n">prop</span><span class="o">=</span><span class="s2">&quot;soil&quot;</span><span class="p">,</span> 
                    <span class="n">yprop</span><span class="o">=</span><span class="s2">&quot;PERMX&quot;</span><span class="p">,</span> 
                    <span class="n">layer_nb</span><span class="o">=</span><span class="n">layers2plot</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span>
                    <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                   <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;square&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;layer&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/a7e23a72e88d0144c16ed45b7a65d8d832ed96f2944f0de400c2119d3f1ee7a6.png" src="../../../_images/a7e23a72e88d0144c16ed45b7a65d8d832ed96f2944f0de400c2119d3f1ee7a6.png" />
</div>
</div>
<p>Read soil file with Tile-drain (and update existing soil file)</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>pyCATHY naming convention
The project folder comes with the default naming convention for the filenames. If you decide to rename the <code class="docutils literal notranslate"><span class="pre">soil</span></code> file, then you have to update the pyCATHY wrapper with the new values (this will overwrite the soil file).</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define the path to the soil file</span>
<span class="n">soilfile_het</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">simu</span><span class="o">.</span><span class="n">workdir</span><span class="p">,</span><span class="n">simu</span><span class="o">.</span><span class="n">project_name</span><span class="p">,</span><span class="s1">&#39;input&#39;</span><span class="p">,</span><span class="s1">&#39;soil_het&#39;</span><span class="p">)</span>

<span class="c1"># define the path to the dem_parameter file</span>
<span class="n">dem_parmfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">simu</span><span class="o">.</span><span class="n">workdir</span><span class="p">,</span><span class="n">simu</span><span class="o">.</span><span class="n">project_name</span><span class="p">,</span><span class="s1">&#39;input&#39;</span><span class="p">,</span><span class="s1">&#39;dem_parameters&#39;</span><span class="p">)</span>

<span class="c1"># define the path to the dem_parameter file</span>
<span class="n">dempar</span> <span class="o">=</span> <span class="n">in_CT</span><span class="o">.</span><span class="n">read_dem_parameters</span><span class="p">(</span><span class="n">dem_parmfile</span><span class="p">)</span>

<span class="c1"># read soil heterogeneous file</span>
<span class="n">df_soil_het</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">in_CT</span><span class="o">.</span><span class="n">read_soil</span><span class="p">(</span><span class="n">soilfile_het</span><span class="p">,</span><span class="n">dempar</span><span class="p">,</span><span class="n">MAXVEG</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">df_soil_het</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>PERMX</th>
      <th>PERMY</th>
      <th>PERMZ</th>
      <th>ELSTOR</th>
      <th>POROS</th>
      <th>VGNCELL</th>
      <th>VGRMCCELL</th>
      <th>VGPSATCELL</th>
    </tr>
    <tr>
      <th>str</th>
      <th>zone</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <th>0</th>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.001</td>
      <td>0.43</td>
      <td>1.56</td>
      <td>0.078</td>
      <td>0.27778</td>
    </tr>
    <tr>
      <th>1</th>
      <th>0</th>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.001</td>
      <td>0.43</td>
      <td>1.56</td>
      <td>0.078</td>
      <td>0.27778</td>
    </tr>
    <tr>
      <th>2</th>
      <th>0</th>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.001</td>
      <td>0.43</td>
      <td>1.56</td>
      <td>0.078</td>
      <td>0.27778</td>
    </tr>
    <tr>
      <th>3</th>
      <th>0</th>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.001</td>
      <td>0.43</td>
      <td>1.56</td>
      <td>0.078</td>
      <td>0.27778</td>
    </tr>
    <tr>
      <th>4</th>
      <th>0</th>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.001</td>
      <td>0.43</td>
      <td>1.56</td>
      <td>0.078</td>
      <td>0.27778</td>
    </tr>
    <tr>
      <th>5</th>
      <th>0</th>
      <td>0.001000</td>
      <td>0.001000</td>
      <td>0.001000</td>
      <td>0.001</td>
      <td>0.43</td>
      <td>1.56</td>
      <td>0.078</td>
      <td>0.27778</td>
    </tr>
    <tr>
      <th>6</th>
      <th>0</th>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.001</td>
      <td>0.43</td>
      <td>1.56</td>
      <td>0.078</td>
      <td>0.27778</td>
    </tr>
    <tr>
      <th>7</th>
      <th>0</th>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.001</td>
      <td>0.43</td>
      <td>1.56</td>
      <td>0.078</td>
      <td>0.27778</td>
    </tr>
    <tr>
      <th>8</th>
      <th>0</th>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.001</td>
      <td>0.43</td>
      <td>1.56</td>
      <td>0.078</td>
      <td>0.27778</td>
    </tr>
    <tr>
      <th>9</th>
      <th>0</th>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.000073</td>
      <td>0.001</td>
      <td>0.43</td>
      <td>1.56</td>
      <td>0.078</td>
      <td>0.27778</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simu</span><span class="o">.</span><span class="n">update_soil</span><span class="p">(</span><span class="n">SPP</span><span class="o">=</span><span class="n">df_soil_het</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">üîÑ <span style="font-weight: bold">Update soil</span>
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">homogeneous soil
</pre>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">layers2plot</span><span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> 
                        <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                        <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span>
                       <span class="p">)</span>
<span class="n">axs</span><span class="o">=</span> <span class="n">axs</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="p">):</span>
    <span class="n">simu</span><span class="o">.</span><span class="n">show_input</span><span class="p">(</span>
                    <span class="n">prop</span><span class="o">=</span><span class="s2">&quot;soil&quot;</span><span class="p">,</span> 
                    <span class="n">yprop</span><span class="o">=</span><span class="s2">&quot;PERMX&quot;</span><span class="p">,</span> 
                    <span class="n">layer_nb</span><span class="o">=</span><span class="n">layers2plot</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="p">,</span>
                    <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                   <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;square&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;layer&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/93bb9a08849cdd68d61ef22757001fa7bd93ed9176d7333981704c6aa2d99c02.png" src="../../../_images/93bb9a08849cdd68d61ef22757001fa7bd93ed9176d7333981704c6aa2d99c02.png" />
</div>
</div>
</section>
</section>
<section id="run-simulation">
<h2>2. Run simulation<a class="headerlink" href="#run-simulation" title="Permalink to this heading">#</a></h2>
<p>Once all the inputs files are updated according to the scenario, it is good practice to run first the preprocessor in verbose = True mode to check if the preprocessing step worked.</p>
<p>Then we can run the processor. As the number of times and points are large in this example it is recommanded to execute it locally.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">simu</span><span class="o">.</span><span class="n">run_preprocessor</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">simu</span><span class="o">.</span><span class="n">run_processor</span><span class="p">(</span>
                   <span class="n">IPRT1</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                   <span class="n">ROWMAX</span><span class="o">=</span><span class="mi">247</span><span class="p">,</span> 
                   <span class="n">COLMAX</span><span class="o">=</span><span class="mi">221</span>
                   <span class="p">)</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Check before running the simulations
Before running the simulation it is recommanded to check the parm file</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#simu.read_inputs(&#39;parm&#39;)</span>
<span class="n">parm_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">simu</span><span class="o">.</span><span class="n">workdir</span><span class="p">,</span><span class="n">simu</span><span class="o">.</span><span class="n">project_name</span><span class="p">,</span><span class="s1">&#39;input&#39;</span><span class="p">,</span><span class="s1">&#39;parm&#39;</span><span class="p">)</span>
<span class="n">parm</span> <span class="o">=</span> <span class="n">in_CT</span><span class="o">.</span><span class="n">read_parm</span><span class="p">(</span><span class="n">parm_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Among all the parameters (check using parm.keys()) controlling the behavior of the simulation here is a selection of some important ones:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">IPRT1</span></code> Flag for output of input and coordinate data;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TRAFLAG</span></code> lag for the choice of the data assimilation scheme;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DTMIN</span></code> Minimum FLOW3D time step size allowed;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NPRT</span></code> Number of time values for detailed nodal output and element velocity output;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(TIMPRT(I),I=1,NPRT)</span></code> Time values for detailed output.</p></li>
</ul>
</section>
<section id="plot-outputs">
<h2>3. Plot outputs<a class="headerlink" href="#plot-outputs" title="Permalink to this heading">#</a></h2>
<section id="plot-streamflow">
<h3>Plot streamflow<a class="headerlink" href="#plot-streamflow" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%% Another interesting graph looking at the **streamflow = f(time)**</span>
<span class="n">simu</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="s2">&quot;hgraph&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/75ca56426ad50e8d083f80f1faf3d1df1edeadecbc6dd4864a5290d586411ff4.png" src="../../../_images/75ca56426ad50e8d083f80f1faf3d1df1edeadecbc6dd4864a5290d586411ff4.png" />
</div>
</div>
</section>
<section id="plot-spatial-actual-et">
<h3>Plot spatial actual ET<a class="headerlink" href="#plot-spatial-actual-et" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">simu</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s1">&#39;spatialET&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">ti</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">no file specified
</pre>
</div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.contour.QuadContourSet at 0x7ff41ed22a10&gt;
</pre></div>
</div>
<img alt="../../../_images/ab193b1424fdf038ab11173803d352f5148ca964430c248217b1ca798967a366.png" src="../../../_images/ab193b1424fdf038ab11173803d352f5148ca964430c248217b1ca798967a366.png" />
</div>
</div>
</section>
<section id="plot-the-ground-water-depth-gwd">
<h3>Plot the Ground Water Depth (GWD)<a class="headerlink" href="#plot-the-ground-water-depth-gwd" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">])</span>

<span class="n">cmap</span> <span class="o">=</span> <span class="n">simu</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s1">&#39;WTD&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ti</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">simu</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s1">&#39;WTD&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ti</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cmap</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">no file specified
</pre>
</div><div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">no file specified
</pre>
</div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.colorbar.Colorbar at 0x7ff41eeb4c70&gt;
</pre></div>
</div>
<img alt="../../../_images/3b9fff499dcb5edece0e6e8c295d67033b46299efa429889aa51adcdd1ac0338.png" src="../../../_images/3b9fff499dcb5edece0e6e8c295d67033b46299efa429889aa51adcdd1ac0338.png" />
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Compute differences
In order to compute the differences between two times pass a list of time to ti</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simu</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="s1">&#39;WTD&#39;</span><span class="p">,</span><span class="n">ti</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">no file specified
</pre>
</div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.contour.QuadContourSet at 0x7ff41f2cd0c0&gt;
</pre></div>
</div>
<img alt="../../../_images/7fdb05349dfe277bbf4b8b1e7cc9c6a39ee5c67303c92d320575deb9000086f4.png" src="../../../_images/7fdb05349dfe277bbf4b8b1e7cc9c6a39ee5c67303c92d320575deb9000086f4.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "pycathy_doc"
        },
        kernelOptions: {
            name: "pycathy_doc",
            path: "./jupyter_execute/content/FromLiterature"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'pycathy_doc'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-the-required-packages">Importing the required packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-cathy-simulation-object">Create a CATHY simulation object</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing-step">1. Preprocessing step</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#build-the-mesh">Build the mesh</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-root-map-properties">Define root map properties</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-the-atmospheric-boundary-conditions">Setting the atmospheric boundary conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scenario-with-varying-feddes-parameters">Scenario with varying Feddes parameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#check-soil-properties">Check soil properties</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-simulation">2. Run simulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-outputs">3. Plot outputs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-streamflow">Plot streamflow</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-spatial-actual-et">Plot spatial actual ET</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-ground-water-depth-gwd">Plot the Ground Water Depth (GWD)</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By B. Mary
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      ¬© Copyright 2022, B. Mary.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on Jun 23, 2023.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>