
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "content/SSHydro/plot_3_meshing_from_weill.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_content_SSHydro_plot_3_meshing_from_weill.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_content_SSHydro_plot_3_meshing_from_weill.py:


Meshing from a Digital Elevation Model (DEM)
============================================

Weill, S., et al. Â« Coupling Water Flow and Solute Transport into a Physically-Based Surfaceâ€“Subsurface Hydrological Model Â». 
Advances in Water Resources, vol. 34, no 1, janvier 2011, p. 128â€‘36. DOI.org (Crossref), 
https://doi.org/10.1016/j.advwatres.2010.10.001.

This example shows how to use pyCATHY object to mesh from a DEM and run the hydrological model.

*Estimated time to run the notebook = 5min*

.. GENERATED FROM PYTHON SOURCE LINES 16-33

.. code-block:: Python



    # !! run preprocessor change the DEM shape !
    # dtm_13 does not have the same shape anymore!

    import os

    import matplotlib.pyplot as plt
    import numpy as np
    import pandas as pd

    import pyCATHY.meshtools as mt
    from pyCATHY import cathy_tools
    from pyCATHY.importers import cathy_inputs as in_CT
    from pyCATHY.importers import cathy_outputs as out_CT
    from pyCATHY.plotters import cathy_plots as cplt





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /home/z0272571a@CAMPUS.CSIC.ES/Nextcloud/BenCSIC/Codes/BenjMy/pycathy_wrapper/examples/SSHydro/plot_3_meshing_from_weill.py:25: DeprecationWarning: 
    Pyarrow will become a required dependency of pandas in the next major release of pandas (pandas 3.0),
    (to allow more performant data types, such as the Arrow string type, and better interoperability with other libraries)
    but was not found to be installed on your system.
    If this would cause problems for you,
    please provide us feedback at https://github.com/pandas-dev/pandas/issues/54466
        
      import pandas as pd




.. GENERATED FROM PYTHON SOURCE LINES 34-35

------------------------

.. GENERATED FROM PYTHON SOURCE LINES 35-42

.. code-block:: Python

    path2prj = "../SSHydro/"  # add your local path here
    simu = cathy_tools.CATHY(dirName=path2prj, 
                             prj_name="meshing_from_weill"
                             )

    rootpath = os.path.join(simu.workdir + simu.project_name)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ğŸ Initiate CATHY object




.. GENERATED FROM PYTHON SOURCE LINES 47-48

the dimension of the mesh is squared (20,20)

.. GENERATED FROM PYTHON SOURCE LINES 48-73

.. code-block:: Python



    dem_mat, str_hd_dem = in_CT.read_dem(
        os.path.join(simu.workdir, simu.project_name, "prepro/dem"),
        os.path.join(simu.workdir, simu.project_name, "prepro/dtm_13.val"),
    )

    fig, ax = plt.subplots(1)
    img = ax.imshow(dem_mat)
    plt.colorbar(img)


    simu.show_input(prop="dem")


    simu.update_prepo_inputs(
        DEM=dem_mat,
        # N=np.shape(dem_mat)[1],
        # M=np.shape(dem_mat)[0],
    )

    fig = plt.figure()
    ax = plt.axes(projection="3d")
    simu.show_input(prop="dem", ax=ax)
    simu.create_mesh_vtk(verbose=True)



.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_001.png
         :alt: plot 3 meshing from weill
         :srcset: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_001.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_002.png
         :alt: plot 3 meshing from weill
         :srcset: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_002.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_003.png
         :alt: plot 3 meshing from weill
         :srcset: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_003.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ğŸ”„ Update hap.in file
    ğŸ”„ update dem_parameters file 
    ğŸ”„ update dem_parameters file 
    ğŸ”„ Update hap.in file
    ğŸ”„ update dem_parameters file 
    ğŸ”„ Update dtm_13 file
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ âš  warning messages above âš  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

                                The parm dictionnary is empty
                                Falling back to defaults to update CATHYH
                                This can have consequences !!
                            
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    ğŸ”„ update parm file 
    ğŸ”„ update dem_parameters file 
    ğŸ³ gfortran compilation
    ğŸ‘Ÿ Run preprocessor

     wbb...

     searching the dtm_13.val input file...
     assigned nodata value =  -9999.0000000000000     

     number of processed cells =         200

     ...wbb completed

     rn...
     csort I...
     ...completed

     depit...
     dem modifications =            0
     dem modifications =            0 (total)
     ...completed

     csort II...
     ...completed

     cca...

     contour curvature threshold value =    9.99999996E+11
     ...completed

     smean...
     mean (min,max) facet slope =  0.050445386 ( 0.020000000, 0.053851648)
     ...completed

     dsf...
     the drainage direction of the outlet cell (           8 ) is used
     ...completed

     hg...
     ...completed

     saving the data in the basin_b/basin_i files...

     ...rn completed

     mrbb...


     Select the header type:
     0) None
     1) ESRI ascii file
     2) GRASS ascii file
     (Ctrl C to exit)

     -> 
     Select the nodata value:
     (Ctrl C to exit)

     -> 
     Select the pointer system:
     1) HAP system
     2) Arc/Gis system
     (Ctrl C to exit)

     ->  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dem file

     min value = 0.585000E+00
     max value = 0.100000E+01
     number of cells =   200
     mean value = 0.792500E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     lakes_map file

     min value =     0
     max value =     0
     number of cells =   200
     mean value =     0.000000

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     zone file

     min value =     1
     max value =     1
     number of cells =   200
     mean value =     1.000000

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_w_1 file

     min value = 0.515524E+00
     max value = 0.100000E+01
     number of cells =   200
     mean value = 0.651177E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_w_2 file

     min value = 0.000000E+00
     max value = 0.484476E+00
     number of cells =   200
     mean value = 0.348823E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_p_outflow_1 file

     min value =     4
     max value =     8
     number of cells =   200
     mean value =     4.400000

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_p_outflow_2 file

     min value =     0
     max value =     9
     number of cells =   200
     mean value =     6.885000

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     A_inflow file

     min value = 0.000000000000E+00
     max value = 0.497499945034E+02
     number of cells =   200
     mean value = 0.305322909355E+01

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_local_slope_1 file

     min value = 0.200000E-01
     max value = 0.500000E-01
     number of cells =   200
     mean value = 0.470000E-01

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_local_slope_2 file

     min value = 0.000000E+00
     max value = 0.494975E-01
     number of cells =   200
     mean value = 0.356382E-01

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_epl_1 file

     min value = 0.500000E+00
     max value = 0.500000E+00
     number of cells =   200
     mean value = 0.500000E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_epl_2 file

     min value = 0.000000E+00
     max value = 0.707107E+00
     number of cells =   200
     mean value = 0.509117E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_kSs1_sf_1 file

     min value = 0.240040E+02
     max value = 0.240040E+02
     number of cells =   200
     mean value = 0.240040E+02

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_kSs1_sf_2 file

     min value = 0.000000E+00
     max value = 0.240040E+02
     number of cells =   200
     mean value = 0.172829E+02

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_Ws1_sf file

     min value = 0.100000E+01
     max value = 0.100000E+01
     number of cells =   200
     mean value = 0.100000E+01

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_Ws1_sf_2 file

     min value = 0.000000E+00
     max value = 0.100000E+01
     number of cells =   200
     mean value = 0.720000E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_b1_sf file

     min value = 0.000000E+00
     max value = 0.000000E+00
     number of cells =   200
     mean value = 0.000000E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_y1_sf file

     min value = 0.000000E+00
     max value = 0.000000E+00
     number of cells =   200
     mean value = 0.000000E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_hcID file

     min value =     0
     max value =     0
     number of cells =   200
     mean value =     0.000000

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_q_output file

     min value =     0
     max value =     0
     number of cells =   200
     mean value =     0.000000

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_nrc file

     min value = 0.100000E+01
     max value = 0.100000E+01
     number of cells =   200
     mean value = 0.100000E+01

     writing the output file...

     ...mrbb completed

     bb2shp...

     writing file river_net.shp

    Note: The following floating-point exceptions are signalling: IEEE_UNDERFLOW_FLAG IEEE_DENORMAL

    ğŸ”„ update parm file 
    ğŸ›   Recompile src files [3s]
    ğŸ³ gfortran compilation [6s]
    b''
    ğŸ‘Ÿ Run processor
    b''
    b''




.. GENERATED FROM PYTHON SOURCE LINES 74-85

.. code-block:: Python

    meshfile = rootpath + "/vtk/" + simu.project_name + ".vtk"
    import pyvista as pv

    mesh2plot = pv.read(meshfile)
    mesh2plot.plot(show_edges=True,
                   show_axes=True, 
                   show_bounds=True,
                   notebook=True,
                   )





.. image-sg:: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_004.png
   :alt: plot 3 meshing from weill
   :srcset: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_004.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /home/z0272571a@CAMPUS.CSIC.ES/miniconda3/envs/pyCATHY_doc/lib/python3.10/site-packages/pyvista/jupyter/notebook.py:34: UserWarning: Failed to use notebook backend: 

    No module named 'trame'

    Falling back to a static output.
      warnings.warn(
    <PIL.Image.Image image mode=RGB size=1024x768 at 0x7F77C135F520>




.. GENERATED FROM PYTHON SOURCE LINES 86-91

.. code-block:: Python


    simu.update_prepo_inputs(
                               DEM=dem_mat,
    )





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ğŸ”„ Update hap.in file
    ğŸ”„ update dem_parameters file 
    ğŸ”„ Update dtm_13 file
    ğŸ”„ update dem_parameters file 




.. GENERATED FROM PYTHON SOURCE LINES 92-96

.. code-block:: Python

    simu.update_dem_parameters(
                                delta_x=10,
                                )





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ğŸ”„ update dem_parameters file 




.. GENERATED FROM PYTHON SOURCE LINES 97-105

.. code-block:: Python

    simu.update_zone()
    simu.update_veg_map()

    fig = plt.figure()
    ax = plt.axes(projection="3d")
    simu.show_input(prop="dem", ax=ax)
    simu.create_mesh_vtk(verbose=True)




.. image-sg:: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_005.png
   :alt: plot 3 meshing from weill
   :srcset: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_005.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ğŸ”„ update zone file 
    ğŸ”„ update dem_parameters file 
    ğŸ”„ update parm file 
    ğŸ³ gfortran compilation
    ğŸ‘Ÿ Run preprocessor

     wbb...

     searching the dtm_13.val input file...
     assigned nodata value =  -9999.0000000000000     

     number of processed cells =         200

     ...wbb completed

     rn...
     csort I...
     ...completed

     depit...
     dem modifications =            0
     dem modifications =            0 (total)
     ...completed

     csort II...
     ...completed

     cca...

     contour curvature threshold value =    9.99999996E+11
     ...completed

     smean...
     mean (min,max) facet slope =  0.050445386 ( 0.020000000, 0.053851648)
     ...completed

     dsf...
     the drainage direction of the outlet cell (           8 ) is used
     ...completed

     hg...
     ...completed

     saving the data in the basin_b/basin_i files...

     ...rn completed

     mrbb...


     Select the header type:
     0) None
     1) ESRI ascii file
     2) GRASS ascii file
     (Ctrl C to exit)

     -> 
     Select the nodata value:
     (Ctrl C to exit)

     -> 
     Select the pointer system:
     1) HAP system
     2) Arc/Gis system
     (Ctrl C to exit)

     ->  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dem file

     min value = 0.585000E+00
     max value = 0.100000E+01
     number of cells =   200
     mean value = 0.792500E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     lakes_map file

     min value =     0
     max value =     0
     number of cells =   200
     mean value =     0.000000

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     zone file

     min value =     1
     max value =     1
     number of cells =   200
     mean value =     1.000000

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_w_1 file

     min value = 0.515524E+00
     max value = 0.100000E+01
     number of cells =   200
     mean value = 0.651177E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_w_2 file

     min value = 0.000000E+00
     max value = 0.484476E+00
     number of cells =   200
     mean value = 0.348823E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_p_outflow_1 file

     min value =     4
     max value =     8
     number of cells =   200
     mean value =     4.400000

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_p_outflow_2 file

     min value =     0
     max value =     9
     number of cells =   200
     mean value =     6.885000

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     A_inflow file

     min value = 0.000000000000E+00
     max value = 0.497499945034E+02
     number of cells =   200
     mean value = 0.305322909355E+01

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_local_slope_1 file

     min value = 0.200000E-01
     max value = 0.500000E-01
     number of cells =   200
     mean value = 0.470000E-01

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_local_slope_2 file

     min value = 0.000000E+00
     max value = 0.494975E-01
     number of cells =   200
     mean value = 0.356382E-01

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_epl_1 file

     min value = 0.500000E+00
     max value = 0.500000E+00
     number of cells =   200
     mean value = 0.500000E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_epl_2 file

     min value = 0.000000E+00
     max value = 0.707107E+00
     number of cells =   200
     mean value = 0.509117E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_kSs1_sf_1 file

     min value = 0.240040E+02
     max value = 0.240040E+02
     number of cells =   200
     mean value = 0.240040E+02

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_kSs1_sf_2 file

     min value = 0.000000E+00
     max value = 0.240040E+02
     number of cells =   200
     mean value = 0.172829E+02

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_Ws1_sf file

     min value = 0.100000E+01
     max value = 0.100000E+01
     number of cells =   200
     mean value = 0.100000E+01

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_Ws1_sf_2 file

     min value = 0.000000E+00
     max value = 0.100000E+01
     number of cells =   200
     mean value = 0.720000E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_b1_sf file

     min value = 0.000000E+00
     max value = 0.000000E+00
     number of cells =   200
     mean value = 0.000000E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_y1_sf file

     min value = 0.000000E+00
     max value = 0.000000E+00
     number of cells =   200
     mean value = 0.000000E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_hcID file

     min value =     0
     max value =     0
     number of cells =   200
     mean value =     0.000000

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_q_output file

     min value =     0
     max value =     0
     number of cells =   200
     mean value =     0.000000

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_nrc file

     min value = 0.100000E+01
     max value = 0.100000E+01
     number of cells =   200
     mean value = 0.100000E+01

     writing the output file...

     ...mrbb completed

     bb2shp...

     writing file river_net.shp

    Note: The following floating-point exceptions are signalling: IEEE_UNDERFLOW_FLAG IEEE_DENORMAL

    ğŸ”„ update parm file 
    ğŸ›   Recompile src files [10s]
    ğŸ³ gfortran compilation [13s]
    b''
    ğŸ‘Ÿ Run processor
    b''
    b''




.. GENERATED FROM PYTHON SOURCE LINES 106-118

.. code-block:: Python

    meshfile = rootpath + "/vtk/" + simu.project_name + ".vtk"
    import pyvista as pv

    mesh2plot = pv.read(meshfile)
    mesh2plot.plot(show_edges=True,
                   show_axes=True, 
                   show_bounds=True,
                   notebook=True,
                   )






.. image-sg:: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_006.png
   :alt: plot 3 meshing from weill
   :srcset: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_006.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /home/z0272571a@CAMPUS.CSIC.ES/miniconda3/envs/pyCATHY_doc/lib/python3.10/site-packages/pyvista/jupyter/notebook.py:34: UserWarning: Failed to use notebook backend: 

    No module named 'trame'

    Falling back to a static output.
      warnings.warn(
    <PIL.Image.Image image mode=RGB size=1024x768 at 0x7F77BF036110>




.. GENERATED FROM PYTHON SOURCE LINES 119-120

the new dimension of the mesh is rectangle (10,20)

.. GENERATED FROM PYTHON SOURCE LINES 120-135

.. code-block:: Python


    dem_crop = dem_mat[0:10, :]
    print("DEM shape is {}".format(np.shape(dem_crop)))

    simu.update_prepo_inputs(
        DEM=dem_crop,
    )

    simu.update_zone()
    simu.update_veg_map()

    fig = plt.figure()
    ax = plt.axes(projection="3d")
    simu.show_input(prop="dem", ax=ax)
    simu.create_mesh_vtk(verbose=True)



.. image-sg:: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_007.png
   :alt: plot 3 meshing from weill
   :srcset: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_007.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    DEM shape is (10, 20)
    ğŸ”„ Update hap.in file
    ğŸ”„ update dem_parameters file 
    ğŸ”„ Update dtm_13 file
    ğŸ”„ update dem_parameters file 
    ğŸ”„ update zone file 
    ğŸ”„ update dem_parameters file 
    ğŸ”„ update parm file 
    ğŸ³ gfortran compilation
    ğŸ‘Ÿ Run preprocessor

     wbb...

     searching the dtm_13.val input file...
     assigned nodata value =  -9999.0000000000000     

     number of processed cells =         200

     ...wbb completed

     rn...
     csort I...
     ...completed

     depit...
     dem modifications =            0
     dem modifications =            0 (total)
     ...completed

     csort II...
     ...completed

     cca...

     contour curvature threshold value =    9.99999996E+11
     ...completed

     smean...
     mean (min,max) facet slope =  0.050445386 ( 0.020000000, 0.053851648)
     ...completed

     dsf...
     the drainage direction of the outlet cell (           8 ) is used
     ...completed

     hg...
     ...completed

     saving the data in the basin_b/basin_i files...

     ...rn completed

     mrbb...


     Select the header type:
     0) None
     1) ESRI ascii file
     2) GRASS ascii file
     (Ctrl C to exit)

     -> 
     Select the nodata value:
     (Ctrl C to exit)

     -> 
     Select the pointer system:
     1) HAP system
     2) Arc/Gis system
     (Ctrl C to exit)

     ->  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dem file

     min value = 0.585000E+00
     max value = 0.100000E+01
     number of cells =   200
     mean value = 0.792500E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     lakes_map file

     min value =     0
     max value =     0
     number of cells =   200
     mean value =     0.000000

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     zone file

     min value =     1
     max value =     1
     number of cells =   200
     mean value =     1.000000

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_w_1 file

     min value = 0.515524E+00
     max value = 0.100000E+01
     number of cells =   200
     mean value = 0.651177E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_w_2 file

     min value = 0.000000E+00
     max value = 0.484476E+00
     number of cells =   200
     mean value = 0.348823E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_p_outflow_1 file

     min value =     4
     max value =     8
     number of cells =   200
     mean value =     4.400000

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_p_outflow_2 file

     min value =     0
     max value =     9
     number of cells =   200
     mean value =     6.885000

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     A_inflow file

     min value = 0.000000000000E+00
     max value = 0.497499945034E+02
     number of cells =   200
     mean value = 0.305322909355E+01

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_local_slope_1 file

     min value = 0.200000E-01
     max value = 0.500000E-01
     number of cells =   200
     mean value = 0.470000E-01

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_local_slope_2 file

     min value = 0.000000E+00
     max value = 0.494975E-01
     number of cells =   200
     mean value = 0.356382E-01

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_epl_1 file

     min value = 0.500000E+00
     max value = 0.500000E+00
     number of cells =   200
     mean value = 0.500000E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_epl_2 file

     min value = 0.000000E+00
     max value = 0.707107E+00
     number of cells =   200
     mean value = 0.509117E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_kSs1_sf_1 file

     min value = 0.240040E+02
     max value = 0.240040E+02
     number of cells =   200
     mean value = 0.240040E+02

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_kSs1_sf_2 file

     min value = 0.000000E+00
     max value = 0.240040E+02
     number of cells =   200
     mean value = 0.172829E+02

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_Ws1_sf file

     min value = 0.100000E+01
     max value = 0.100000E+01
     number of cells =   200
     mean value = 0.100000E+01

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_Ws1_sf_2 file

     min value = 0.000000E+00
     max value = 0.100000E+01
     number of cells =   200
     mean value = 0.720000E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_b1_sf file

     min value = 0.000000E+00
     max value = 0.000000E+00
     number of cells =   200
     mean value = 0.000000E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_y1_sf file

     min value = 0.000000E+00
     max value = 0.000000E+00
     number of cells =   200
     mean value = 0.000000E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_hcID file

     min value =     0
     max value =     0
     number of cells =   200
     mean value =     0.000000

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_q_output file

     min value =     0
     max value =     0
     number of cells =   200
     mean value =     0.000000

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_nrc file

     min value = 0.100000E+01
     max value = 0.100000E+01
     number of cells =   200
     mean value = 0.100000E+01

     writing the output file...

     ...mrbb completed

     bb2shp...

     writing file river_net.shp

    Note: The following floating-point exceptions are signalling: IEEE_UNDERFLOW_FLAG IEEE_DENORMAL

    ğŸ”„ update parm file 
    ğŸ›   Recompile src files [17s]
    ğŸ³ gfortran compilation [20s]
    b''
    ğŸ‘Ÿ Run processor
    b''
    b''




.. GENERATED FROM PYTHON SOURCE LINES 136-149

.. code-block:: Python

    meshfile = rootpath + "/vtk/" + simu.project_name + ".vtk"
    import pyvista as pv

    mesh2plot = pv.read(meshfile)
    mesh2plot.plot(show_edges=True,
                   show_axes=True, 
                   show_bounds=True,
                   notebook=True,
                   )







.. image-sg:: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_008.png
   :alt: plot 3 meshing from weill
   :srcset: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_008.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /home/z0272571a@CAMPUS.CSIC.ES/miniconda3/envs/pyCATHY_doc/lib/python3.10/site-packages/pyvista/jupyter/notebook.py:34: UserWarning: Failed to use notebook backend: 

    No module named 'trame'

    Falling back to a static output.
      warnings.warn(
    <PIL.Image.Image image mode=RGB size=1024x768 at 0x7F77BF004BB0>




.. GENERATED FROM PYTHON SOURCE LINES 150-162

.. code-block:: Python

    meshfile = rootpath + "/vtk/" + simu.project_name + ".vtk"
    import pyvista as pv

    mesh2plot = pv.read(meshfile)
    mesh2plot.plot(show_edges=True,
                   show_axes=True, 
                   show_bounds=True,
                   notebook=True,
                   )






.. image-sg:: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_009.png
   :alt: plot 3 meshing from weill
   :srcset: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_009.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /home/z0272571a@CAMPUS.CSIC.ES/miniconda3/envs/pyCATHY_doc/lib/python3.10/site-packages/pyvista/jupyter/notebook.py:34: UserWarning: Failed to use notebook backend: 

    No module named 'trame'

    Falling back to a static output.
      warnings.warn(
    <PIL.Image.Image image mode=RGB size=1024x768 at 0x7F77B6758670>




.. GENERATED FROM PYTHON SOURCE LINES 163-177

.. code-block:: Python


    simu.update_prepo_inputs(
        DEM=dem_crop,
        xllcorner=1e4,
        yllcorner=4e3,
    )

    simu.update_zone()
    simu.update_veg_map()

    fig = plt.figure()
    ax = plt.axes(projection="3d")
    simu.show_input(prop="dem", ax=ax)
    simu.create_mesh_vtk(verbose=False)



.. image-sg:: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_010.png
   :alt: plot 3 meshing from weill
   :srcset: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_010.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ğŸ”„ Update hap.in file
    ğŸ”„ update dem_parameters file 
    ğŸ”„ Update dtm_13 file
    ğŸ”„ update dem_parameters file 
    ğŸ”„ update zone file 
    ğŸ”„ update dem_parameters file 
    ğŸ”„ update parm file 
    ğŸ³ gfortran compilation
    ğŸ‘Ÿ Run preprocessor
    ğŸ”„ update parm file 
    ğŸ›   Recompile src files [24s]
    ğŸ³ gfortran compilation [27s]
    b''
    ğŸ‘Ÿ Run processor




.. GENERATED FROM PYTHON SOURCE LINES 178-187

.. code-block:: Python

    meshfile = rootpath + "/vtk/" + simu.project_name + ".vtk"
    import pyvista as pv

    mesh2plot = pv.read(meshfile)
    mesh2plot.plot(show_edges=True,
                   show_axes=True, 
                   show_bounds=True,
                   notebook=True,
                   )



.. image-sg:: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_011.png
   :alt: plot 3 meshing from weill
   :srcset: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_011.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /home/z0272571a@CAMPUS.CSIC.ES/miniconda3/envs/pyCATHY_doc/lib/python3.10/site-packages/pyvista/jupyter/notebook.py:34: UserWarning: Failed to use notebook backend: 

    No module named 'trame'

    Falling back to a static output.
      warnings.warn(
    <PIL.Image.Image image mode=RGB size=1024x768 at 0x7F77C135EB00>




.. GENERATED FROM PYTHON SOURCE LINES 188-203

.. code-block:: Python


    dem_crop_flipy = np.flipud(dem_crop)

    simu.update_prepo_inputs(
        DEM=dem_crop_flipy,
        xllcorner=1e4,
        yllcorner=4e3,
    )

    simu.update_zone()
    simu.update_veg_map()
    fig = plt.figure()
    ax = plt.axes(projection="3d")
    simu.show_input(prop="dem", ax=ax)
    simu.create_mesh_vtk(verbose=False)



.. image-sg:: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_012.png
   :alt: plot 3 meshing from weill
   :srcset: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_012.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ğŸ”„ Update hap.in file
    ğŸ”„ update dem_parameters file 
    ğŸ”„ Update dtm_13 file
    ğŸ”„ update dem_parameters file 
    ğŸ”„ update zone file 
    ğŸ”„ update dem_parameters file 
    ğŸ”„ update parm file 
    ğŸ³ gfortran compilation
    ğŸ‘Ÿ Run preprocessor
    ğŸ”„ update parm file 
    ğŸ›   Recompile src files [31s]
    ğŸ³ gfortran compilation [34s]
    b''
    ğŸ‘Ÿ Run processor




.. GENERATED FROM PYTHON SOURCE LINES 204-214

.. code-block:: Python

    meshfile = rootpath + "/vtk/" + simu.project_name + ".vtk"
    import pyvista as pv

    mesh2plot = pv.read(meshfile)
    mesh2plot.plot(show_edges=True,
                   show_axes=True, 
                   show_bounds=True,
                   notebook=True,
                   )




.. image-sg:: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_013.png
   :alt: plot 3 meshing from weill
   :srcset: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_013.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /home/z0272571a@CAMPUS.CSIC.ES/miniconda3/envs/pyCATHY_doc/lib/python3.10/site-packages/pyvista/jupyter/notebook.py:34: UserWarning: Failed to use notebook backend: 

    No module named 'trame'

    Falling back to a static output.
      warnings.warn(
    <PIL.Image.Image image mode=RGB size=1024x768 at 0x7F77B5BAB040>




.. GENERATED FROM PYTHON SOURCE LINES 215-238

.. code-block:: Python


    dem_crop_3layers = np.flipud(dem_crop)
    maxdepth = 10

    # linear z depth
    # -------------------------------------------------------------
    zb = np.linspace(0, maxdepth, 3)
    nstr = len(zb) - 1
    zr = list((np.ones(len(zb))) / (nstr))


    simu.update_prepo_inputs(
        DEM=dem_crop,
        xllcorner=1e4,
        yllcorner=4e3,
        nstr=nstr,
        zratio=zr,
        base=max(zb),
    )
    fig = plt.figure()
    ax = plt.axes(projection="3d")
    simu.show_input(prop="dem", ax=ax)
    simu.create_mesh_vtk(verbose=False)



.. image-sg:: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_014.png
   :alt: plot 3 meshing from weill
   :srcset: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_014.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ğŸ”„ Update hap.in file
    ğŸ”„ update dem_parameters file 
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ âš  warning messages above âš  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    The sum of all the layers is not equal to 1 but to 1.5
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    ğŸ”„ Update dtm_13 file
    ğŸ”„ update dem_parameters file 
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ âš  warning messages above âš  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    The sum of all the layers is not equal to 1 but to 1.5
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    ğŸ³ gfortran compilation
    ğŸ‘Ÿ Run preprocessor
    ğŸ”„ update parm file 
    ğŸ›   Recompile src files [38s]
    ğŸ³ gfortran compilation [41s]
    b''
    ğŸ‘Ÿ Run processor




.. GENERATED FROM PYTHON SOURCE LINES 239-249

.. code-block:: Python

    meshfile = rootpath + "/vtk/" + simu.project_name + ".vtk"
    import pyvista as pv

    mesh2plot = pv.read(meshfile)
    mesh2plot.plot(show_edges=True,
                   show_axes=True, 
                   show_bounds=True,
                   notebook=True,
                   )




.. image-sg:: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_015.png
   :alt: plot 3 meshing from weill
   :srcset: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_015.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /home/z0272571a@CAMPUS.CSIC.ES/miniconda3/envs/pyCATHY_doc/lib/python3.10/site-packages/pyvista/jupyter/notebook.py:34: UserWarning: Failed to use notebook backend: 

    No module named 'trame'

    Falling back to a static output.
      warnings.warn(
    <PIL.Image.Image image mode=RGB size=1024x768 at 0x7F77B5CDCE50>




.. GENERATED FROM PYTHON SOURCE LINES 250-271

.. code-block:: Python


    # the fraction of total grid height that each layer is to occupy
    # log z depth
    # -------------------------------------------------------------
    zb = np.geomspace(1e-1, maxdepth, num=20)
    nstr = len(zb)
    zr = [abs(zb[0] / maxdepth)]
    zr.extend(list(abs(np.diff(zb) / maxdepth)))


    simu.update_prepo_inputs(
        DEM=dem_crop,
        xllcorner=1e4,
        yllcorner=4e3,
        nstr=20,
        zratio=zr,
        base=max(zb),
    )

    simu.update_parm(TRAFLAG=0)
    simu.create_mesh_vtk(verbose=True)




.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ğŸ”„ Update hap.in file
    ğŸ”„ update dem_parameters file 
    ğŸ”„ Update dtm_13 file
    ğŸ”„ update dem_parameters file 
    ğŸ”„ update parm file 
    ğŸ³ gfortran compilation
    ğŸ‘Ÿ Run preprocessor

     wbb...

     searching the dtm_13.val input file...
     assigned nodata value =  -9999.0000000000000     

     number of processed cells =         200

     ...wbb completed

     rn...
     csort I...
     ...completed

     depit...
     dem modifications =            0
     dem modifications =            0 (total)
     ...completed

     csort II...
     ...completed

     cca...

     contour curvature threshold value =    9.99999996E+11
     ...completed

     smean...
     mean (min,max) facet slope =  0.050445386 ( 0.020000000, 0.053851648)
     ...completed

     dsf...
     the drainage direction of the outlet cell (           8 ) is used
     ...completed

     hg...
     ...completed

     saving the data in the basin_b/basin_i files...

     ...rn completed

     mrbb...


     Select the header type:
     0) None
     1) ESRI ascii file
     2) GRASS ascii file
     (Ctrl C to exit)

     -> 
     Select the nodata value:
     (Ctrl C to exit)

     -> 
     Select the pointer system:
     1) HAP system
     2) Arc/Gis system
     (Ctrl C to exit)

     ->  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dem file

     min value = 0.585000E+00
     max value = 0.100000E+01
     number of cells =   200
     mean value = 0.792500E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     lakes_map file

     min value =     0
     max value =     0
     number of cells =   200
     mean value =     0.000000

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     zone file

     min value =     1
     max value =     1
     number of cells =   200
     mean value =     1.000000

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_w_1 file

     min value = 0.515524E+00
     max value = 0.100000E+01
     number of cells =   200
     mean value = 0.651177E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_w_2 file

     min value = 0.000000E+00
     max value = 0.484476E+00
     number of cells =   200
     mean value = 0.348823E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_p_outflow_1 file

     min value =     4
     max value =     8
     number of cells =   200
     mean value =     4.400000

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_p_outflow_2 file

     min value =     0
     max value =     9
     number of cells =   200
     mean value =     6.885000

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     A_inflow file

     min value = 0.000000000000E+00
     max value = 0.497499945034E+02
     number of cells =   200
     mean value = 0.305322909355E+01

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_local_slope_1 file

     min value = 0.200000E-01
     max value = 0.500000E-01
     number of cells =   200
     mean value = 0.470000E-01

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_local_slope_2 file

     min value = 0.000000E+00
     max value = 0.494975E-01
     number of cells =   200
     mean value = 0.356382E-01

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_epl_1 file

     min value = 0.500000E+00
     max value = 0.500000E+00
     number of cells =   200
     mean value = 0.500000E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_epl_2 file

     min value = 0.000000E+00
     max value = 0.707107E+00
     number of cells =   200
     mean value = 0.509117E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_kSs1_sf_1 file

     min value = 0.240040E+02
     max value = 0.240040E+02
     number of cells =   200
     mean value = 0.240040E+02

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_kSs1_sf_2 file

     min value = 0.000000E+00
     max value = 0.240040E+02
     number of cells =   200
     mean value = 0.172829E+02

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_Ws1_sf file

     min value = 0.100000E+01
     max value = 0.100000E+01
     number of cells =   200
     mean value = 0.100000E+01

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_Ws1_sf_2 file

     min value = 0.000000E+00
     max value = 0.100000E+01
     number of cells =   200
     mean value = 0.720000E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_b1_sf file

     min value = 0.000000E+00
     max value = 0.000000E+00
     number of cells =   200
     mean value = 0.000000E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_y1_sf file

     min value = 0.000000E+00
     max value = 0.000000E+00
     number of cells =   200
     mean value = 0.000000E+00

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_hcID file

     min value =     0
     max value =     0
     number of cells =   200
     mean value =     0.000000

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_q_output file

     min value =     0
     max value =     0
     number of cells =   200
     mean value =     0.000000

     writing the output file...

     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

     dtm_nrc file

     min value = 0.100000E+01
     max value = 0.100000E+01
     number of cells =   200
     mean value = 0.100000E+01

     writing the output file...

     ...mrbb completed

     bb2shp...

     writing file river_net.shp

    Note: The following floating-point exceptions are signalling: IEEE_UNDERFLOW_FLAG IEEE_DENORMAL

    ğŸ”„ update parm file 
    ğŸ›   Recompile src files [44s]
    ğŸ³ gfortran compilation [48s]
    b''
    ğŸ‘Ÿ Run processor
    b'\n\n IPRT1=3: Program terminating after output of X, Y, Z coordinate values\n'
    b''




.. GENERATED FROM PYTHON SOURCE LINES 272-282

.. code-block:: Python

    meshfile = rootpath + "/vtk/" + simu.project_name + ".vtk"
    import pyvista as pv

    mesh2plot = pv.read(meshfile)
    mesh2plot.plot(show_edges=True,
                   show_axes=True, 
                   show_bounds=True,
                   notebook=True,
                   )




.. image-sg:: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_016.png
   :alt: plot 3 meshing from weill
   :srcset: /content/SSHydro/images/sphx_glr_plot_3_meshing_from_weill_016.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /home/z0272571a@CAMPUS.CSIC.ES/miniconda3/envs/pyCATHY_doc/lib/python3.10/site-packages/pyvista/jupyter/notebook.py:34: UserWarning: Failed to use notebook backend: 

    No module named 'trame'

    Falling back to a static output.
      warnings.warn(
    <PIL.Image.Image image mode=RGB size=1024x768 at 0x7F77B5D019F0>




.. GENERATED FROM PYTHON SOURCE LINES 283-285

.. code-block:: Python


    #simu.run_processor(IPRT1=2, verbose=True)








.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 48.929 seconds)


.. _sphx_glr_download_content_SSHydro_plot_3_meshing_from_weill.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_3_meshing_from_weill.ipynb <plot_3_meshing_from_weill.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_3_meshing_from_weill.py <plot_3_meshing_from_weill.py>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
