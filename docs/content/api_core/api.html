<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API reference: The pyCATHY package &mdash; pyCATHY 0.1.1 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="Authors" href="../authors.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> pyCATHY
          </a>
              <div class="version">
                0.1.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">pyCATHY</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Authors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">API reference: The <code class="docutils literal notranslate"><span class="pre">pyCATHY</span></code> package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pyCATHY.cathy_tools"><code class="docutils literal notranslate"><span class="pre">pyCATHY.cathy_tools</span></code>: main tools for processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyCATHY.plotters.cathy_plots"><code class="docutils literal notranslate"><span class="pre">pyCATHY.plotters</span></code>: plotters for results visualisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyCATHY.importers.cathy_outputs"><code class="docutils literal notranslate"><span class="pre">pyCATHY.importers</span></code>: importers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyCATHY.DA.cathy_DA"><code class="docutils literal notranslate"><span class="pre">pyCATHY.DA</span></code>: data assimilation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pycathy-ert-ert"><code class="docutils literal notranslate"><span class="pre">pyCATHY.ERT</span></code>: ERT</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pyCATHY</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>API reference: The <code class="docutils literal notranslate"><span class="pre">pyCATHY</span></code> package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/content/api_core/api.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="api-reference-the-pycathy-package">
<h1>API reference: The <code class="docutils literal notranslate"><span class="pre">pyCATHY</span></code> package<a class="headerlink" href="#api-reference-the-pycathy-package" title="Permalink to this headline"></a></h1>
<section id="module-pyCATHY.cathy_tools">
<span id="pycathy-cathy-tools-main-tools-for-processing"></span><h2><code class="docutils literal notranslate"><span class="pre">pyCATHY.cathy_tools</span></code>: main tools for processing<a class="headerlink" href="#module-pyCATHY.cathy_tools" title="Permalink to this headline"></a></h2>
<p>&#64;author: bmary</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyCATHY.cathy_tools.</span></span><span class="sig-name descname"><span class="pre">CATHY</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prj_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'my_cathy_prj'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1.0.0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Main CATHY object</p>
<p>When instantiated it creates the tree project directories with ‘prj_name’ as root folder.
The src files are fetched from the online repository if not existing
(note that it is possible to call a specific version).</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.backup_results" title="pyCATHY.cathy_tools.CATHY.backup_results"><code class="xref py py-obj docutils literal notranslate"><span class="pre">backup_results</span></code></a>()</p></td>
<td><p>Save minimal dataframes of the simulation for result visualisation within python</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.backup_simu" title="pyCATHY.cathy_tools.CATHY.backup_simu"><code class="xref py py-obj docutils literal notranslate"><span class="pre">backup_simu</span></code></a>()</p></td>
<td><p>Save a copy of the simulation for reuse within python</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.create_mesh_vtk" title="pyCATHY.cathy_tools.CATHY.create_mesh_vtk"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_mesh_vtk</span></code></a>([topo])</p></td>
<td><p>Create custum mesh</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.create_output" title="pyCATHY.cathy_tools.CATHY.create_output"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_output</span></code></a>([output_dirname])</p></td>
<td><p>Create output directories</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.find_nearest_node" title="pyCATHY.cathy_tools.CATHY.find_nearest_node"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_nearest_node</span></code></a>(node_coords[, grid3d])</p></td>
<td><p>Find nearest mesh node</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.init_boundary_conditions" title="pyCATHY.cathy_tools.CATHY.init_boundary_conditions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">init_boundary_conditions</span></code></a>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.init_obs_cov_matrice" title="pyCATHY.cathy_tools.CATHY.init_obs_cov_matrice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">init_obs_cov_matrice</span></code></a>(dict_obs, obs_cov_type)</p></td>
<td><p>THIS SHOULD BE MOVED TO DA CLASS</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.map_prop2mesh" title="pyCATHY.cathy_tools.CATHY.map_prop2mesh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">map_prop2mesh</span></code></a>(dict_props)</p></td>
<td><p>Add a map of a given physical property to the mesh</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.perturbate_obs" title="pyCATHY.cathy_tools.CATHY.perturbate_obs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">perturbate_obs</span></code></a>(dict_obs)</p></td>
<td><p>Not yet implemented</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.plot" title="pyCATHY.cathy_tools.CATHY.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>(prop, **kwargs)</p></td>
<td><p>Call and parse to cathy.plotter from the main CATHY class</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.prepare_observations" title="pyCATHY.cathy_tools.CATHY.prepare_observations"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_observations</span></code></a>([dict_obs, perturbate, ...])</p></td>
<td><p>THIS SHOULD BE MOVED TO DA CLASS</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.read_inputs" title="pyCATHY.cathy_tools.CATHY.read_inputs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_inputs</span></code></a>(filename)</p></td>
<td><p>Read CATHY format input file</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.read_observations" title="pyCATHY.cathy_tools.CATHY.read_observations"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_observations</span></code></a>(filename, data_type, data_err)</p></td>
<td><p>read measures (real observations) from file  and prepare for DA analysis (covariance matrice and perturbation) Uses <cite>pyCATHY.importers</cite>, <cite>sensors_measures</cite> to read files with common standards Need to be call for each time/ each observation</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.read_outputs" title="pyCATHY.cathy_tools.CATHY.read_outputs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_outputs</span></code></a>(filename, **kwargs)</p></td>
<td><p>Read CATHY format output file</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.recompileSrc" title="pyCATHY.cathy_tools.CATHY.recompileSrc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">recompileSrc</span></code></a>([verbose])</p></td>
<td><p>Other option is self.run_processor(runProcess=False)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.rich_display" title="pyCATHY.cathy_tools.CATHY.rich_display"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rich_display</span></code></a>([title])</p></td>
<td><p>Describe the variable state and fate during the simulation with a rich table</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.run_preprocessor" title="pyCATHY.cathy_tools.CATHY.run_preprocessor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run_preprocessor</span></code></a>([KeepOutlet, verbose])</p></td>
<td><p>Run cppp.exe</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.run_processor" title="pyCATHY.cathy_tools.CATHY.run_processor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run_processor</span></code></a>([recompile, runProcess, verbose])</p></td>
<td><p>Run cathy.exe</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.selec_atmbc_window" title="pyCATHY.cathy_tools.CATHY.selec_atmbc_window"><code class="xref py py-obj docutils literal notranslate"><span class="pre">selec_atmbc_window</span></code></a>(NENS, ENS_times)</p></td>
<td><p>THIS SHOULD BE MOVED TO DA CLASS</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.update_ENS_files" title="pyCATHY.cathy_tools.CATHY.update_ENS_files"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_ENS_files</span></code></a>(parm_pert, ...)</p></td>
<td><p>THIS SHOULD BE MOVED TO DA CLASS</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.update_atmbc" title="pyCATHY.cathy_tools.CATHY.update_atmbc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_atmbc</span></code></a>([HSPATM, IETO, TIME, VALUE, ...])</p></td>
<td><p>Atmospheric forcing term (atmbc - IIN6)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.update_cathyH" title="pyCATHY.cathy_tools.CATHY.update_cathyH"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_cathyH</span></code></a>([verbose])</p></td>
<td><p>Update CathyH file input based on <a href="#id1"><span class="problematic" id="id2">**</span></a>kwargs parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.update_dem_parameters" title="pyCATHY.cathy_tools.CATHY.update_dem_parameters"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_dem_parameters</span></code></a>(**kwargs)</p></td>
<td><p>Update DEM parameters</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.update_ic" title="pyCATHY.cathy_tools.CATHY.update_ic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_ic</span></code></a>([INDP, IPOND, WTPOSITION, verbose])</p></td>
<td><p>The initial conditions file contains the pressure heads distribution for the study area (INDP) For example, to simulate a uniform water table depth or 0.5 m or 1.0 m from the ground surface, INDP=3 and WTHEIGHT=4.5 are selected</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.update_mesh_bounds" title="pyCATHY.cathy_tools.CATHY.update_mesh_bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_mesh_bounds</span></code></a>([bound_type, bound_bool])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.update_mesh_vtk" title="pyCATHY.cathy_tools.CATHY.update_mesh_vtk"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_mesh_vtk</span></code></a>([prop, prop_value, savevtk])</p></td>
<td><p><a class="reference external" href="https://docs.pyvista.org/api/core/_autosummary/pyvista.ExplicitStructuredGrid.add_field_data.html#pyvista.ExplicitStructuredGrid.add_field_data">https://docs.pyvista.org/api/core/_autosummary/pyvista.ExplicitStructuredGrid.add_field_data.html#pyvista.ExplicitStructuredGrid.add_field_data</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.update_nansfdirbc" title="pyCATHY.cathy_tools.CATHY.update_nansfdirbc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_nansfdirbc</span></code></a>([TIME, NDIR, NDIRC, NQ3, ...])</p></td>
<td><p>Dirichlet Boundary conditions (or specified pressure) at TIME t</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.update_nansfneubc" title="pyCATHY.cathy_tools.CATHY.update_nansfneubc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_nansfneubc</span></code></a>([TIME, NQ, ZERO])</p></td>
<td><p>Neumann boundary conditions (or specifed flux) at TIME t</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.update_parm" title="pyCATHY.cathy_tools.CATHY.update_parm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_parm</span></code></a>([verbose])</p></td>
<td><p>Update parm file</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.update_prepo_inputs" title="pyCATHY.cathy_tools.CATHY.update_prepo_inputs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_prepo_inputs</span></code></a>([DEM, verbose, show])</p></td>
<td><p>Update default prepro inputs i.e. hap.in and dtm_13.val files based on kwargs.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.update_sfbc" title="pyCATHY.cathy_tools.CATHY.update_sfbc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_sfbc</span></code></a>([TIME])</p></td>
<td><p>Seepage face boundary conditions at TIME t</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.update_soil" title="pyCATHY.cathy_tools.CATHY.update_soil"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_soil</span></code></a>([IVGHU, FP, SPP, soil_het_dim, ...])</p></td>
<td><p>Soil parameters (soil - IIN4).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.update_veg_map" title="pyCATHY.cathy_tools.CATHY.update_veg_map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_veg_map</span></code></a>([indice_veg, show])</p></td>
<td><p>Contains the raster map describing which type of vegetation every cell belongs to.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyCATHY.cathy_tools.CATHY.update_zone" title="pyCATHY.cathy_tools.CATHY.update_zone"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_zone</span></code></a>([zone_xyz])</p></td>
<td><p>Update zone file</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 71%" />
<col style="width: 29%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>display_time_run</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>load_pickle_backup</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>map_prop2zone</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>map_prop_veg</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>mark_invalid_ensemble</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>search_mesh_bounds</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>set_SOIL_defaults</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.backup_results">
<span class="sig-name descname"><span class="pre">backup_results</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.backup_results" title="Permalink to this definition"></a></dt>
<dd><p>Save minimal dataframes of the simulation for result visualisation within python</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>project_filename_df.pkl</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.backup_simu">
<span class="sig-name descname"><span class="pre">backup_simu</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.backup_simu" title="Permalink to this definition"></a></dt>
<dd><p>Save a copy of the simulation for reuse within python</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>project_filename.pkl</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.create_mesh_vtk">
<span class="sig-name descname"><span class="pre">create_mesh_vtk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.create_mesh_vtk" title="Permalink to this definition"></a></dt>
<dd><p>Create custum mesh</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.create_output">
<span class="sig-name descname"><span class="pre">create_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dirname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'output'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.create_output" title="Permalink to this definition"></a></dt>
<dd><p>Create output directories</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>output_dirname</strong><span class="classifier">str, optional</span></dt><dd><p>Name of the dir. The default is “output”.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.find_nearest_node">
<span class="sig-name descname"><span class="pre">find_nearest_node</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid3d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.find_nearest_node" title="Permalink to this definition"></a></dt>
<dd><p>Find nearest mesh node</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>node_coords</strong><span class="classifier">list</span></dt><dd><p>List of coordinates [[x,y,z],[x2,y2,z2]].</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>closest_idx</strong><span class="classifier">list</span></dt><dd><p>Node indice in the grid3d.</p>
</dd>
<dt><strong>closest</strong><span class="classifier">list</span></dt><dd><p>Node coordinate in the grid3d.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.init_boundary_conditions">
<span class="sig-name descname"><span class="pre">init_boundary_conditions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.init_boundary_conditions" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.init_obs_cov_matrice">
<span class="sig-name descname"><span class="pre">init_obs_cov_matrice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_cov_type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.init_obs_cov_matrice" title="Permalink to this definition"></a></dt>
<dd><p>THIS SHOULD BE MOVED TO DA CLASS</p>
<p>compute measurement cov matrice and add it to dict_obs</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.map_prop2mesh">
<span class="sig-name descname"><span class="pre">map_prop2mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict_props</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.map_prop2mesh" title="Permalink to this definition"></a></dt>
<dd><p>Add a map of a given physical property to the mesh</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>dict_props</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.perturbate_obs">
<span class="sig-name descname"><span class="pre">perturbate_obs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.perturbate_obs" title="Permalink to this definition"></a></dt>
<dd><p>Not yet implemented</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prop</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.plot" title="Permalink to this definition"></a></dt>
<dd><p>Call and parse to cathy.plotter from the main CATHY class</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>prop</strong><span class="classifier">str</span></dt><dd><p>property to plot.</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">kwargs</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.prepare_observations">
<span class="sig-name descname"><span class="pre">prepare_observations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perturbate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_cov_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Bishop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.prepare_observations" title="Permalink to this definition"></a></dt>
<dd><p>THIS SHOULD BE MOVED TO DA CLASS</p>
<p>prepare observations before DA</p>
<ol class="arabic simple">
<li><p>Measurement perturbation (if required)</p></li>
<li><p>Compute matrice covariance</p></li>
<li><p>normalise data (if necessary)</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>dict_obs</strong><span class="classifier">dict</span></dt><dd><p>dict containing measure data + metadata.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>TYPE</dt><dd><p>data_cov, DataPert.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.read_inputs">
<span class="sig-name descname"><span class="pre">read_inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.read_inputs" title="Permalink to this definition"></a></dt>
<dd><p>Read CATHY format input file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename</strong><span class="classifier">str</span></dt><dd><p>name of the input CATHY file to read.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>A dataframe or a dict describing file data/entries.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.read_observations">
<span class="sig-name descname"><span class="pre">read_observations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_err</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.read_observations" title="Permalink to this definition"></a></dt>
<dd><p>read measures (real observations) from file 
and prepare for DA analysis (covariance matrice and perturbation)
Uses <cite>pyCATHY.importers</cite>, <cite>sensors_measures</cite> to read files with common standards
Need to be call for each time/ each observation</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename</strong><span class="classifier">str or dataframe</span></dt><dd><p>filename (or data) of the observation dataset.</p>
</dd>
<dt><strong>data_type</strong><span class="classifier">str</span></dt><dd><p>key tring to identify what type of measure is to read.</p>
</dd>
<dt><strong>data_err</strong><span class="classifier">float</span></dt><dd><p>% of error for a given measurement dataset. The default is 0.05.</p>
</dd>
<dt><strong>show</strong><span class="classifier">Bool</span></dt><dd><p>plot measure graph. The default is False.</p>
</dd>
<dt><strong>kwargs</strong>:**</dt><dd><dl class="simple">
<dt>position<span class="classifier">list</span></dt><dd><p>xyz position of the observation</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>dict_obs</strong><span class="classifier">dict</span></dt><dd><p>dict merging all observations + metadatas.
First key level is data assimilation time
Loop over data assimilation times means:
for ti in self.dict_obs:</p>
<blockquote>
<div><p>print(ti)</p>
</div></blockquote>
</dd>
<dt>OrderedDict([(0.0,</dt><dd><blockquote>
<div><dl>
<dt>{‘swc’: {‘filename’: None, </dt><dd><blockquote>
<div><p>‘data_type’: ‘swc’, 
‘units’: ‘$m^{3}/m^{3}$’, 
‘data’: 0.3391464625, 
‘data_err’: 0.01, 
‘mesh_nodes’: [159], 
‘assimilation_times’: 0.0, 
‘data_cov’: [], 
‘dataPert’: [], 
‘sensor_name’: ‘swc’},</p>
</div></blockquote>
<dl class="simple">
<dt>‘swc1’: {‘filename’: None, </dt><dd><p>‘data_type’: ‘swc’, 
‘units’: ‘$m^{3}/m^{3}$’, 
‘data’: 0.3391464625, 
‘data_err’: 0.01, 
‘mesh_nodes’: [159], 
‘assimilation_times’: 0.0, 
‘data_cov’: [], 
‘dataPert’: [], 
‘sensor_name’: ‘swc’},</p>
</dd>
</dl>
<p>}</p>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>3600,</dt><dd><dl>
<dt>{‘swc’: {‘filename’: None, </dt><dd><blockquote>
<div><p>‘data_type’: ‘swc’, 
‘units’: ‘$m^{3}/m^{3}$’, 
‘data’: 0.3391464625, 
‘data_err’: 0.01, 
‘mesh_nodes’: [159], 
‘assimilation_times’: 0.0, 
‘data_cov’: [], 
‘dataPert’: [], 
‘sensor_name’: ‘swc’},</p>
</div></blockquote>
<dl class="simple">
<dt>‘swc1’: {‘filename’: None, </dt><dd><p>‘data_type’: ‘swc’, 
‘units’: ‘$m^{3}/m^{3}$’, 
‘data’: 0.3391464625, 
‘data_err’: 0.01, 
‘mesh_nodes’: [159], 
‘assimilation_times’: 0.0, 
‘data_cov’: [], 
‘dataPert’: [], 
‘sensor_name’: ‘swc’},</p>
</dd>
</dl>
<p>.</p>
</dd>
</dl>
</dd>
</dl>
<p>)])</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.read_outputs">
<span class="sig-name descname"><span class="pre">read_outputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.read_outputs" title="Permalink to this definition"></a></dt>
<dd><p>Read CATHY format output file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename</strong><span class="classifier">str</span></dt><dd><p>name of the output file to read.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>A dataframe or a dict describing file data/entries.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.recompileSrc">
<span class="sig-name descname"><span class="pre">recompileSrc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.recompileSrc" title="Permalink to this definition"></a></dt>
<dd><p>Other option is self.run_processor(runProcess=False)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.rich_display">
<span class="sig-name descname"><span class="pre">rich_display</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Star</span> <span class="pre">Wars</span> <span class="pre">Movies'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.rich_display" title="Permalink to this definition"></a></dt>
<dd><p>Describe the variable state and fate during the simulation with a rich table</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.run_preprocessor">
<span class="sig-name descname"><span class="pre">run_preprocessor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">KeepOutlet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.run_preprocessor" title="Permalink to this definition"></a></dt>
<dd><p>Run cppp.exe</p>
<ol class="arabic simple">
<li><p>updates cathy parameters prepo</p></li>
<li><p>recompile the source files prepo</p></li>
<li><p>run the preprocessor using bash cmd</p></li>
</ol>
<p>Returns ——-</p>
<p>Running the executable file has allowed to generate a complete set of
files describing physiographic features of the drainage system, as shown in Table 2.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.run_processor">
<span class="sig-name descname"><span class="pre">run_processor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recompile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">runProcess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.run_processor" title="Permalink to this definition"></a></dt>
<dd><p>Run cathy.exe</p>
<ol class="arabic simple">
<li><p>updates cathy parameters and cathyH based on <a href="#id3"><span class="problematic" id="id4">**</span></a>kwargs</p></li>
<li><p>recompile the source files (set False for notebook) and create the executable</p></li>
<li><p>run the processor using bash cmd if runProcess is True</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>recompile</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is True.</p>
</dd>
<dt><strong>runProcess</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is True.</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is False.</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.selec_atmbc_window">
<span class="sig-name descname"><span class="pre">selec_atmbc_window</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">NENS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ENS_times</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.selec_atmbc_window" title="Permalink to this definition"></a></dt>
<dd><p>THIS SHOULD BE MOVED TO DA CLASS</p>
<p>Select the time window of the hietograph
== time between two assimilation observation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>NENS</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>ENS_times</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.update_ENS_files">
<span class="sig-name descname"><span class="pre">update_ENS_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parm_pert</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_parm_list</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.update_ENS_files" title="Permalink to this definition"></a></dt>
<dd><p>THIS SHOULD BE MOVED TO DA CLASS</p>
<p>Overwrite ensemble files after analysis step</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>Overwritten files.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.update_atmbc">
<span class="sig-name descname"><span class="pre">update_atmbc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">HSPATM</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">IETO</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TIME</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">VALUE</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[None,</span> <span class="pre">None]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.update_atmbc" title="Permalink to this definition"></a></dt>
<dd><p>Atmospheric forcing term (atmbc - IIN6)</p>
<p>..note:</p>
<blockquote>
<div><p>1 1                HSPATM,IETO
0.0000000e+00      TIME
5.5e-06              VALUE
12.000000e+03      TIME
0.00                 VALUE
18.000000e+03      TIME
0.00                 VALUE</p>
<p>The values are those of a 200-min rainfall event at a uniform 
intensity of 3.3·10-4 m/min, followed by 100 min of drainage.</p>
</div></blockquote>
<p>..note:</p>
<blockquote>
<div><p>In case of simultaneous precipitation and evaporation, we impose at 
the surface the net flux, i.e., precipitation minus evaporation.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>HSPATM</strong><span class="classifier">int, optional</span></dt><dd><ul class="simple">
<li><p>=0 for spatially variable atmospheric boundary condition inputs;</p></li>
</ul>
<p>blank or =9999 if unit IIN6 input is to be ignored; otherwise atmospheric BC’s are
homogeneous in space.</p>
</dd>
<dt><strong>IETO</strong><span class="classifier">TYPE, optional</span></dt><dd><ul class="simple">
<li><p>=0 for linear interpolation of the atmospheric boundary condition inputs between different</p></li>
<li><p>otherwise the inputs are assigned as a piecewise constant function (ietograph).</p></li>
</ul>
<p>The default is 0.</p>
</dd>
<dt><strong>TIME</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is None.</p>
</dd>
<dt><strong>VALUE</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is [Precipitation, EvapoTranspiration].</p>
</dd>
<dt><strong>show</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is False.</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is False.</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>..note:</dt><dd><ul class="simple">
<li><p>Update parm file (NPRT).</p></li>
<li><p>Update CATHYH file (MAXPRT).</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.update_cathyH">
<span class="sig-name descname"><span class="pre">update_cathyH</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.update_cathyH" title="Permalink to this definition"></a></dt>
<dd><p>Update CathyH file input based on <a href="#id5"><span class="problematic" id="id6">**</span></a>kwargs parameters.</p>
<p>Parameters ———- <a href="#id7"><span class="problematic" id="id8">**</span></a>kwargs : all variable parameters included into cathyH. For instance
ROWMAX # maximum NROW, with NROW = number of rows in the DEM.</p>
<p>Returns ——- type Write a modified cathyH file based on new parameters parsed</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.update_dem_parameters">
<span class="sig-name descname"><span class="pre">update_dem_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.update_dem_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Update DEM parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>**kwargs</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.update_ic">
<span class="sig-name descname"><span class="pre">update_ic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">INDP</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">IPOND</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">WTPOSITION</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.update_ic" title="Permalink to this definition"></a></dt>
<dd><p>The initial conditions file contains the pressure heads distribution for the study area (INDP)
For example, to simulate a uniform water table depth or 0.5 m or 1.0 m from the ground surface,
INDP=3 and WTHEIGHT=4.5 are selected</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>INDP</strong><span class="classifier">int, optional</span></dt><dd><p>Flag for pressure head initial conditions (all nodes). The default is 2.</p>
<ul class="simple">
<li><p>=0 for input of uniform initial conditions (one value read in)</p></li>
<li><p>=1 for input of non-uniform IC’s (one value read in for each node)</p></li>
<li><p>=2 for calculation of fully saturated vertical hydrostatic equilibrium IC’s
(calculated in subroutine ICVHE). In the case of IPOND&gt;0, the fully saturated
hydrostatic IC is calculated (in subroutine ICVHEPOND) starting from the ponding head
values at the surface nodes, rather than surface pressure heads of 0.</p></li>
<li><p>=3 for calculation of partially saturated vertical hydrostatic equilibrium IC’s
(calculated in subroutine ICVHWT) with the water table height (relative to the base
of the 3‐d grid) given by parameter WTHEIGHT</p></li>
<li><p>=4 for calculation of partially saturated vertical hydrostatic equilibrium IC’s
(calculated in subroutine ICVDWT) with the water table depth (relative to the surface
of the 3‐d grid) given by parameter WTHEIGHT</p></li>
</ul>
</dd>
<dt><strong>IPOND</strong><span class="classifier">int, optional</span></dt><dd><p>Flag for ponding head initial conditions (surface nodes). The default is 0.</p>
<ul class="simple">
<li><p>=0 no input of ponding head initial conditions; otherwise (IPOND = 1 or 2) ponding
head initial conditions are read into PONDNOD, and, where PONDNOD &gt; 0, these values
are used to update the surface node values in PTIMEP read in according to the
previous INDP flag</p></li>
<li><p>=1 uniform ponding head initial conditions (one value read in)</p></li>
<li><p>=2 non-uniform ponding head initial conditions (one value read in for each node)</p></li>
</ul>
</dd>
<dt><strong>WTPOSITION</strong><span class="classifier">float, optional</span></dt><dd><p>For the case INDP=3, specifies the initial water table height relative to
the base of the 3‐d grid. The default is 0.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>new ic file written/overwritten.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.update_mesh_bounds">
<span class="sig-name descname"><span class="pre">update_mesh_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bound_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bound_type'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bound_bool</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.update_mesh_bounds" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>bound_type</strong><span class="classifier">str</span></dt><dd><p>Neumann or Dirichlet.</p>
</dd>
<dt><strong>bound_bool</strong><span class="classifier">TYPE</span></dt><dd><p>Boolean for bound cond.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.update_mesh_vtk">
<span class="sig-name descname"><span class="pre">update_mesh_vtk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prop_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savevtk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.update_mesh_vtk" title="Permalink to this definition"></a></dt>
<dd><p><a class="reference external" href="https://docs.pyvista.org/api/core/_autosummary/pyvista.ExplicitStructuredGrid.add_field_data.html#pyvista.ExplicitStructuredGrid.add_field_data">https://docs.pyvista.org/api/core/_autosummary/pyvista.ExplicitStructuredGrid.add_field_data.html#pyvista.ExplicitStructuredGrid.add_field_data</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>prop</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is ‘’.</p>
</dd>
<dt><strong>prop_value</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is [].</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.update_nansfdirbc">
<span class="sig-name descname"><span class="pre">update_nansfdirbc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">TIME</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NDIR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NDIRC</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NQ3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noflow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bound_xyz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure_head</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.update_nansfdirbc" title="Permalink to this definition"></a></dt>
<dd><p>Dirichlet Boundary conditions (or specified pressure) at TIME t</p>
<ul class="simple">
<li><p>To simulate the no-flow boundaries conditions for the bottom and 
vertical sides of the domain it is necessary to set NDIR and NDIRC 
equal to zero.</p></li>
<li><p>To simulate different boundary conditions, it is necessary to 
indicate the number of selected nodes through NDIR or NDIRC, 
then to specify the node ID’s that you want to consider and
eventually the value of pressure head or flux that you want to assign.</p></li>
</ul>
<dl class="simple">
<dt>..note :</dt><dd><p>update_nansfdirbc use the grid3d to refer to mesh nodes</p>
</dd>
</dl>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>TIME</strong><span class="classifier">np.array([]), optional</span></dt><dd><p>Absolute simulation time in sec. 
The default is [].</p>
</dd>
<dt><strong>NDIR</strong><span class="classifier">int, optional</span></dt><dd><p>Number of non-atmospheric, non‐seepage face Dirichlet
nodes in 2-d mesh. The BC’s assigned to these surface nodes are replicated vertically. 
The default is 0.</p>
</dd>
<dt><strong>NDIRC</strong><span class="classifier">int, optional</span></dt><dd><p>Number of ‘fixed’ non-atmospheric, non-seepage face Dirichlet
nodes in 3‐d mesh (‘fixed’ in the sense that these BC’s are not replicated to other nodes ‐
compare NDIR). 
The default is 0.</p>
</dd>
<dt><strong>NQ3</strong><span class="classifier">int, optional</span></dt><dd><p>Number of non-atmospheric, non‐seepage face Neumann nodes in 3‐d
mesh. 
The default is None.</p>
</dd>
<dt><strong>noflow</strong><span class="classifier">Bool, optional</span></dt><dd><p>To simulate the no-flow boundaries conditions for the bottom and 
# vertical sides of the domain. The default is True.</p>
</dd>
<dt><strong>bound_xyz</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is None.</p>
</dd>
<dt><strong>pressure_head</strong><span class="classifier">TYPE, optional</span></dt><dd><blockquote>
<div><p>Specify a value of node pressure head to impose as Dirichlet boundary condition. 
The default is [].</p>
</div></blockquote>
<dl class="simple">
<dt>: TYPE</dt><dd><p>DESCRIPTION.</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.update_nansfneubc">
<span class="sig-name descname"><span class="pre">update_nansfneubc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">TIME</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NQ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ZERO</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.update_nansfneubc" title="Permalink to this definition"></a></dt>
<dd><p>Neumann boundary conditions (or specifed flux) at TIME t</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>TIME</strong><span class="classifier">np.array([]), optional</span></dt><dd><p>Absolute simulation time in sec. 
The default is [].</p>
</dd>
<dt><strong>NQ</strong><span class="classifier">TYPE, optional</span></dt><dd><p>number of non-atmospheric, non seepage face Neumann nodes in
3-D mesh. The default is 0.</p>
</dd>
<dt><strong>ZERO</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is 0.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.update_parm">
<span class="sig-name descname"><span class="pre">update_parm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.update_parm" title="Permalink to this definition"></a></dt>
<dd><p>Update parm file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>verbose</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is False.</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"></dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.update_prepo_inputs">
<span class="sig-name descname"><span class="pre">update_prepo_inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">DEM</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.update_prepo_inputs" title="Permalink to this definition"></a></dt>
<dd><p>Update default prepro inputs i.e. hap.in and dtm_13.val files based on kwargs</p>
<p>Parameters ———- DEM : type Description of parameter <cite>DEM</cite>. verbose : type Description
of parameter <cite>verbose</cite>. <a href="#id9"><span class="problematic" id="id10">**</span></a>kwargs : type Description of parameter <cite>**kwargs</cite>.</p>
<p>Returns ——- type Description of returned object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.update_sfbc">
<span class="sig-name descname"><span class="pre">update_sfbc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">TIME</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.update_sfbc" title="Permalink to this definition"></a></dt>
<dd><p>Seepage face boundary conditions at TIME t</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>TIME</strong><span class="classifier">np.array([]), optional</span></dt><dd><p>Absolute simulation time in sec. 
The default is [].</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.update_soil">
<span class="sig-name descname"><span class="pre">update_soil</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IVGHU</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FP</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SPP</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soil_het_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.update_soil" title="Permalink to this definition"></a></dt>
<dd><p>Soil parameters (soil - IIN4). The porous media properties.</p>
<dl class="simple">
<dt>..note::</dt><dd><p>The first thing that must be decides is the type of relationship to describe the hydraulic
characteristics of the unsaturated soil (i.e. retention curves). This can be done through
the choice of the parameter <strong>IVGHU</strong> amongst the several options.</p>
</dd>
</dl>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>IVGHU</strong><span class="classifier">int, optional</span></dt><dd><p>= -1 table look up for moisture curves</p>
<p>= 0 for van Genuchten moisture curves</p>
<p>= 1 for extended van Genuchten moisture curves</p>
<p>= 2 for moisture curves from Huyakorn et al (WRR 20(8) 1984, WRR 22(13) 1986) with Kr=Se**n conductivity relationship</p>
<p>= 3 for moisture curves from Huyakorn et al (WRR 20(8) 1984, WRR 22(13) 1986)with conductivity relationship from Table 3 of 1984 paper (log_10 Kr(Se) curve)</p>
<p>= 4 for Brooks‐Corey moisture curves.</p>
<p>The default is [].</p>
</dd>
<dt><strong>FP</strong><span class="classifier">list, optional</span></dt><dd><p>Feddes Parameters. The default is [].</p>
<p>[PCANA PCREF PCWLT ZROOT PZ OMGC]</p>
<ul class="simple">
<li><p>‘PCANA’: float anaerobiosis point</p></li>
<li><p>‘PCREF’: float field capacity</p></li>
<li><p>‘PCWLT’: float wilting point</p></li>
<li><p>‘ZROOT’: float root depth</p></li>
<li><p>‘PZ’: float ??</p></li>
<li><p>‘OMGC’: float ??</p></li>
</ul>
</dd>
<dt><strong>SPP</strong><span class="classifier">list, optional</span></dt><dd><p>Soil Physical Properties. The default is [].</p>
<ul class="simple">
<li><p>‘PERMX’ (NSTR, NZONE): saturated hydraulic conductivity - xx</p></li>
<li><p>‘PERMY’ (NSTR, NZONE): saturated hydraulic conductivity - yy</p></li>
<li><p>‘PERMZ’ (NSTR, NZONE): saturated hydraulic conductivity - zz</p></li>
<li><p>‘ELSTOR’ (NSTR, NZONE): specific storage</p></li>
<li><p>‘POROS’  (NSTR, NZONE): porosity (moisture content at saturation)</p></li>
</ul>
<p>retention curves parameters VGN, VGRMC, and VGPSAT</p>
<ul class="simple">
<li><p>‘VGNCELL’ (NSTR, NZONE)</p></li>
<li><p>‘VGRMCCELL’ (NSTR, NZONE)</p></li>
<li><p>‘VGPSATCELL’ (NSTR, NZONE):</p></li>
</ul>
</dd>
<dt><strong>heteregeneity_dim: int</strong></dt><dd><ul class="simple">
<li><p>dimension of the heteregeneity</p></li>
</ul>
</dd>
<dt><strong>verbose</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is False.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><ul class="simple">
<li><dl class="simple">
<dt>update parm file</dt><dd></dd>
</dl>
</li>
<li><dl class="simple">
<dt>update CATHY.H file</dt><dd></dd>
</dl>
</li>
<li><dl class="simple">
<dt>update mesh vtk file</dt><dd></dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.update_veg_map">
<span class="sig-name descname"><span class="pre">update_veg_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indice_veg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.update_veg_map" title="Permalink to this definition"></a></dt>
<dd><p>Contains the raster map describing which type of vegetation every cell belongs to.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>indice_veg</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is 1.</p>
</dd>
<dt><strong>show</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is False.</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>indice_veg</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.CATHY.update_zone">
<span class="sig-name descname"><span class="pre">update_zone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zone_xyz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.CATHY.update_zone" title="Permalink to this definition"></a></dt>
<dd><p>Update zone file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>zone_xyz</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is [].</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>create global zone_xyz variable</p></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Updated dem_parameters file (number of zones).</p></li>
<li><p>Updated parm file.</p></li>
<li><p>Updated CATHYH file.</p></li>
</ul>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.make_console">
<span class="sig-prename descclassname"><span class="pre">pyCATHY.cathy_tools.</span></span><span class="sig-name descname"><span class="pre">make_console</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.make_console" title="Permalink to this definition"></a></dt>
<dd><p>Start up the <code class="xref py py-class docutils literal notranslate"><span class="pre">rich.console.Console</span></code> instance we’ll use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>verbose</strong><span class="classifier">bool</span></dt><dd><p>Whether or not to print status messages to stderr.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyCATHY.cathy_tools.subprocess_run_multi">
<span class="sig-prename descclassname"><span class="pre">pyCATHY.cathy_tools.</span></span><span class="sig-name descname"><span class="pre">subprocess_run_multi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pathexe_list</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.cathy_tools.subprocess_run_multi" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>pathexe_list</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>p</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyCATHY.plotters.cathy_plots">
<span id="pycathy-plotters-plotters-for-results-visualisation"></span><h2><code class="docutils literal notranslate"><span class="pre">pyCATHY.plotters</span></code>: plotters for results visualisation<a class="headerlink" href="#module-pyCATHY.plotters.cathy_plots" title="Permalink to this headline"></a></h2>
<p>Created on Thu Jul 29 12:12:41 2021</p>
<p>&#64;author: ben</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyCATHY.plotters.cathy_plots.COCumflowvol">
<span class="sig-prename descclassname"><span class="pre">pyCATHY.plotters.cathy_plots.</span></span><span class="sig-name descname"><span class="pre">COCumflowvol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">workdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.plotters.cathy_plots.COCumflowvol" title="Permalink to this definition"></a></dt>
<dd><p>plot COCumflowvol</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>workdir</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>project_name</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyCATHY.plotters.cathy_plots.dem_plot">
<span class="sig-prename descclassname"><span class="pre">pyCATHY.plotters.cathy_plots.</span></span><span class="sig-name descname"><span class="pre">dem_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">workdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project_name</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.plotters.cathy_plots.dem_plot" title="Permalink to this definition"></a></dt>
<dd><p>DEM3D creates a 3D representation from a Grass DEM file</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyCATHY.plotters.cathy_plots.dem_plot_2d_top">
<span class="sig-prename descclassname"><span class="pre">pyCATHY.plotters.cathy_plots.</span></span><span class="sig-name descname"><span class="pre">dem_plot_2d_top</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.plotters.cathy_plots.dem_plot_2d_top" title="Permalink to this definition"></a></dt>
<dd><p>View from top of the a given parameter</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>parameter</strong><span class="classifier">np.array([]) or dict</span></dt><dd><p>The dimension of the vegetation map must match 
the dimension of the DEM.</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyCATHY.plotters.cathy_plots.indice_veg_plot">
<span class="sig-prename descclassname"><span class="pre">pyCATHY.plotters.cathy_plots.</span></span><span class="sig-name descname"><span class="pre">indice_veg_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">veg_map</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.plotters.cathy_plots.indice_veg_plot" title="Permalink to this definition"></a></dt>
<dd><p>View from top of the vegetation type (equivalent somehow to root map)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>veg_map</strong><span class="classifier">np.array([])</span></dt><dd><p>Indice of vegetation. The dimension of the vegetation map must match 
the dimension of the DEM.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>fig, ax</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyCATHY.plotters.cathy_plots.show_atmbc">
<span class="sig-prename descclassname"><span class="pre">pyCATHY.plotters.cathy_plots.</span></span><span class="sig-name descname"><span class="pre">show_atmbc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.plotters.cathy_plots.show_atmbc" title="Permalink to this definition"></a></dt>
<dd><p>Plot atmbc=f(time)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_atmbc</strong><span class="classifier">np.array</span></dt><dd><p>time where atmbc change.</p>
</dd>
<dt><strong>v_atmbc</strong><span class="classifier">list of 1 or 2 arrays (when available)</span></dt><dd><p>v_atmbc[0] is the array of Rain/Irrigation change over the time;
v_atmbc[1] is the array of ET demand over the time;</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>fig, ax</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyCATHY.plotters.cathy_plots.show_atmbc_3d">
<span class="sig-prename descclassname"><span class="pre">pyCATHY.plotters.cathy_plots.</span></span><span class="sig-name descname"><span class="pre">show_atmbc_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_atmbc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.plotters.cathy_plots.show_atmbc_3d" title="Permalink to this definition"></a></dt>
<dd><p>Temporary (must exist throught show_vtk only)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df_atmbc</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyCATHY.plotters.cathy_plots.show_hgraph">
<span class="sig-prename descclassname"><span class="pre">pyCATHY.plotters.cathy_plots.</span></span><span class="sig-name descname"><span class="pre">show_hgraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_hgraph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'time'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SW'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.plotters.cathy_plots.show_hgraph" title="Permalink to this definition"></a></dt>
<dd><p>plot hgraph</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>workdir</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>project_name</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>fig, ax</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyCATHY.plotters.cathy_plots.show_hgraph_2">
<span class="sig-prename descclassname"><span class="pre">pyCATHY.plotters.cathy_plots.</span></span><span class="sig-name descname"><span class="pre">show_hgraph_2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_hgraph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'time'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SW'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.plotters.cathy_plots.show_hgraph_2" title="Permalink to this definition"></a></dt>
<dd><p>plot hgraph</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>workdir</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>project_name</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>fig, ax</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyCATHY.plotters.cathy_plots.show_hgsfdet">
<span class="sig-prename descclassname"><span class="pre">pyCATHY.plotters.cathy_plots.</span></span><span class="sig-name descname"><span class="pre">show_hgsfdet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_hgsfdeth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.plotters.cathy_plots.show_hgsfdet" title="Permalink to this definition"></a></dt>
<dd><p>plot hgsfdet</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>workdir</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>project_name</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>fig, ax</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyCATHY.plotters.cathy_plots.show_vp">
<span class="sig-prename descclassname"><span class="pre">pyCATHY.plotters.cathy_plots.</span></span><span class="sig-name descname"><span class="pre">show_vp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_vp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'time'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'time'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SW'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.plotters.cathy_plots.show_vp" title="Permalink to this definition"></a></dt>
<dd><p>plot vp</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>workdir</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>project_name</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>fig, ax</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyCATHY.plotters.cathy_plots.show_vtk">
<span class="sig-prename descclassname"><span class="pre">pyCATHY.plotters.cathy_plots.</span></span><span class="sig-name descname"><span class="pre">show_vtk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pressure'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeStep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.plotters.cathy_plots.show_vtk" title="Permalink to this definition"></a></dt>
<dd><p>Plot pyvista vtk file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is None.</p>
</dd>
<dt><strong>unit</strong><span class="classifier">str, optional</span></dt><dd><p>[‘pressure’, ‘saturation’, ‘ER’, ‘permeability’, ‘velocity’] . The default is pressure.</p>
</dd>
<dt><strong>timeStep</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is 0.</p>
</dd>
<dt><strong>notebook</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is False.</p>
</dd>
<dt><strong>path</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is None.</p>
</dd>
<dt><strong>savefig</strong><span class="classifier">TYPE, optional</span></dt><dd><p>DESCRIPTION. The default is False.</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyCATHY.plotters.cathy_plots.show_vtk_TL">
<span class="sig-prename descclassname"><span class="pre">pyCATHY.plotters.cathy_plots.</span></span><span class="sig-name descname"><span class="pre">show_vtk_TL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeStep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notebook</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.plotters.cathy_plots.show_vtk_TL" title="Permalink to this definition"></a></dt>
<dd><p>Time lapse animation of selected time steps</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename</strong><span class="classifier">str, optional</span></dt><dd><p>DESCRIPTION. The default is None.</p>
</dd>
<dt><strong>unit</strong><span class="classifier">str, optional</span></dt><dd><p>pressure/saturation/ER. The default is None.</p>
</dd>
<dt><strong>timeStep</strong><span class="classifier">list, optional</span></dt><dd><p>DESCRIPTION. The default is “all”.</p>
</dd>
<dt><strong>notebook</strong><span class="classifier">Bool, optional</span></dt><dd><p>pyvista notebook option. The default is False.</p>
</dd>
<dt><strong>path</strong><span class="classifier">str, optional</span></dt><dd><p>path to the dir containing the vtk files. The default is None.</p>
</dd>
<dt><strong>savefig</strong><span class="classifier">Bool, optional</span></dt><dd><p>save figure. The default is False.</p>
</dd>
<dt><strong>show</strong><span class="classifier">Bool, optional</span></dt><dd><p>show plot. The default is True.</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyCATHY.importers.cathy_outputs">
<span id="pycathy-importers-importers"></span><h2><code class="docutils literal notranslate"><span class="pre">pyCATHY.importers</span></code>: importers<a class="headerlink" href="#module-pyCATHY.importers.cathy_outputs" title="Permalink to this headline"></a></h2>
<p>Reader for CATHY outputs files</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyCATHY.importers.cathy_outputs.read_cumflowvol">
<span class="sig-prename descclassname"><span class="pre">pyCATHY.importers.cathy_outputs.</span></span><span class="sig-name descname"><span class="pre">read_cumflowvol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.importers.cathy_outputs.read_cumflowvol" title="Permalink to this definition"></a></dt>
<dd><p>Output of cumulative flow volumes VSFTOT, VNDTOT, VNNTOT, VNUDTOT, and VTOT</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>CUMFLOWVOL</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyCATHY.importers.cathy_outputs.read_dtcoupling">
<span class="sig-prename descclassname"><span class="pre">pyCATHY.importers.cathy_outputs.</span></span><span class="sig-name descname"><span class="pre">read_dtcoupling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.importers.cathy_outputs.read_dtcoupling" title="Permalink to this definition"></a></dt>
<dd><p>CPU, time stepping, iteration and other diagnostics of the surface and subsurface modules at each time step</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyCATHY.importers.cathy_outputs.read_hgraph">
<span class="sig-prename descclassname"><span class="pre">pyCATHY.importers.cathy_outputs.</span></span><span class="sig-name descname"><span class="pre">read_hgraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.importers.cathy_outputs.read_hgraph" title="Permalink to this definition"></a></dt>
<dd><p>IOUT41 hgraph Surface runoff hydrograph: plot the computed discharge at the outlet (streamflow)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>hgraph data numpy array.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyCATHY.importers.cathy_outputs.read_hgsfdet">
<span class="sig-prename descclassname"><span class="pre">pyCATHY.importers.cathy_outputs.</span></span><span class="sig-name descname"><span class="pre">read_hgsfdet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.importers.cathy_outputs.read_hgsfdet" title="Permalink to this definition"></a></dt>
<dd><p>Detailed seepage face hydrograph output (Incoming and outgoing flows at the seepage face)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyCATHY.importers.cathy_outputs.read_mbeconv">
<span class="sig-prename descclassname"><span class="pre">pyCATHY.importers.cathy_outputs.</span></span><span class="sig-name descname"><span class="pre">read_mbeconv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.importers.cathy_outputs.read_mbeconv" title="Permalink to this definition"></a></dt>
<dd><p>Mass balance and convergence behaviour at each time step 
(REL. MBE (%) should be as small as possible)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyCATHY.importers.cathy_outputs.read_psi">
<span class="sig-prename descclassname"><span class="pre">pyCATHY.importers.cathy_outputs.</span></span><span class="sig-name descname"><span class="pre">read_psi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.importers.cathy_outputs.read_psi" title="Permalink to this definition"></a></dt>
<dd><p>Pressure head output at all nodes</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyCATHY.importers.cathy_outputs.read_sw">
<span class="sig-prename descclassname"><span class="pre">pyCATHY.importers.cathy_outputs.</span></span><span class="sig-name descname"><span class="pre">read_sw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.importers.cathy_outputs.read_sw" title="Permalink to this definition"></a></dt>
<dd><p>Water Saturation output at all nodes</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyCATHY.importers.cathy_outputs.read_vp">
<span class="sig-prename descclassname"><span class="pre">pyCATHY.importers.cathy_outputs.</span></span><span class="sig-name descname"><span class="pre">read_vp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.importers.cathy_outputs.read_vp" title="Permalink to this definition"></a></dt>
<dd><p>Vertical profile output in fixed nodes</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>None.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-pyCATHY.importers.cathy_inputs"></span><p>Reader for CATHY input files</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyCATHY.importers.cathy_inputs.read_atmbc">
<span class="sig-prename descclassname"><span class="pre">pyCATHY.importers.cathy_inputs.</span></span><span class="sig-name descname"><span class="pre">read_atmbc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.importers.cathy_inputs.read_atmbc" title="Permalink to this definition"></a></dt>
<dd><p>read atmbc file</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>atmbc dataframe.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pyCATHY.DA.cathy_DA">
<span id="pycathy-da-data-assimilation"></span><h2><code class="docutils literal notranslate"><span class="pre">pyCATHY.DA</span></code>: data assimilation<a class="headerlink" href="#module-pyCATHY.DA.cathy_DA" title="Permalink to this headline"></a></h2>
<p>Class managing Data Assimilation process</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyCATHY.DA.cathy_DA.run_analysis">
<span class="sig-prename descclassname"><span class="pre">pyCATHY.DA.cathy_DA.</span></span><span class="sig-name descname"><span class="pre">run_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">typ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_cov</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensembleX</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pyCATHY.DA.cathy_DA.run_analysis" title="Permalink to this definition"></a></dt>
<dd><p>Perform the DA analysis step</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>typ</strong><span class="classifier">str</span></dt><dd><p>type of analysis i.e ENKF or Particul filters.</p>
</dd>
<dt><strong>data</strong><span class="classifier">np.array([])</span></dt><dd><p>measured data.</p>
</dd>
<dt><strong>data_cov</strong><span class="classifier">np.array([]) or int</span></dt><dd><p>measured data covariance matrice.</p>
</dd>
<dt><strong>param</strong><span class="classifier">np.array([])</span></dt><dd><p>model parameters to update.</p>
</dd>
<dt><strong>ensemble_state</strong><span class="classifier">np.array([])</span></dt><dd><p>pressure head at each nodes.</p>
</dd>
<dt><strong>prediction</strong><span class="classifier">np.array([])</span></dt><dd><p>predicted observation (after mapping).</p>
</dd>
<dt><strong>rejected_ens</strong><span class="classifier">list</span></dt><dd><p>list of ensemble to reject</p>
</dd>
<dt><strong>Returns</strong></dt><dd></dd>
<dt><strong>——-</strong></dt><dd></dd>
<dt><strong>A</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>Amean</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>dA</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>dD</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>MeasAvg</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>S</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>COV</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>B</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>dAS</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>analysis</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
<dt><strong>analysis_param</strong><span class="classifier">TYPE</span></dt><dd><p>DESCRIPTION.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="pycathy-ert-ert">
<h2><code class="docutils literal notranslate"><span class="pre">pyCATHY.ERT</span></code>: ERT<a class="headerlink" href="#pycathy-ert-ert" title="Permalink to this headline"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../authors.html" class="btn btn-neutral float-left" title="Authors" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Benjamin Mary.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>